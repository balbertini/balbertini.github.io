
<!DOCTYPE html>
<html lang="pt_br">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> -->
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://balbertini.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://balbertini.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">


    <link href="https://balbertini.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="B.Albertini's site Atom">



<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-125173293-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

<meta name="author" content="Bruno Albertini" />
<meta name="description" content="Arquiteturas em VHDL." />
<meta name="keywords" content="vhdl, basic">

<meta property="og:site_name" content="B.Albertini's site"/>
<meta property="og:title" content="Arquitetura"/>
<meta property="og:description" content="Arquiteturas em VHDL."/>
<meta property="og:locale" content="pt_BR"/>
<meta property="og:url" content="https://balbertini.github.io/vhdlarchitecture-pt_BR.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-10-04 10:33:00-03:00"/>
<meta property="article:modified_time" content="2018-10-05 00:47:00-03:00"/>
<meta property="article:author" content="https://balbertini.github.io/author/bruno-albertini.html">
<meta property="article:section" content="vhdl"/>
<meta property="article:tag" content="vhdl"/>
<meta property="article:tag" content="basic"/>
<meta property="og:image" content="">

  <title>B.Albertini's site &ndash; Arquitetura</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://balbertini.github.io">
        <img src="https://balbertini.github.io/theme/img/profile.png" alt="" title="">
      </a>
      <h1><a href="https://balbertini.github.io"></a></h1>


      <nav>
        <ul class="list">
          <li><a href="https://balbertini.github.io/pages/sd-pt_BR.html#sd">Digitais</a></li>
          <li><a href="https://balbertini.github.io/pages/disciplinas-pt_BR.html#disciplinas">Disciplinas</a></li>
          <li><a href="https://balbertini.github.io/pages/research-pt_BR.html#research">Pesquisa</a></li>
          <li><a href="https://balbertini.github.io/pages/sobre-pt_BR.html#sobre">Sobre</a></li>
          <li><a href="https://balbertini.github.io/pages/vhdl-pt_BR.html#vhdl">VHDL</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-github" href="https://github.com/balbertini" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-rss" href="//balbertini.github.io/feeds/all.atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="vhdlarchitecture">Arquitetura</h1>
    <p>
      Publicado em 04/10/2018 (Qui) na categoria <a href="https://balbertini.github.io/category/vhdl.html">vhdl</a>
    </p>
  </header>


  <div>
    <p>As descrições em VHDL sempre possuem uma <a href="https://balbertini.github.io/vhdlentity-pt_BR.html">entidade</a>, que define as interfaces do módulo descrito. Porém, a entidade não descreve a funcionalidade, que é descrita na arquitetura.</p>
<p>Assim como a entidade é a <em>cara</em> do módulo que está descrevendo, a arquitetura, declarada pela palavra reservada <code>architecture</code>, é o <em>corpo</em> da sua descrição. Na arquitetura é onde descrevemos a funcionalidade do componente, ou seja, onde as coisas realmente acontecem. No diagrama esquemático, seria o equivalente de mostrar o que tem dentro do símbolo do seu componente.</p>
<p>Faz sentido descrever um componente com entradas e saídas mas sem nada dentro? Claro que não, por isso toda entidade deve ter ao menos uma arquitetura pois, sem ela, o componente não tem função. É possível que uma entidade tenha varias arquiteturas, cada uma realizando a tarefa que seu componente se propõe a fazer de uma maneira diferente. Contudo, uma arquitetura só pode pertencer a uma entidade. De fato, todas as arquiteturas pertencentes a uma entidade devem estar no mesmo arquivo que ela, depois da declaração da entidade.</p>
<p>A sintaxe de uma arquitetura em VHDL é:</p>
<div class="highlight"><pre><span></span><span class="k">architecture</span> <span class="nc">nome_da_arquitetura</span> <span class="k">of</span> <span class="nc">nome_da_entidade</span> <span class="k">is</span>
    <span class="n">declaracoes</span>
<span class="k">begin</span>
    <span class="n">declaracoes_combinatorias</span>
<span class="k">end</span> <span class="nc">nome_da_arquitetura</span><span class="p">;</span>
</pre></div>


<p>Onde <code>declaracoes</code> é a lista de elementos que serão utilizados na sua arquitetura, como sinais e componentes. As <code>declaracoes_combinatorias</code> são todas as declarações concorrentes desta descrição, como uma atribuição (condicional ou não), uma instância de componente ou um <code>process</code>. O <code>nome_da_arquitetura</code> pode ser qualquer nome válido em VHDL, e o <code>nome_da_entidade</code> deve ser o nome da entidade que esta arquitetura descreve.</p>
<p>Como uma entidade pode ter mais de uma arquitetura, é comum termos um arquivo VHDL com várias arquiteturas pertencentes a mesma entidade. Isso é útil pois podemos ter o mesmo componente descrito de maneiras diferentes (e.g. otimizado para velocidade, consumo de energia ou área, descrito especificamente para uma tecnologia (ASIC, FPGA, etc.), ou até mesmo com estilos de descrição diferentes). Não há uma convenção, mas se não for utilizado nenhum mecanismo explícito para escolher uma das arquiteturas disponíveis, a maioria dos softwares de síntese utiliza a última arquitetura encontrada no arquivo.</p>
<h2>Escolha explícita da arquitetura</h2>
<p>A entidade, exceto se for uma entidade <em>toplevel</em> (entidade máxima, que representa o circuito como um todo), sempre será usada como componente por uma arquitetura pertencente a outra entidade. Na prática, isso significa que há uma entidade raiz, que representa o circuito todo e possui ao menos uma arquitetura. Nesta  arquitetura, outras entidades filhas podem usadas como componentes para formar o circuito. Cada entidade filha usada pode usar outras como componente e assim por diante, criando uma árvore.</p>
<p>Considerando que o componente já foi declarado corretamente, há duas possibilidades de instância. Sem escolher qual arquitetura, a instância segue a seguinte sintaxe:</p>
<div class="highlight"><pre><span></span><span class="n">nome_da_intancia</span><span class="o">:</span>
  <span class="n">nome_da_entidade</span><span class="p">(</span><span class="n">nome_da_arquitetura</span><span class="p">)</span>
  <span class="k">generic</span> <span class="k">map</span> <span class="p">(</span><span class="n">atribuicao_de_parametros</span><span class="p">)</span>
  <span class="k">port</span> <span class="k">map</span> <span class="p">(</span><span class="n">atribuicao_de_portas</span><span class="p">);</span>
</pre></div>


<p>Isto fará com que o sintetizador escolha a última arquitetura descrita (ou a que for configurada no sintetizador). Contudo, esta sintaxe existe pois, na maioria das vezes, as entidades só possuem uma arquitetura. Você pode fazer uma escolha explícita da arquitetura, prática recomendada caso a entidade possua mais de uma. Para isso, basta modificar a declaração da instância para a sintaxe completa, como abaixo:</p>
<div class="highlight"><pre><span></span><span class="n">nome_da_intancia</span><span class="o">:</span>
  <span class="k">entity</span> <span class="nc">work</span><span class="p">.</span><span class="n">nome_da_entidade</span><span class="p">(</span><span class="n">nome_da_arquitetura</span><span class="p">)</span>
  <span class="k">generic</span> <span class="k">map</span> <span class="p">(</span><span class="n">atribuicao_de_parametros</span><span class="p">)</span>
  <span class="k">port</span> <span class="k">map</span> <span class="p">(</span><span class="n">atribuicao_de_portas</span><span class="p">);</span>
</pre></div>


<p>A palavra reservada <code>work</code> faz referência ao pacote de trabalho local, onde se encontram todas as entidades que foram desenvolvidas por você e não foram colocadas em um pacote. Caso você tenha colocado sua entidade em um pacote ou esteja usando uma entidade que você não fez e que está em um pacote, deve substituir <code>work</code> pelo pacote onde a entidade se encontra.</p>
<h3>Exemplo</h3>
<p><img src='https://balbertini.github.io/images/vhdl/mux2to1_arquitetura.png' width="39%" align="right" style="padding-left:5%" /></p>
<div class="highlight"><pre><span></span><span class="k">entity</span> <span class="nc">mux2to1</span> <span class="k">is</span>
    <span class="k">port</span><span class="p">(</span>
        <span class="n">s</span><span class="o">:</span>    <span class="k">in</span>  <span class="kt">bit</span><span class="p">;</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">:</span> <span class="k">in</span>    <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">o</span><span class="o">:</span>    <span class="k">out</span>   <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">);</span>
<span class="k">end</span> <span class="nc">mux2to1</span><span class="p">;</span>

<span class="k">architecture</span> <span class="nc">whenelse</span> <span class="k">of</span> <span class="nc">mux2to1</span> <span class="k">is</span>
<span class="k">begin</span>
    <span class="n">o</span> <span class="o">&lt;=</span> <span class="n">b</span> <span class="k">when</span> <span class="n">s</span><span class="o">=</span><span class="sc">&#39;1&#39;</span> <span class="k">else</span> <span class="n">a</span><span class="p">;</span>
<span class="k">end</span> <span class="nc">whenelse</span><span class="p">;</span>

<span class="k">architecture</span> <span class="nc">struct</span> <span class="k">of</span> <span class="nc">mux2to1</span> <span class="k">is</span>
<span class="k">begin</span>
    <span class="n">o</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">and</span> <span class="k">not</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="n">b</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">and</span> <span class="n">s</span><span class="p">);</span>
    <span class="n">o</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">and</span> <span class="k">not</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">or</span> <span class="p">(</span><span class="n">b</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">and</span> <span class="n">s</span><span class="p">);</span>
<span class="k">end</span> <span class="nc">struct</span><span class="p">;</span>
</pre></div>


<p>Acima, vemos um componente com duas arquiteturas, representadas tanto na descrição VHDL quanto na representação gráfica. Note que o componente possui uma entidade externa camada <code>mux2to1</code>, que define as interfaces de entrada e saída. Por dentro, tem duas arquiteturas, que definem o comportamento do componente de duas maneiras distintas. Por padrão, se não especificarmos explicitamente, o software de síntese irá considerar a última arquitetura descrita como sendo a que ele deve utilizar, por isso ligamos as interfaces do desenho na arquitetura padrão.</p>
<p>A arquitetura padrão nesse caso é a última descrita, chamada <code>struct</code>, e descreve estruturalmente o multiplexador usando portas lógicas. Note que o nome <code>struct</code> não é uma palavra reservada e sim um identificador válido em VHDL, portanto poderia ser qualquer outro. É recomendado que o nome da arquitetura reflita o que foi feito, nesse caso uma descrição estrutural. Podemos escolher a outra arquitetura se desejarmos, que é chamada de <code>whenelse</code>. Note que ambas fazem a mesma coisa, mas de maneiras diferentes.</p>
<p>No exemplo abaixo, temos a descrição de uma arquitetura pertencente a uma <code>entidade_mae</code> que utiliza o multiplexador como componente três vezes. Na instância <code>mux1</code>, a arquitetura é deixada a escolha do sintetizador, portanto será a arquitetura <code>struct</code>. Na instância <code>mux2</code>, a arquitetura utilizada ainda é a struct, mas dessa vez instruímos explicitamente o sintetizador a utilizá-la. Por último, na instância <code>mux3</code> o projetista escolheu explicitamente a arquitetura <code>whenelse</code>.</p>
<div class="highlight"><pre><span></span><span class="k">architecture</span> <span class="nc">muxes</span> <span class="k">of</span> <span class="nc">entidade_mae</span> <span class="k">is</span>
  <span class="k">component</span> <span class="nc">mux2to1</span> <span class="k">is</span>
    <span class="k">port</span><span class="p">(</span>
        <span class="n">s</span><span class="o">:</span>    <span class="k">in</span>  <span class="kt">bit</span><span class="p">;</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">:</span> <span class="k">in</span>    <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">o</span><span class="o">:</span>    <span class="k">out</span>   <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="k">end</span> <span class="k">component</span><span class="p">;</span>
  <span class="k">signal</span> <span class="n">s</span><span class="p">,</span><span class="n">o1</span><span class="p">,</span><span class="n">o2</span><span class="p">,</span><span class="n">o3</span><span class="o">:</span> <span class="kt">bit</span><span class="p">;</span>
  <span class="k">signal</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">:</span> <span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span> <span class="k">downto</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">begin</span>
  <span class="n">mux1</span><span class="o">:</span> <span class="n">mux2to1</span> <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">o1</span><span class="p">);</span>
  <span class="n">mux2</span><span class="o">:</span> <span class="k">entity</span> <span class="nc">work</span><span class="p">.</span><span class="n">mux2to1</span><span class="p">(</span><span class="n">struct</span><span class="p">)</span> <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">o2</span><span class="p">);</span>
  <span class="n">mux3</span><span class="o">:</span> <span class="k">entity</span> <span class="nc">work</span><span class="p">.</span><span class="n">mux2to1</span><span class="p">(</span><span class="n">whenelse</span><span class="p">)</span> <span class="k">port</span> <span class="k">map</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">o3</span><span class="p">);</span>
<span class="k">end</span> <span class="nc">muxes</span><span class="p">;</span>
</pre></div>


<p>Lembre-se que esta é a descrição de um hardware, portanto as três instâncias são três circuitos <strong>diferentes</strong>, cada um com seu próprio arranjo de portas lógicas. A diferença é que o <code>mux1</code> e o <code>mux2</code> são idênticos, ou seja, se você observar o circuito gerado, são duas cópias do mesmo circuito. O <code>mux3</code>, apesar de ter mesma funcionalidade, é diferente. Se você sintetizar o circuito acima para um circuito real em silício, poderá ver em um microscópio duas áreas idênticas e uma diferente, todas recebendo as mesmas entradas e cada uma com sua própria saída. <strong>Nota:</strong> este parágrafo é uma simplificação didática, se tiver conhecimento de síntese de ASICs e quiser saber mais detalhes do que acontece durante a síntese, me escreva.</p>
<p>Quando a entidade possui diversas arquiteturas, se uma determinada arquitetura não for escolhida por nenhuma instância, o sintetizador não a considerará. Isso significa que não será gerado nenhum circuito para aquela arquitetura, portanto ter várias arquiteturas não significa que o circuito gerado irá gastar mais energia ou ocupar mais área, pois só as arquiteturas utilizadas serão de fato sintetizadas.</p>
  </div>

   <div>
     Última atualização: 2018-10-05 00:47:00-03:00
   </div>


  <div class="tag-cloud">
    <p>
      <a href="https://balbertini.github.io/tag/vhdl.html">vhdl</a>
      <a href="https://balbertini.github.io/tag/basic.html">basic</a>
    </p>
  </div>





<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'balbertini';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Habilite JavaScript para ver os comentários.
</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>
  &copy; Bruno Albertini  - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - O tema <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> foi criado por <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a></p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " B.Albertini's site ",
  "url" : "https://balbertini.github.io",
  "image": "",
  "description": ""
}
</script>

</body>
</html>