<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>B.Albertini's site - vhdl</title><link href="https://balbertini.github.io/" rel="alternate"></link><link href="https://balbertini.github.io/feeds/vhdl.atom.xml" rel="self"></link><id>https://balbertini.github.io/</id><updated>2021-01-31T18:30:36-03:00</updated><subtitle>Professor</subtitle><entry><title>Fun√ß√µes</title><link href="https://balbertini.github.io/vhdl_function-pt_BR.html" rel="alternate"></link><published>2020-10-17T13:42:51-03:00</published><updated>2021-01-31T18:30:36-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2020-10-17:/vhdl_function-pt_BR.html</id><summary type="html">&lt;p&gt;Fun√ß√µes em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;As fun√ß√µes em VHDL s√£o bastante √∫teis para reaproveitar c√≥digo. Elas funcionam como uma fun√ß√£o em qualquer linguagem estruturada. Neste artigo, vamos ver o b√°sico de como escrever fun√ß√µes em VHDL.&lt;/p&gt;
&lt;p&gt;A sintaxe de uma fun√ß√£o em VHDL √©:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;pure&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="k"&gt;impure&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;function&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;nome_da_funcao&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;nome_do_parametro1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;tipo_parametro1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;valor_padrao&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;nome_do_parametro2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;tipo_parametro1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;valor_padrao&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                                        &lt;span class="p"&gt;...&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;tipo_de_retorno&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;declaracoes_internas&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;codigo&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;valor&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A classifica√ß√£o da fun√ß√£o como pura ou impura √© opcional e indica se a fun√ß√£o pode alterar valores de entrada (&lt;code&gt;impure&lt;/code&gt;) ou n√£o (&lt;code&gt;pure&lt;/code&gt;). Por padr√£o, as fun√ß√µes s√£o puras, ou seja qualquer altera√ß√£o nos par√¢metros de entrada √© considerada inv√°lida. Os valores retornados por uma fun√ß√£o impura podem depender de valores externos (e.g. vari√°veis compartilhadas).&lt;/p&gt;
&lt;p&gt;O &lt;code&gt;nome_da_funcao&lt;/code&gt; pode ser o que o projetista desejar, seguindo a nomenclatura obrigat√≥ria de VHDL para &lt;a href="https://balbertini.github.io/vhdl_fundamentals-pt_BR.html"&gt;identificadores&lt;/a&gt;. O mesmo se aplica para os par√¢metros. Os tipos dos par√¢metros podem ser &lt;a href="https://balbertini.github.io/vhdl_datatypes-pt_BR.html"&gt;qualquer tipo suportado&lt;/a&gt; em VHDL, lembrando que se for um tipo n√£o-nativo, deve-se incluir a biblioteca correta no projeto. O valor padr√£o dos par√¢metros √© pouco utilizado e serve para preencher os par√¢metros n√£o especificados no momento da chamada. O tipo de retorno adere √†s mesmas regras dos par√¢metros.&lt;/p&gt;
&lt;p&gt;As &lt;code&gt;declaracoes_internas&lt;/code&gt; s√£o todas as vari√°veis e constantes utilizadas, no mesmo formato utlizado em um processo ou arquitetura, mas as fun√ß√µes n√£o suportam sinais.&lt;/p&gt;
&lt;p&gt;O c√≥digo de uma fun√ß√£o √© intrinsecamente sequencial, ent√£o pode-se usar qualquer comando de VHDL, incluindo os exclusivos para uso em processos. A √∫nica obrigatoriedade √© que a fun√ß√£o retorne um e somente um valor condizente com o &lt;code&gt;tipo_de_retorno&lt;/code&gt;. √â poss√≠vel usar comandos condicionais (e.g. &lt;code&gt;if&lt;/code&gt;), mas a todas as condi√ß√µes devem retornar um valor.&lt;/p&gt;
&lt;p&gt;As fun√ß√µes podem ser declaradas em dois lugares distintos: em um pacote contendo fun√ß√µes e no pre√¢mbulo das unidades em VHDL (e.g. arquitetura, processo, entidade, etc).&lt;/p&gt;
&lt;h1&gt;Exemplo (pre√¢mbulo)&lt;/h1&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;arch&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;meuprojeto&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;function&lt;/span&gt; &lt;span class="n"&gt;equal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;begin&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;length&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;length&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
          &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Size are different.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;note&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;bva&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bvb&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;equal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bva&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;bvb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;No exemplo acima a fun√ß√£o &lt;code&gt;equal&lt;/code&gt; compara dois &lt;code&gt;bit_vector&lt;/code&gt; bit a bit e retorna verdadeiro somente se ambos os vetores possu√≠rem o mesmo conte√∫do. A chave para a compara√ß√£o √© o aninhamento dos dois loops &lt;code&gt;for&lt;/code&gt;, que itera sobre os vetores comparando-os bit a bit.&lt;/p&gt;
&lt;p&gt;Note que a fun√ß√£o foi declarada no pre√¢mbulo da arquitetura, mas chamada no corpo. A fun√ß√£o n√£o √© sintetiz√°vel diretamente, mas o sintetizador ir√° produzir um comparador para calcular o valor da compara√ß√£o e us√°-lo para decidir sobre a atribui√ß√£o condicional. Para efeitos de simula√ß√£o, a fun√ß√£o demora tempo zero.&lt;/p&gt;
&lt;p&gt;A declara√ß√£o da fun√ß√£o usou a v√≠rgula para separar os par√¢metros pois eles s√£o do emsmo tipo. A mesma fun√ß√£o poderia ser reescrita como &lt;code&gt;equal(a: bit_vector; b: bit_vector)&lt;/code&gt; e a chamada continuaria exatamente igual.&lt;/p&gt;
&lt;h1&gt;Exemplo (&lt;code&gt;package&lt;/code&gt;)&lt;/h1&gt;
&lt;p&gt;No caso de um &lt;code&gt;package&lt;/code&gt;, a fun√ß√£o √© declarada dentro da biblioteca:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;package&lt;/span&gt; &lt;span class="n"&gt;minhas_funcoes&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;function&lt;/span&gt; &lt;span class="n"&gt;equal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;minhas_funcoes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;package&lt;/span&gt; &lt;span class="k"&gt;body&lt;/span&gt; &lt;span class="n"&gt;minhas_funcoes&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;function&lt;/span&gt; &lt;span class="n"&gt;equal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;begin&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;length&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;length&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
          &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Size are different.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;note&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;minhas_funcoes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Temos agora uma biblioteca que pode ser usada em qualquer projeto, bastando para isso inclu√≠-la no projeto como uma biblioteca normal. As bibliotecas do usu√°rio, quando n√£o especificado, ficam em um pacote chamado &lt;code&gt;work&lt;/code&gt;, que corresponde ao pacote de trabalho e sempre √© importado por padr√£o. A cl√°usula &lt;code&gt;use&lt;/code&gt; no entanto n√£o √© opcional pois o sintetizador precisa saber qual(is) partes do pacote deseja usar.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;library&lt;/span&gt; &lt;span class="nn"&gt;work&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;-- opcional, importada por padr√£o&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;work.minhas_funcoes.equal&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;-- poderia ser .all&lt;/span&gt;

&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;arch&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;meuprojeto&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;bva&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bvb&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;equal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bva&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;bvb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="basic"></category></entry><entry><title>GHDL no Windows 10</title><link href="https://balbertini.github.io/vhdl_windowsghdl-pt_BR.html" rel="alternate"></link><published>2020-09-21T22:06:21-03:00</published><updated>2020-09-21T22:06:21-03:00</updated><author><name>Edson Midorikawa</name></author><id>tag:balbertini.github.io,2020-09-21:/vhdl_windowsghdl-pt_BR.html</id><summary type="html">&lt;p&gt;Como instalar e usar o GHDL no Windows 10&lt;/p&gt;</summary><content type="html">&lt;p&gt;O Prof. Edson Midorikawa gentilmente escreveu um &lt;em&gt;quickstart&lt;/em&gt; de como instalar e usar o GHDL no Windows. Foi testado no Windows 10, mas deve funcionar com pouca o nenhuma adapta√ß√£o em outros sistemas operacionais da Microsoft.&lt;/p&gt;
&lt;p&gt;A instala√ß√£o do GHDL no Windows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Baixar arquivo zip &lt;a href="https://github.com/ghdl/ghdl/releases/download/v0.37/ghdl-0.37-mingw32-mcode.zip"&gt;desta URL&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Descompactar os arquivos em uma pasta do computador (p.ex. &lt;code&gt;C:\Programas&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Verificar a pasta onde o arquivo &lt;code&gt;ghdl.exe&lt;/code&gt; fica localizado (p.ex. &lt;code&gt;C:\Programas\GHDL\0.37-mingw32-mcode\bin&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;No campo de busca na barra de tarefas do Windows (√≠cone de lupa ao lado do s√≠mbolo do Windows), busque a frase ".Editar as vari√°veis de ambiente do sistema" e abra o aplicativo.&lt;/li&gt;
&lt;li&gt;Clique no bot√£o &lt;strong&gt;Vari√°veis de Ambiente&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Selecione o campo Path dentro de Vari√°veis de usu√°rio para &lt;seu usuario&gt;.&lt;/li&gt;
&lt;li&gt;Clique em Editar...&lt;/li&gt;
&lt;li&gt;Clique em Novo&lt;/li&gt;
&lt;li&gt;Colar pasta do item acima (item 3)&lt;/li&gt;
&lt;li&gt;Clique OK por tr√™s vezes para finalizar&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Para rodar a simula√ß√£o com GHDL, √© preciso abrir uma janela de &lt;strong&gt;Prompt de Comandos&lt;/strong&gt; ou &lt;strong&gt;Windows Powershell&lt;/strong&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Busque a frase &lt;code&gt;cmd&lt;/code&gt; ou &lt;code&gt;powershell&lt;/code&gt; no campo de busca da barra de tarefas do Windows.&lt;/li&gt;
&lt;li&gt;Abra o aplicativo.&lt;/li&gt;
&lt;li&gt;Mude o diret√≥rio de trabalho rodando o comando cd &lt;caminho da pasta onde est√£o os arquivos VHDL&gt;. Por exemplo, &lt;code&gt;cd c:\arquivos\vhdl&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Rode os seguintes comandos para executar a compila√ß√£o e rodar o &lt;em&gt;testbench&lt;/em&gt;. Por exemplo:&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ghdl -a alarm.vhd&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ghdl -a alarm_tb.vhd&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ghdl -e alarm_tb&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ghdl -r alarm_tb&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Observa√ß√£o:&lt;/strong&gt; a solu√ß√£o para o problema neste exemplo de uso est√° no &lt;code&gt;alarm.vhd&lt;/code&gt; e o &lt;em&gt;testbench&lt;/em&gt; est√° no &lt;code&gt;alarm_tb.vhd&lt;/code&gt;, cuja entidade (do &lt;em&gt;testbench&lt;/em&gt;) chama-se &lt;code&gt;alarm_tb&lt;/code&gt;.&lt;/p&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="ghdl"></category></entry><entry><title>Fundamentos</title><link href="https://balbertini.github.io/vhdl_fundamentals-pt_BR.html" rel="alternate"></link><published>2020-09-18T19:49:39-03:00</published><updated>2020-09-18T19:49:39-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2020-09-18:/vhdl_fundamentals-pt_BR.html</id><summary type="html">&lt;p&gt;Fundamentos de VHDL&lt;/p&gt;</summary><content type="html">&lt;p&gt;Nest &lt;em&gt;post&lt;/em&gt; falaremos das caracter√≠sticas fundamentais da linguagem VHDL. Quando aplic√°vel, usaremos &lt;i class="fas fa-cog"&gt;&lt;/i&gt; para indicar quais vers√µes de VHDL suportam cada caracter√≠stica.&lt;/p&gt;
&lt;h1&gt;Elementos L√©xicos&lt;/h1&gt;
&lt;p&gt;VHDL n√£o diferencia mai√∫sculas de min√∫sculas. Como as descri√ß√µes s√£o arquivos de texto, aconselho usarem codifica√ß√£o UTF-8 em todas as suas descri√ß√µes, mas todo o c√≥digo em VHDL deve usar caracteres compat√≠veis com ASCII. A extens√£o do arquivo n√£o importa muito, mas as mais comuns s√£o &lt;code&gt;.vhd&lt;/code&gt; e &lt;code&gt;.vhdl&lt;/code&gt; (n√£o use &lt;code&gt;.v&lt;/code&gt; pois esta extens√£o √© interpretada como Verilog pelas ferramentas).&lt;/p&gt;
&lt;table style="width:100%"&gt;
 &lt;tr&gt;
   &lt;td&gt;&lt;i class="fas fa-exclamation fa-2x"  style="color: #ffcc00;"&gt;&lt;/i&gt;&lt;/td&gt;
   &lt;td&gt;
    Tome cuidado com acentos pois o c√≥digo dos caracteres, mesmo em UTF-8, deve ser compat√≠vel com ASCII. Evite caracteres acentuados fora dos coment√°rios.
   &lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;

&lt;h2&gt;Coment√°rios&lt;/h2&gt;
&lt;p&gt;Os coment√°rios s√£o parte important√≠ssima em engenharia de software e n√£o √© diferente em engenharia de hardware. S√£o muito √∫teis para descrever as inten√ß√µes do projetista, de forma que outro projetista entenda o que foi descrito quando, posteriormente, ler o arquivo.&lt;/p&gt;
&lt;p&gt;O coment√°rio b√°sico em VHDL √© &lt;code&gt;--&lt;/code&gt;. Ap√≥s estes dois caracteres, todo o restante da linha se torna um coment√°rio. H√° tamb√©m o coment√°rio delimitado, que come√ßa com &lt;code&gt;/*&lt;/code&gt; e termina com &lt;code&gt;*/&lt;/code&gt;, √∫til para coment√°rios multi-linhas. Os coment√°rios n√£o podem ser aninhados (coment√°rio dentro de coment√°rio), mas um coment√°rio com &lt;code&gt;--&lt;/code&gt; no in√≠cio da linha desativa qualquer delimitador de coment√°rio.&lt;/p&gt;
&lt;p&gt;Por motivos √≥bvios, os coment√°rios n√£o s√£o sintetiz√°veis.&lt;/p&gt;
&lt;table style="width:100%"&gt;
 &lt;tr&gt;
   &lt;td&gt;&lt;i class="fas fa-cog fa-2x"  style="color: #009933;"&gt;&lt;/i&gt;&lt;/td&gt;
   &lt;td&gt;
    Os coment√°rios com delimitadores s√£o suportados a partir do VHDL-2008.
   &lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;

&lt;h3&gt;Exemplo (VHDL&amp;lt;=2002)&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;-- Este √© um coment√°rio explicando o que a entidade abaixo faz. N√£o h√°&lt;/span&gt;
&lt;span class="c1"&gt;-- coment√°rios multi-linhas em VHDL&amp;lt;=2002, ent√£o usamos v√°rios coment√°rios&lt;/span&gt;
&lt;span class="c1"&gt;-- de uma linha.&lt;/span&gt;
&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;meu_circuito&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;-- e o pulso ainda pulsa&lt;/span&gt;
         &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt; &lt;span class="c1"&gt;-- zera todo mundo!&lt;/span&gt;
         &lt;span class="c1"&gt;-- TODO: adicionar as outras portas&lt;/span&gt;
       &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;meu_circuito&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h3&gt;Exemplo (VHDL&amp;gt;=2008)&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;/* Este √© um coment√°rio explicando o que a entidade abaixo faz. Em&lt;/span&gt;
&lt;span class="err"&gt;   VHDL&amp;gt;=2008 podemos usar coment√°rios multi-linhas.&lt;/span&gt;
&lt;span class="err"&gt; */&lt;/span&gt;
&lt;span class="err"&gt;entity meu_circuito is&lt;/span&gt;
&lt;span class="err"&gt;  port ( clk: in bit; -- e o pulso ainda pulsa&lt;/span&gt;
&lt;span class="err"&gt;         reset: in bit -- zera todo mundo!&lt;/span&gt;
&lt;span class="err"&gt;         /* TODO: adicionar as outras portas */&lt;/span&gt;
&lt;span class="err"&gt;       );&lt;/span&gt;
&lt;span class="err"&gt;end entity meu_circuito;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h2&gt;Identificadores&lt;/h2&gt;
&lt;p&gt;Os identificadores s√£o cadeias de caracteres usadas para dar nomes a vari√°veis, sinais e qualquer outro elemento da descri√ß√£o. Em VHDL, o identificador pode ser uma cadeia de qualquer tamanho, desde que siga as seguintes restri√ß√µes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Deve conter somente letras (&lt;code&gt;A-Z&lt;/code&gt; e &lt;code&gt;a-z&lt;/code&gt;), d√≠gitos (&lt;code&gt;0-9&lt;/code&gt;) ou o caractere &lt;code&gt;_&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Deve come√ßar com uma letra&lt;/li&gt;
&lt;li&gt;N√£o deve terminar com um &lt;code&gt;_&lt;/code&gt; e n√£o pode conter dois &lt;code&gt;_&lt;/code&gt; seguidos&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Essas limita√ß√µes existem para que seu identificador n√£o entre em conflito com identificadores usados internamente pelas ferramentas.&lt;/p&gt;
&lt;table style="width:100%"&gt;
 &lt;tr&gt;
   &lt;td&gt;&lt;i class="fas fa-exclamation fa-2x"  style="color: #ffcc00;"&gt;&lt;/i&gt;&lt;/th&gt;
   &lt;td&gt;
    Lembre-se que VHDL n√£o diferencia mai√∫sculas de min√∫sculas, ent√£o `meu_sinal` √© o mesmo que `MEU_SINAL` ou `MeUsInAl`.
   &lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;

&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;-- Identificadores v√°lidos&lt;/span&gt;
&lt;span class="n"&gt;meu_sinal&lt;/span&gt;
&lt;span class="n"&gt;entidadeSomadora&lt;/span&gt;
&lt;span class="c1"&gt;-- Identificadores inv√°lidos&lt;/span&gt;
&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="n"&gt;bola&lt;/span&gt; &lt;span class="c1"&gt;-- n√£o come√ßa com uma letra&lt;/span&gt;
&lt;span class="n"&gt;_meusinal&lt;/span&gt; &lt;span class="c1"&gt;-- n√£o come√ßa com uma letra&lt;/span&gt;
&lt;span class="n"&gt;meusinal_&lt;/span&gt; &lt;span class="c1"&gt;-- termina com _&lt;/span&gt;
&lt;span class="n"&gt;meu__sinal&lt;/span&gt; &lt;span class="c1"&gt;-- possui dois _ seguidos&lt;/span&gt;
&lt;span class="n"&gt;balbertini&lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="n"&gt;usp&lt;/span&gt; &lt;span class="c1"&gt;-- possui um caractere inv√°lido (@)&lt;/span&gt;
&lt;span class="n"&gt;xo&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;xo&lt;/span&gt; &lt;span class="c1"&gt;-- possui um caractere inv√°lido (:)&lt;/span&gt;
&lt;span class="err"&gt;üòä&lt;/span&gt;&lt;span class="c1"&gt;-- possui um caractere inv√°lido (U+1F60A em UTF-8)&lt;/span&gt;
&lt;span class="c1"&gt;-- alguns sintetizadores modernos aceitam o acento abaixo&lt;/span&gt;
&lt;span class="c1"&gt;-- mas melhor evitar&lt;/span&gt;
&lt;span class="n"&gt;sa√≠da&lt;/span&gt; &lt;span class="c1"&gt;-- possui um caractere inv√°lido (√≠)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h2&gt;Identificadores estendidos&lt;/h2&gt;
&lt;p&gt;VHDL tamb√©m suporta o que chamamos de identificador estendido. Os identificadores estendidos n√£o tem as limita√ß√µes dos identificadores e pode-se usar qualquer coisa dentro deles. Para usar, basta colocar seu identificador entre dois &lt;code&gt;\&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;p&gt;&lt;div class="highlight"&gt;&lt;pre&gt;
&lt;span class="c1"&gt;-- Identificadores estendidos v√°lidos&lt;/span&gt;
&lt;span class="nc"&gt;\5bola\&lt;/span&gt;
&lt;span class="nc"&gt;&amp;#92;&amp;#95;meusinal\&lt;/span&gt;
&lt;span class="nc"&gt;\meusinal_\&lt;/span&gt;
&lt;span class="nc"&gt;\meu__sinal\&lt;/span&gt;
&lt;span class="nc"&gt;\balbertini@usp\&lt;/span&gt;
&lt;span class="nc"&gt;\xo:xo\&lt;/span&gt;
&lt;span class="nc"&gt;\üòä\&lt;/span&gt;
&lt;span class="nc"&gt;\sa√≠da\&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;Quando usamos identificadores estendidos, a linguagem interpreta o identificador exatamente como ele √©, ent√£o neste caso a linguagem ir√° diferenciar mai√∫sculas de min√∫sculas.&lt;/p&gt;
&lt;table style="width:100%"&gt;
 &lt;tr&gt;
   &lt;td&gt;&lt;i class="fas fa-exclamation fa-2x"  style="color: #ffcc00;"&gt;&lt;/i&gt;&lt;/td&gt;
   &lt;td&gt;
    Os identificadores estendidos foram criados para serem usados pelas ferramentas de s√≠ntese, facilitando a troca de informa√ß√µes. N√£o recomendamos que utilize em suas descri√ß√µes pois nem todas as ferramentas suportam.
   &lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
   &lt;td&gt;&lt;i class="fas fa-cog fa-2x"  style="color: #009933;"&gt;&lt;/i&gt;&lt;/td&gt;
   &lt;td&gt;
    Os identificadores estendidos s√£o suportados a partir do VHDL-1993.
   &lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;

&lt;h2&gt;Palavras reservadas&lt;/h2&gt;
&lt;p&gt;Os comandos em VHDL s√£o chamados de palavras reservadas. Todas tem um significado especial e devem ser evitadas como identificadores. A tabela abaixo tem uma lista de todas as palavras reservadas da linguagem, em ordem alfab√©tica.&lt;/p&gt;
&lt;style type="text/css"&gt;
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
  overflow:hidden;padding:10px 5px;word-break:normal;}
.tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
  font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-baqh{text-align:center;vertical-align:top}
&lt;/style&gt;

&lt;table class="tg"&gt;
&lt;tbody&gt;
  &lt;tr&gt;
    &lt;th class="tg-baqh"&gt;abs&lt;/th&gt;
    &lt;th class="tg-baqh"&gt;else&lt;/th&gt;
    &lt;th class="tg-baqh"&gt;map&lt;/th&gt;
    &lt;th class="tg-baqh"&gt;range&lt;/th&gt;
    &lt;th class="tg-baqh"&gt;unaffected&lt;/th&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;access&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;elsif&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;mod&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;record&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;units&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;after&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;end&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;register&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;until&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;alias&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;entity&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;nand&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;reject&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;use&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;all&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;exit&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;new&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;release&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;and&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;next&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;rem&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;variable&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;architecture&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;fairness&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;nor&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;report&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;vmode&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;array&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;file&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;not&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;restrict&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;vprop&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;assert&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;for&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;null&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;restrict_guarantee&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;vunit&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;assume&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;force&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;return&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;assume_guarantee&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;function&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;of&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;rol ror&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;wait&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;attribute&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;on&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;when&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;generate&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;open&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;select&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;while&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;begin&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;generic&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;or&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;sequence&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;with&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;block&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;group&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;others&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;severity&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;xnor&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;body&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;guarded&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;out&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;shared&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;xor&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;buffer&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;signal&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;bus&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;if&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;package&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;sla&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;impure&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;parameter&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;sll&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;case&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;in&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;port&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;sra&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;component&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;inertial&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;postponed&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;srl&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;configuration&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;inout&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;procedure&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;strong&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;constant&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;is&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;process&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;subtype&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;context&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;property&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;cover&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;label&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;protected&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;then&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;library&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;pure&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;to&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;default&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;linkage&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;transport&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;disconnect&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;literal&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;type&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td class="tg-baqh"&gt;downto&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;loop&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
    &lt;td class="tg-baqh"&gt;&lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Algumas dessas palavras n√£o s√£o consideradas palavras reservadas em algumas vers√µes de VHDL, mas para manter a compatibilidade entre as vers√µes, considere esta lista como uma &lt;em&gt;lista de palavras que voc√™ n√£o deve usar&lt;/em&gt; como identificadores.&lt;/p&gt;
&lt;h2&gt;S√≠mbolos Especiais&lt;/h2&gt;
&lt;p&gt;A linguagem VHDL usa a seguinte lista de s√≠mbolos, cada um com um significado espec√≠fico na linguagem:&lt;/p&gt;
&lt;pre&gt;" # &amp; ' ( ) * + - , . / : ; &lt; = &gt; ? @ [ ] \` |&lt;/pre&gt;

&lt;p&gt;Al√©m desses, h√° s√≠mbolos com um √∫nico significado em VHDL, mas composto de dois caracteres:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;??&lt;/span&gt; &lt;span class="o"&gt;?=&lt;/span&gt; &lt;span class="o"&gt;?/=&lt;/span&gt; &lt;span class="o"&gt;?&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;?&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;?&amp;gt;=&lt;/span&gt; &lt;span class="o"&gt;?&amp;lt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Para funcionarem, voc√™ precisa escrev√™-los sem nenhum espa√ßo entre eles (e.g. &lt;code&gt;&amp;lt;=&lt;/code&gt; √© um operador de atribui√ß√£o, mas &lt;code&gt;&amp;lt; =&lt;/code&gt; s√£o duas compara√ß√µes, de menor e igual respectivamente).&lt;/p&gt;
&lt;h2&gt;Literais&lt;/h2&gt;
&lt;h3&gt;N√∫meros&lt;/h3&gt;
&lt;p&gt;H√° dois tipos de literais num√©ricos em VHDL: os inteiros e os reais. Ambos podem ser expressos usando nota√ß√£o cient√≠fica.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="c1"&gt;-- exemplo de n√∫mero inteiro&lt;/span&gt;
&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="c1"&gt;-- exemplo de n√∫mero inteiro&lt;/span&gt;
&lt;span class="mi"&gt;123&lt;/span&gt; &lt;span class="c1"&gt;-- exemplo de n√∫mero inteiro&lt;/span&gt;
&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="n"&gt;E12&lt;/span&gt; &lt;span class="c1"&gt;-- exemplo de n√∫mero inteiro em nota√ß√£o cient√≠fica&lt;/span&gt;
&lt;span class="mi"&gt;123&lt;/span&gt;&lt;span class="n"&gt;e45&lt;/span&gt; &lt;span class="c1"&gt;-- exemplo de n√∫mero inteiro em nota√ß√£o cient√≠fica&lt;/span&gt;
&lt;span class="mi"&gt;123&lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="c1"&gt;-- exemplo de n√∫mero inteiro em nota√ß√£o cient√≠fica&lt;/span&gt;
&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;1415&lt;/span&gt; &lt;span class="c1"&gt;-- exemplo de n√∫mero real&lt;/span&gt;
&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;67430&lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="err"&gt;‚àí&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="c1"&gt;-- exemplo de n√∫mero real em nota√ß√£o cient√≠fica&lt;/span&gt;
&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;02214076&lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;23&lt;/span&gt;  &lt;span class="c1"&gt;-- exemplo de n√∫mero real em nota√ß√£o cient√≠fica&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Note que &lt;code&gt;-123&lt;/code&gt; n√£o √© um n√∫mero inteiro mas sim uma nega√ß√£o de um inteiro. Os n√∫mero reais precisam de ao menos um d√≠gito antes e outro depois do &lt;code&gt;.&lt;/code&gt; para serem considerados v√°lidos.&lt;/p&gt;
&lt;p&gt;Os literais num√©ricos tamb√©m podem ser especificados em outras bases usando o operador &lt;code&gt;#&lt;/code&gt; com a base expressa em decimal:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;-- Todos os n√∫meros abaixo representam 253 em decimal&lt;/span&gt;
&lt;span class="mi"&gt;2#11111101#&lt;/span&gt; &lt;span class="c1"&gt;-- em bin√°rio (base 2)&lt;/span&gt;
&lt;span class="mi"&gt;16#FD#&lt;/span&gt; &lt;span class="c1"&gt;-- em hexadecimal (base 16)&lt;/span&gt;
&lt;span class="mi"&gt;16#0fd#&lt;/span&gt; &lt;span class="c1"&gt;-- em hexadecimal (base 16)&lt;/span&gt;
&lt;span class="mi"&gt;8#0375#&lt;/span&gt; &lt;span class="c1"&gt;-- em octal (base 8)&lt;/span&gt;
&lt;span class="c1"&gt;-- Todos os n√∫meros abaixo representam 0.5 em decimal&lt;/span&gt;
&lt;span class="mi"&gt;2#0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="c1"&gt;-- em bin√°rio (base 2)&lt;/span&gt;
&lt;span class="mi"&gt;8#0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="c1"&gt;-- em octal (base 8)&lt;/span&gt;
&lt;span class="mi"&gt;12#0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="c1"&gt;-- em duodecimal (base 12)&lt;/span&gt;
&lt;span class="c1"&gt;-- Todos os n√∫meros abaixo representam 1024 em decimal&lt;/span&gt;
&lt;span class="mi"&gt;2#1#&lt;/span&gt;&lt;span class="n"&gt;E10&lt;/span&gt; &lt;span class="c1"&gt;-- em bin√°rio (base 2)&lt;/span&gt;
&lt;span class="mi"&gt;16#4#&lt;/span&gt;&lt;span class="n"&gt;E2&lt;/span&gt; &lt;span class="c1"&gt;-- em hexadecimal (base 16)&lt;/span&gt;
&lt;span class="mi"&gt;10#1024#&lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;00&lt;/span&gt; &lt;span class="c1"&gt;-- em decimal (base 10)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;table style="width:100%"&gt;
 &lt;tr&gt;
   &lt;td&gt;&lt;i class="fas fa-exclamation fa-2x"  style="color: #ffcc00;"&gt;&lt;/i&gt;&lt;/td&gt;
   &lt;td&gt;
    VHDL suporta as bases de 2 a 16 nativamente, mas sugerimos ater-se √†s bases 2, 8 e 16 pois nem todas as ferramentas suportam bases arbitr√°rias.
   &lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;N√£o h√° ponto (ou v√≠rgula) de separa√ß√£o de milhares, mas √© poss√≠vel usar o caractere &lt;code&gt;_&lt;/code&gt; para melhorar e legibilidade dos literais num√©ricos, respeitando-se as regras de composi√ß√£o de identificadores (n√£o se pode aparecer no in√≠cio ou final de um n√∫mero, e tamb√©m n√£o pode aparecer duas vezes seguidas):&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;123&lt;/span&gt;&lt;span class="n"&gt;_456&lt;/span&gt;
&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;141&lt;/span&gt;&lt;span class="n"&gt;_592_6&lt;/span&gt;
&lt;span class="mi"&gt;2#1111_1100_0000_0000#&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O caractere &lt;code&gt;_&lt;/code&gt; em um literal √© inerte e n√£o tem significado algum, servindo apenas para melhorar a visualiza√ß√£o.&lt;/p&gt;
&lt;h3&gt;Caracteres&lt;/h3&gt;
&lt;p&gt;Os caracteres em VHDL s√£o expressos entre aspas simples &lt;code&gt;'&lt;/code&gt; e podem ser qualquer caractere ASCII imprim√≠vel.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;A&lt;/span&gt;&lt;span class="p"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="na"&gt;&amp;#39;a&lt;/span&gt;&lt;span class="p"&gt;&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;
&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;-- espa√ßo&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h3&gt;&lt;em&gt;Strings&lt;/em&gt;&lt;/h3&gt;
&lt;p&gt;As &lt;em&gt;strings&lt;/em&gt; s√£o vetores de caracteres e s√£o representadas em VHDL entre aspas duplas &lt;code&gt;"&lt;/code&gt;:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Bruno Albertini&amp;quot;&lt;/span&gt;
&lt;span class="s"&gt;&amp;quot;caracteres ASCII quaisquer como @%*&amp;quot;&lt;/span&gt;
&lt;span class="s"&gt;&amp;quot;10010011&amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;-- abaixo uma string contendo o caractere &amp;quot;, que √© representado por dois &amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;-- seguidos mas conta como um caractere s√≥ na string&lt;/span&gt;
&lt;span class="s"&gt;&amp;quot;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h3&gt;&lt;em&gt;Bit Strings&lt;/em&gt;&lt;/h3&gt;
&lt;p&gt;Como todo hardware no final das contas trabalha com zeros e uns, VHDL possui uma forma espec√≠fica para representar cadeias de bits. As cadeias s√£o tratadas de forma diferenciada pois sempre podem ser transformadas em bits sem ambiguidade. √â poss√≠vel especificar a base da cadeia usando os prefixos &lt;code&gt;B&lt;/code&gt; para bin√°rio, &lt;code&gt;O&lt;/code&gt; para octal, &lt;code&gt;X&lt;/code&gt; para hexadecimal e &lt;code&gt;D&lt;/code&gt; para decimal (este √∫ltimo a partir de VHDL-2008).&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;B&amp;quot;0100011&amp;quot; -- uma bitstring em bin√°rio&lt;/span&gt;
&lt;span class="err"&gt;B&amp;quot;10&amp;quot; -- outra  bitstring em bin√°rio&lt;/span&gt;
&lt;span class="err"&gt;b&amp;quot;111100100001&amp;quot; -- √© poss√≠vel usar min√∫sculas na especifica√ß√£o&lt;/span&gt;
&lt;span class="err"&gt;B&amp;quot;1111_0010_0001&amp;quot; -- e tamb√©m _ para melhorar a legibilidade&lt;/span&gt;
&lt;span class="err"&gt;B&amp;quot;&amp;quot; -- uma bitstring vazia&lt;/span&gt;
&lt;span class="err"&gt;O&amp;quot;372&amp;quot; -- equivalente a B&amp;quot;011_111_010&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;o&amp;quot;00&amp;quot; -- equivalente a B&amp;quot;000_000&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;X&amp;quot;FA&amp;quot; -- equivalente a B&amp;quot;1111_1010&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;x&amp;quot;0_d&amp;quot; -- equivalente a B&amp;quot;0000_1101&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;-- O prefixo D √© v√°lido somente em VHDL&amp;gt;=2008&lt;/span&gt;
&lt;span class="err"&gt;D&amp;quot;23&amp;quot; -- equivalente a B&amp;quot;10111&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;D&amp;quot;64&amp;quot; -- equivalente a B&amp;quot;1000000&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;D&amp;quot;0003&amp;quot; -- equivalente a B&amp;quot;11&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O n√∫mero de bits da cadeia equivalente √© sempre o n√∫mero de bits m√≠nimo necess√°rio para representar o literal. Quando usamos octal, a cadeia resultante ser√° um m√∫ltiplo de 3 bits pois cada d√≠gito octal corresponde a 3 bits bin√°rios. Similarmente, as cadeias em hexadecimal correspondem a m√∫ltiplos de 4 bits bin√°rios. Os d√≠gitos especificados devem ser v√°lidos na base desejada (e.g. em octal s√≥ existem os d√≠gitos de 0-7, em hexadecimal, de 0-9 e A-F (ou a-f)). Algumas letras tem significado especial dependendo do tipo bin√°rio por tr√°s da convers√£o, como o &lt;code&gt;Z&lt;/code&gt; que significa alta imped√¢ncia quando se usa l√≥gica multi-variada.&lt;/p&gt;
&lt;table style="width:100%"&gt;
 &lt;tr&gt;
  &lt;td&gt;&lt;i class="fas fa-info fa-2x"  style="color: #0066ff;"&gt;&lt;/i&gt;&lt;/td&gt;
   &lt;td&gt;
    A l√≥gica multi-variada em VHDL √© baseada no tipo &lt;code&gt;std_logic&lt;/code&gt;, que aceita &lt;code&gt;U&lt;/code&gt;, &lt;code&gt;X&lt;/code&gt;, &lt;code&gt;Z&lt;/code&gt;, &lt;code&gt;W&lt;/code&gt;, &lt;code&gt;L&lt;/code&gt;, &lt;code&gt;H&lt;/code&gt; e &lt;code&gt;-&lt;/code&gt; como d√≠gitos, al√©m dos tradicionais &lt;code&gt;0&lt;/code&gt; e &lt;code&gt;1&lt;/code&gt;.
   &lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;H√° ainda uma forma de controlar quantos bits queremos que a cadeia possua, que funciona com VHDL&amp;gt;=2008, colocando o n√∫mero de bits antes do prefixo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;-- S√≥ em VHDL&amp;gt;=2008&lt;/span&gt;
&lt;span class="err"&gt;7X&amp;quot;3C&amp;quot; -- equivalente a B&amp;quot;0111100&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;8O&amp;quot;5&amp;quot; -- equivalente a B&amp;quot;00000101&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;10B&amp;quot;X&amp;quot; -- equivalente a B&amp;quot;000000000X&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A cadeia ser√° preenchida com &lt;code&gt;0&lt;/code&gt; suficientes para completar o n√∫mero de bits. Caso o n√∫mero desejado seja menor, os zeros √† esquerda ser√£o cortados da cadeia, mas √© um erro especificar um n√∫mero de bits menor que o necess√°rio para representar o n√∫mero.&lt;/p&gt;
&lt;p&gt;Tamb√©m podemos especificar se o n√∫mero representa um inteiro com sinal ou sem sinal, adicionando os prefixos &lt;code&gt;S&lt;/code&gt; e &lt;code&gt;U&lt;/code&gt; respectivamente. Esta especifica√ß√£o s√≥ √© poss√≠vel em VHDL&amp;gt;=2008 e n√£o pode ser usada para n√∫meros decimais (especificador &lt;code&gt;D&lt;/code&gt;), que s√£o sempre considerados inteiros sem sinal.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;-- S√≥ em VHDL&amp;gt;=2008&lt;/span&gt;
&lt;span class="err"&gt;7UX&amp;quot;3C&amp;quot; -- equivalente a B&amp;quot;0111100&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;8UO&amp;quot;5&amp;quot; -- equivalente a B&amp;quot;00000101&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;10UB&amp;quot;1&amp;quot; -- equivalente a B&amp;quot;0000000001&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;10SX&amp;quot;71&amp;quot; -- equivalente a B&amp;quot;0001110001&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;10SX&amp;quot;88&amp;quot; -- equivalente a B&amp;quot;1110001000&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;10SX&amp;quot;W0&amp;quot; -- equivalente a B&amp;quot;WWWWWW0000&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;-- Se reduzirmos o tamanho usando o especificador S&lt;/span&gt;
&lt;span class="err"&gt;-- os bits descartados devem ser iguais ao √∫ltimo que ficou&lt;/span&gt;
&lt;span class="err"&gt;6SX&amp;quot;16&amp;quot; -- equivalente a B&amp;quot;010110&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;6SX&amp;quot;E8&amp;quot; -- equivalente a B&amp;quot;101000&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;6SX&amp;quot;13&amp;quot; -- equivalente a B&amp;quot;110011&amp;quot;&lt;/span&gt;
&lt;span class="err"&gt;6SX&amp;quot;H3&amp;quot; -- equivalente a B&amp;quot;HH0011&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;table style="width:100%"&gt;
 &lt;tr&gt;
   &lt;td&gt;&lt;i class="fas fa-cog fa-2x"  style="color: #009933;"&gt;&lt;/i&gt;&lt;/td&gt;
   &lt;td&gt;
    As vers√µes de VHDL&lt;2008 n√£o suportam o especificador decimal &lt;code&gt;D&lt;/code&gt;, nenhum especificador de tamanho (os n√∫meros no prefixo), e nenhum especificador de sinal (&lt;code&gt;U&lt;/code&gt; ou &lt;code&gt;S&lt;/code&gt;). Aconselho a n√£o us√°-los se deseja manter a compatibilidade da sua descri√ß√£o com todas as ferramentas.
   &lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="basic"></category></entry><entry><title>Hist√≥rico</title><link href="https://balbertini.github.io/vhdl_history-pt_BR.html" rel="alternate"></link><published>2020-09-18T19:49:39-03:00</published><updated>2021-01-31T18:30:36-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2020-09-18:/vhdl_history-pt_BR.html</id><summary type="html">&lt;p&gt;Hist√≥rico das HDLs&lt;/p&gt;</summary><content type="html">&lt;p&gt;Nest &lt;em&gt;post&lt;/em&gt; contaremos o hist√≥rico das HDLs com foco em VHDL e discutiremos as vantagens e desvantagens da utiliza√ß√£o deste tipo de linguagem.&lt;/p&gt;
&lt;p&gt;VHDL, ou VHSIC-HDL significa &lt;em&gt;Very High Speed Integrated Circuit Hardware Description Language&lt;/em&gt;. √â uma das duas HDLs mais utilizadas (a outra √© Verilog). √â muito utilizada em EDA (&lt;em&gt;Electronic Design Automation&lt;/em&gt;), a t√©cnica atual de projeto de circuitos digitais, cuja principal caracter√≠stica √© a descri√ß√£o program√°tica dos circuitos.&lt;/p&gt;
&lt;table style="width:100%"&gt;
  &lt;tr&gt;
    &lt;td&gt;
      &lt;i class="fas fa-info fa-2x"  style="color: #0066ff;"&gt;&lt;/i&gt;
    &lt;/td&gt;
    &lt;td&gt;
      HDL significa linguagem de descri√ß√£o de hardware, do ingl√™s &lt;em&gt;Hardware Description Language&lt;/em&gt;.
    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;De uma maneira resumida, HDL √© uma forma de expressar precisamente um circuito digital em um formato textual estruturado. Expressar significa descrever a estrutura e o comportamento do circuito. O diagrama esquem√°tico tem um poder de express√£o similar, por√©m de modo gr√°fico. Tudo o que voc√™ faz em um diagrama esquem√°tico voc√™ pode fazer em uma HDL e, de fato, um bom projetista de hardware consegue usar ambas as formas de express√£o. H√° outras formas de expressar um circuito (e.g. c√°lculo proposicional, modelos matem√°ticos, equa√ß√µes alg√©bricas, &lt;em&gt;floorplan&lt;/em&gt;, &lt;em&gt;netlist&lt;/em&gt;, etc.), mas est√£o fora do escopo deste &lt;em&gt;post&lt;/em&gt;.&lt;/p&gt;
&lt;h1&gt;Hist√≥rico do VHDL&lt;/h1&gt;
&lt;p&gt;A linguagem VHDL foi criada pelo Departamento de Defesa (DoD) norte-americano em 1983, com o intuito de servir para verifica√ß√£o. A ideia principal era documentar programaticamente o comportamento desejado do circuito, assim o DoD poderia licitar uma empresa para desenvolv√™-lo ou fabric√°-lo e facilmente verificar se o que foi entregue atendia as especifica√ß√µes.&lt;/p&gt;
&lt;p&gt;N√£o demorou muito para os projetistas perceberem que poderiam usar softwares para ler e simular o comportamento descrito em VHDL, e o pr√≥ximo passo foi natural: usar a pr√≥pria linguagem para descrever os circuitos e sintetiz√°-los automaticamente usando ferramentas desenvolvidas para isso. Como as verbas de projetos do DoD costumam ser razo√°veis, n√£o faltaram empresas interessadas em desenvolver e manter software para EDA, capazes de ler, simular e sintetizar descri√ß√µes em VHDL. Com a bagun√ßa gerada pelas diversas empresas criando ferramentas para EDA, o DoD decidiu padronizar a linguagem na IEEE, o que podemos ver abaixo:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IEEE 1076-1987: Primeira vers√£o padronizada pela IEEE, baseada na especifica√ß√£o do DoD.&lt;/li&gt;
&lt;li&gt;IEEE 1076-1993: Alguns anos de reclama√ß√µes e sugest√µes dos desenvolvedores de hardware foram incorporados √† linguagem e padronizados aqui. Esta vers√£o √© a mais usada at√© hoje e √© a que tem o maior suporte de ferramentas EDA.&lt;/li&gt;
&lt;li&gt;IEEE 1076-2000: Revis√£o, introdu√ß√£o dos tipos protegidos (&lt;code&gt;protected&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;IEEE 1076-2002: Revis√£o, relaxamento das regras para uso das portas tipo &lt;code&gt;buffer&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;IEEE 1076-2008: Revis√£o, introduz muitas modifica√ß√µes e sugest√µes dos projetistas, entre elas a PSL (&lt;em&gt;Property Specification Language&lt;/em&gt;), uma sublinguagem para especifica√ß√£o de l√≥gica temporal, √∫til para verifica√ß√£o de hardware.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;H√° uma vers√£o em discuss√£o, chamada de VHDL-202X e que ser√° padronizada como IEEE 1076 tamb√©m. Para acompanhar as discuss√µes acesse &lt;a href="http://www.eda-twiki.org/cgi-bin/view.cgi/P1076/WebHome"&gt;o site&lt;/a&gt; do grupo de trabalho.&lt;/p&gt;
&lt;p&gt;Uma das influ√™ncias not√°veis no VHDL √© a linguagem &lt;a href="https://www.adaic.org/"&gt;Ada&lt;/a&gt;, uma linguagem desenvolvida para programa√ß√£o paralela e utilizada como linguagem padr√£o para desenvolvimento de software pelo DoD. Como VHDL foi criada para descrever circuitos digitais, a linguagem reflete a natureza concorrente intr√≠nseca deste tipo de circuito. Ada √© uma linguagem com foco em programa√ß√£o paralela, ent√£o suporta descri√ß√µes concorrentes, tornando-a a candidata ideal para a cria√ß√£o do VHDL. Por este motivo, a linguagem VHDL acabou herdando muitas caracter√≠sticas da linguagem Ada, principalmente relativas √† sintaxe. De fato, VHDL pode at√© mesmo ser utilizada para desenvolver programas de t√£o parecida com Ada, mas h√° linguagens melhores para isso. No entanto, h√° uma situa√ß√£o onde escrever um software usando VHDL √© muito comum: a gera√ß√£o de &lt;em&gt;testbenchs&lt;/em&gt;, que nada mais s√£o que descri√ß√µes n√£o-sintetiz√°veis usadas para testar uma descri√ß√£o de hardware.&lt;/p&gt;
&lt;table style="width:100%"&gt;
  &lt;tr&gt;
    &lt;td&gt;
      &lt;i class="fas fa-info fa-2x"  style="color: #0066ff;"&gt;&lt;/i&gt;
    &lt;/td&gt;
    &lt;td&gt;
      Em VHDL todos os comandos acontecem ao mesmo tempo exceto pelo &lt;code&gt;process&lt;/code&gt;, usado para descri√ß√µes de circuitos sequenciais.
    &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;
      &lt;i class="fas fa-info fa-2x"  style="color: #0066ff;"&gt;&lt;/i&gt;
    &lt;/td&gt;
    &lt;td&gt;
      O termo &lt;u&gt;n√£o-sintetiz√°vel&lt;/u&gt; significa que a descri√ß√£o n√£o pode ser transformada em hardware de verdade pois cont√©m elementos de software.
    &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
    &lt;td&gt;
      &lt;i class="fas fa-exclamation fa-2x"  style="color: #ffcc00;"&gt;&lt;/i&gt;
    &lt;/td&gt;
    &lt;td&gt;
      Usamos majoritariamente o padr√£o IEEE 1076-1993 (conhecido como VHDL-93c), que √© uma vers√£o do VHDL-93 que tamb√©m aceita primitivas do VHDL-87. Se o seu projeto n√£o demanda outra vers√£o explicitamente, sempre opte por esta vers√£o pois √© a melhor suportada pelas ferramentas.
    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

&lt;h1&gt;Vantagens de HDLs&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Menor taxa de erros e tempo de desenvolvimento.&lt;/li&gt;
&lt;li&gt;Possibilidade de simular o circuito antes de sintetiz√°-lo.&lt;/li&gt;
&lt;li&gt;Separa√ß√£o entre funcionalidade e implementa√ß√£o.&lt;/li&gt;
&lt;li&gt;S√≠ntese e verifica√ß√£o autom√°ticas.&lt;/li&gt;
&lt;li&gt;Modulariza√ß√£o e reaproveitamento de m√≥dulos.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Em compara√ß√£o com t√©cnicas gr√°ficas ou matem√°ticas, as HDLs s√£o menos sujeitas a erros de interpreta√ß√£o, em especial quando n√£o se usa CAD (&lt;em&gt;Computer Aided Design&lt;/em&gt;) para se desenhar os circuitos (i.e. desenhos em papel). Erros muito comuns quando usamos o papel s√£o: confundir a simbologia (e.g. usar uma porta OR no lugar de uma XOR) e assumir conex√µes que n√£o deveriam ocorrer ou vice-versa (e.g. o cruzamento de dois fios). O tempo total de um projeto tamb√©m diminui pois descrever textualmente o circuito toma menos tempo que desenh√°-lo.&lt;/p&gt;
&lt;p&gt;A descri√ß√£o HDL √© tamb√©m simul√°vel, em muitos casos at√© mesmo com a previs√£o de m√©tricas que s√≥ seriam poss√≠veis ap√≥s a s√≠ntese do circuito, como o consumo de energia ou o atraso. Diagramas usando CAD s√£o simul√°veis tamb√©m, mas h√° menos ferramentas para simula√ß√£o em diagrama esquem√°tico que em HDL. De modo geral, de forma profissional ainda se usam formas de express√£o gr√°ficas, mas usando diagramas em blocos gerados automaticamente por ferramentas EDA a partir de descri√ß√µes feitas em uma HDL.&lt;/p&gt;
&lt;table style="width:100%"&gt;
 &lt;tr&gt;
   &lt;td&gt;&lt;i class="fas fa-info fa-2x"  style="color: #0066ff;"&gt;&lt;/i&gt;&lt;/th&gt;
   &lt;td&gt;
    Um software com problemas pode ser corrigido, gerando uma nova vers√£o. Com o devido cuidado, as atualiza√ß√µes s√£o realizadas e o problema est√° resolvido. Em hardware, uma vez que voc√™ fabrique o circuito, n√£o h√° mais volta e √© muito complicado corrigir problemas, tornando invi√°vel qualquer corre√ß√£o que demande interven√ß√£o f√≠sica. Por este motivo, cerca de 70% do tempo de um projeto de hardware √© gasto em simula√ß√£o e verifica√ß√£o. As ferramentas para hardware s√£o mais conservadoras e maduras pois h√° pouco espa√ßo para ideias n√£o confi√°veis. Uma mudan√ßa em uma linguagem de programa√ß√£o demora dias ou meses para acontecer, enquanto em HDLs demoram anos.
   &lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;Em um diagrama esquem√°tico, a √∫nica maneira de descri√ß√£o sintetiz√°vel √© a estrutural, ou seja, a liga√ß√£o entre portas l√≥gicas. No entanto, as HDLs permitem descri√ß√µes em n√≠veis de abstra√ß√£o mais altos, o que chamamos de descri√ß√µes funcionais. √â poss√≠vel fazer um somador em HDL usando o operador &lt;code&gt;+&lt;/code&gt; por exemplo, deixando a cargo do sintetizador escolher como a soma dos bits √© realizada. Os algoritmos de s√≠ntese modernos s√£o avan√ßados suficientemente para produzir circuitos melhores ou similares aos circuitos produzidos manualmente. Al√©m disso, verificar a corretude de um circuito √© muito mais simples em HDL que em diagramas esquem√°ticos.&lt;/p&gt;
&lt;p&gt;Como as HDLs principais (VHDL e Verilog) s√£o padr√µes est√°veis aceitos mundialmente, as ferramentas podem assumir a interpreta√ß√£o de um c√≥digo com seguran√ßa, possibilitando a iteroperabilidade entre ferramentas, o que torna a s√≠ntese e verifica√ß√£o autom√°ticas. Dizemos que a descri√ß√£o em uma HDL √© mais precisa que em outros tipos de descri√ß√£o. H√° outros tipos que s√£o mais formais ou mais precisos, mas s√£o pouco utilizados pois s√£o muito complexos (e.g. √© invi√°vel descrever um processador usando √°lgebra booleana). Esta padroniza√ß√£o possibilita que, por exemplo, voc√™ descreva o seu circuito, simule, teste, e quando estiver satisfeito, envie para uma f√°brica de circuitos, que transformar√° a sua descri√ß√£o em um &lt;em&gt;chip&lt;/em&gt; de verdade.&lt;/p&gt;
&lt;table style="width:100%"&gt;
 &lt;tr&gt;
   &lt;td&gt;&lt;i class="fas fa-info fa-2x"  style="color: #0066ff;"&gt;&lt;/i&gt;&lt;/td&gt;
   &lt;td&gt;
    O custo de produ√ß√£o de um &lt;em&gt;chip&lt;/em&gt; √© de algumas centenas de milhares de d√≥lares, facilmente atingindo alguns milhares de d√≥lares dependendo da complexidade. Por√©m, o custo recorrente (depois de fabricado o primeiro) √© muito baixo, na ordem de centavos de d√≥lares.
   &lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
   &lt;td&gt;&lt;i class="fas fa-info fa-2x"  style="color: #0066ff;"&gt;&lt;/i&gt;&lt;/td&gt;
   &lt;td&gt;
    A fabrica√ß√£o de circuitos n√£o faz parte da engenharia de computa√ß√£o e sim da microeletr√¥nica, uma especializa√ß√£o da engenharia de eletricidade.
   &lt;/td&gt;
 &lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;Os circuitos em HDL s√£o facilmente modulariz√°veis, o que significa que voc√™ pode usar t√©cnicas de projeto hier√°rquicas quase sem esfor√ßo. √â poss√≠vel dividir um circuito grande em v√°rios pequenos, e as descri√ß√µes s√£o facilmente reaproveit√°veis por outros circuitos. Existe inclusive um mercado para isso: a venda de IPs (&lt;em&gt;Intellectual Property&lt;/em&gt;), que nada mais s√£o que m√≥dulos prontos pr√© testados e validados. √â poss√≠vel comprar uma descri√ß√£o de hardware e incorpor√°-la ao seu projeto, economizando tempo de desenvolvimento.&lt;/p&gt;
&lt;h1&gt;Desvantagens de HDLs&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Descrever circuitos √© diferente de programar.&lt;/li&gt;
&lt;li&gt;√â necess√°rio conhecer circuitos digitais.&lt;/li&gt;
&lt;li&gt;S√£o necess√°rias ferramentas especiais.&lt;/li&gt;
&lt;li&gt;Voc√™ est√° descrevendo um hardware.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Quando usa-se uma HDL para descrever um circuito, estamos usando um paradigma onde descrevemos o que acontece no &lt;strong&gt;fluxo de dados&lt;/strong&gt;. As linguagens de programa√ß√£o imperativas, em contrapartida, descrevem o que acontece com o &lt;strong&gt;fluxo de controle&lt;/strong&gt;. Algumas linguagens de programa√ß√£o possuem suporte ao controle do fluxo de dados, na maioria das vezes atrav√©s de paradigmas matem√°ticos (e.g. linguagens funcionais, como Scala), mas elas n√£o s√£o muito populares pela dificuldade no uso. J√° para descri√ß√µes de hardware, a caracter√≠stica inerentemente concorrente torna a descri√ß√£o do fluxo de dados obrigat√≥ria.&lt;/p&gt;
&lt;h2&gt;Exemplo&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;alarme&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;j0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;en0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;s0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;portaslogicas&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;alarme&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;j2n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j3n&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;janelas&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="n"&gt;j2n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;j2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;j3n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;j3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;s0&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;janelas&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;en0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;janelas&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;j0&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="n"&gt;j1&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="n"&gt;j2n&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="n"&gt;j3n&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;No exemplo acima em VHDL, o comportamento do circuito √© descrito nas linhas de 12 a 15. Estas linhas podem ser colocadas em qualquer ordem e o comportamento do circuito continuar√° id√™ntico! VHDL √© concorrente por natureza e estamos descrevendo a liga√ß√£o entre as portas l√≥gicas de um circuito (i.e. controlando o fluxo de dados). Tanto faz se voc√™ descreve a liga√ß√£o do inversor da linha 13 antes ou depois da liga√ß√£o da porta OU da linha 15, o circuito final ser√° o mesmo.&lt;/p&gt;
&lt;p&gt;Esta caracter√≠stica √© principal dificuldade dos projetistas de hardware iniciantes e √© agravada naqueles que j√° possuem experi√™ncia pr√©via com linguagens de programa√ß√£o pois tendem a descrever o hardware como se fosse um programa, o que n√£o √© poss√≠vel. Uma vez que voc√™ comece a pensar concorrentemente, a dificuldade para aprender uma HDL cai consideravelmente e a maioria dos problemas que os iniciantes enfrentam se tornam triviais.&lt;/p&gt;
&lt;p&gt;Uma outra desvantagem de HDLs √© que √© necess√°rio saber projetar um circuito digital. A HDL √© uma forma de express√£o de um projeto de um hardware, ent√£o n√£o adianta voc√™ aprender uma HDL se n√£o sabe projetar um hardware. Uma analogia que uso muito entre os alunos de gradua√ß√£o √© a com idiomas: se voc√™ ensinar um idioma para um papagaio, ele certamente repetir√° o que voc√™ ensinou, at√© mesmo com sotaque. Mas este papagaio n√£o ser√° capaz de criar frases novas com o que aprendeu e com certeza n√£o sabe o significado sem√¢ntico das constru√ß√µes l√©xicas. Com HDL acontece o mesmo: √© necess√°rio saber projetar um circuito digital antes de aprender se expressar. De fato, os bons projetistas pensam na solu√ß√£o (normalmente imaginando um diagrama esquem√°tico ou outra forma gr√°fica) e s√≥ depois expressam-no usando HDL.&lt;/p&gt;
&lt;p&gt;Apesar do suporte √† HDL ser relativamente bom (existem v√°rios &lt;a href="https://balbertini.github.io/vhdl_simulators-pt_BR.html"&gt;simuladores e sintetizadores de HDL&lt;/a&gt;), n√£o √© poss√≠vel usar as ferramentas comuns de software. N√£o √© poss√≠vel compilar um hardware, por exemplo, tampouco usar depuradores (&lt;em&gt;debuggers&lt;/em&gt;) similares aos de software pelo simples motivo que n√£o √© poss√≠vel passar linha por linha em uma descri√ß√£o vendo o que acontece. As ferramentas s√£o divididas em duas categorias distintas: os simuladores e os sintetizadores.&lt;/p&gt;
&lt;p&gt;Os simuladores conseguem gerar algo que voc√™ pode executar na sua m√°quina e obter o comportamento do hardware, o que possibilita testar, verificar e simular a sua descri√ß√£o. Os simuladores atuais s√£o bons o suficiente para que a simula√ß√£o seja muito pr√≥xima do hardware real. √â poss√≠vel at√© mesmo estimar o consumo de energia ou o atraso do hardware descrito usando apenas simula√ß√£o. Nesta fase, poucas ferramentas de depura√ß√£o s√£o dispon√≠veis e o m√©todo mais comum de testar √© escrever um &lt;a href="https://balbertini.github.io/vhdl_testbench-pt_BR.html"&gt;&lt;em&gt;testbench&lt;/em&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;J√° os sintetizadores s√£o ferramentas que transformam a sua descri√ß√£o em um hardware real. A s√≠ntese √© dependente de tecnologia, ent√£o quando voc√™ chega na fase de s√≠ntese deve escolher o que ir√° fazer com o seu circuito (e.g. configurar um FPGA, enviar para uma f√°brica de &lt;em&gt;chips&lt;/em&gt; ou simplesmente simular em uma tecnologia espec√≠fica). O hardware sintetizado pode ser simulado tamb√©m e as m√©tricas obtidas s√£o mais precisas, chegando a mais de 99% de confiabilidade (e.g. se medir um determinado atrase, ele ser√° quase que o mesmo do circuito real depois de fabricado). √â poss√≠vel ainda depurar seu circuito usando uma variadade de t√©cnicas (e.g. &lt;em&gt;scan-chain&lt;/em&gt;), pois o modelo de simula√ß√£o j√° est√° atrelado √† tecnologia alvo. No entanto, a s√≠ntese normalmente s√≥ √© realizada no final da prototipa√ß√£o pois √© muito demorada. Para efeito de compara√ß√£o, compilar e executar um software leva segundos, gerar um simulador e execut√°-lo para uma descri√ß√£o de hardware leva minutos, e sintetizar e simular um hardware leva horas (em projetos complexos como um processador moderno, a simula√ß√£o sobe para horas e a s√≠ntese para dias).&lt;/p&gt;
&lt;p&gt;Por √∫ltimo, √© comum os projetistas esquecerem que est√£o descrevendo um hardware. N√£o existe &lt;code&gt;printf&lt;/code&gt;, n√£o existem &lt;em&gt;breakpoints&lt;/em&gt; e n√£o existe nem mesmo sistema operacional ou chamada de fun√ß√µes. Se voc√™ est√° projetando um processador, voc√™ esta projetanto a pe√ßa que ir√° suportar tudo isso! Se voc√™ quiser uma comunica√ß√£o textual estilo &lt;em&gt;prompt&lt;/em&gt; de comando com o seu hardware, voc√™ √© o respons√°vel por adicionar uma interface serial e fazer a comunica√ß√£o com ele. Se voc√™ quer uma interface gr√°fica, ter√° que descrev√™-la como um hardware (ou adicionar um m√≥dulo pronto que fa√ßa isso). Orienta√ß√£o a objetos? Coleta de lixo? Esque√ßa! Isso √© um conceito abstrato √∫til para for√ßar uma certa organiza√ß√£o dos programadores de software. Apesar de termos paradigmas similares em hardware (e.g. modulariza√ß√£o), isso √© responsabilidade sua e n√£o da linguagem.&lt;/p&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="basic"></category></entry><entry><title>Tipos agregados em VHDL</title><link href="https://balbertini.github.io/vhdl_aggregate-pt_BR.html" rel="alternate"></link><published>2019-09-05T16:22:44-03:00</published><updated>2019-09-09T10:16:11-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2019-09-05:/vhdl_aggregate-pt_BR.html</id><summary type="html">&lt;p&gt;Como usar tipos agregados em VHDL&lt;/p&gt;</summary><content type="html">&lt;p&gt;VHDL suporta um tipo de dado chamado de &lt;strong&gt;agregado&lt;/strong&gt;, que nada mais √© que uma cole√ß√£o de sinais, representada por um vetor ou um registro. O vetor √© o mais utilizado pois representa um conjunto de fios no hardware sintetizado.&lt;/p&gt;
&lt;h2&gt;Vetores&lt;/h2&gt;
&lt;p&gt;Os dois tipos de dados mais utilizados em VHDL, &lt;code&gt;bit&lt;/code&gt; e &lt;code&gt;std_logic&lt;/code&gt; possuem vers√µes em vetores pr√©-definidas, o &lt;code&gt;bit_vector&lt;/code&gt; e o &lt;code&gt;std_logic_vector&lt;/code&gt;. A vers√£o em &lt;code&gt;bit&lt;/code&gt; √© nativa, portanto voc√™ pode utiliz√°-la imediadamente na sua descri√ß√£o. No caso do &lt;code&gt;std_logic&lt;/code&gt;, como o tipo √© considerado uma extens√£o do VHDL, deve-se incluir a biblioteca &lt;code&gt;ieee.std_logic_1164&lt;/code&gt; antes da sua utiliza√ß√£o.&lt;/p&gt;
&lt;p&gt;No entanto, pode-se definir um vetor de &lt;a href="https://balbertini.github.io/vhdl_datatypes-pt_BR.html"&gt;qualquer tipo suportado&lt;/a&gt;. A palavra chave para definir-se um vetor √© &lt;code&gt;array&lt;/code&gt;. Declara-se um tipo de dados personalizado com a palavra reservada &lt;code&gt;type&lt;/code&gt; e usa-se o &lt;code&gt;array&lt;/code&gt; para especificar um vetor. Ap√≥s a declara√ß√£o, pode-se usar o tipo agregado como um tipo qualquer.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="n"&gt;meu_vetor&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="k"&gt;array&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;meu_conjunto_de_fios&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;meu_vetor&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;mv&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;meu_vetor&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O trecho acima ir√° gerar um conjunto de tr√™s fios (chamado &lt;code&gt;meu_conjunto_de_fios&lt;/code&gt;) do tipo que podem ser acessados como um √∫nico. Sabemos que para um vetor de &lt;code&gt;bit&lt;/code&gt; poder√≠amos usar simplesmente &lt;code&gt;signal meu_conjunto_de_fios: bit_vector(2 downto 0);&lt;/code&gt;, por√©m a declara√ß√£o pode ser usada para qualquer outro tipo e √© especialmente √∫til quando estamos modelando &lt;a href="https://balbertini.github.io/vhdl_mem-pt_BR.html"&gt;mem√≥rias&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;√â poss√≠vel declarar vetores de vetores, criando estruturas multidimensionais.&lt;/p&gt;
&lt;h3&gt;Utilizando Vetores&lt;/h3&gt;
&lt;p&gt;Para acessar um elemento de um vetor, basta usar a indexa√ß√£o. E.g. &lt;code&gt;a&amp;lt;=mv(0)&lt;/code&gt; ir√° atribuir o bit menos significativo do vetor &lt;code&gt;mv&lt;/code&gt; ao sinal &lt;code&gt;a&lt;/code&gt;. √â importante notar que &lt;code&gt;a&lt;/code&gt; deve ser do mesmo tipo declarado no tipo do vetor, nesse caso &lt;code&gt;bit&lt;/code&gt;. A ordem em que os √≠ndices s√£o acessados tamb√©m depende da declara√ß√£o do vetor. Como declaramos o &lt;code&gt;meu_vetor&lt;/code&gt; como &lt;code&gt;(2 downto 0)&lt;/code&gt;, o bit menos significativo ser√° o &lt;code&gt;0&lt;/code&gt;. Se declar√°ssemos &lt;code&gt;(0 to 2)&lt;/code&gt;, o bit menos significativo deveria ser acessado com &lt;code&gt;mv(2)&lt;/code&gt;. Lembre-se que a signific√¢ncia de um conjunto de bits √© uma conven√ß√£o, que assumimos sempre como o menos significativo sendo o bit mais a direita.&lt;/p&gt;
&lt;p&gt;Para escrever em um vetor tamb√©m usamos os par√™nteses (como na indexa√ß√£o), mas temos duas alternativas: associa√ß√£o posicional ou nomeada.&lt;/p&gt;
&lt;p&gt;Na &lt;strong&gt;associa√ß√£o posicional&lt;/strong&gt;, os elementos s√£o associados sempre em ordem, da esquerda para a direita. E.g. &lt;code&gt;mv &amp;lt;= (c,b,a);&lt;/code&gt; equivale a &lt;code&gt;mv(0)&amp;lt;=a;&lt;/code&gt;, &lt;code&gt;mv(1)&amp;lt;=b;&lt;/code&gt; e &lt;code&gt;mv(2)&amp;lt;=c;&lt;/code&gt;. √â recomendado que todas as posi√ß√µes do vetor estejam preenchidas e o tipo de cada uma deve ser do mesmo tipo declarado no tipo do vetor. Tamb√©m √© poss√≠vel associarmos posicionalmente usando um operador de concatena√ß√£o:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mv&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;-- todos devem ser bits&lt;/span&gt;
&lt;span class="n"&gt;mv&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;a2&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;-- a2 √© um vetor de duas posi√ß√µes&lt;/span&gt;
&lt;span class="n"&gt;mv&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;mv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;mv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;-- rotacao para esquerda&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A parte importante da atribui√ß√£o posicional √© conter todos os elementos do vetor (o que implica que o tipo e o tamanho devem ser id√™nticos). Constantes literais tamb√©m s√£o aceitas, bastando retirar os par√™nteses, como em &lt;code&gt;mv&amp;lt;="101";&lt;/code&gt;, obviamente respeitando o tipo e tamanho.&lt;/p&gt;
&lt;p&gt;A segunda maneira √© chamada de &lt;strong&gt;associa√ß√£o nomeada&lt;/strong&gt;. Neste tipo de associa√ß√£o podemos atribuir os valores sem respeitar a ordem, nomeando-os. E.g. &lt;code&gt;mv&amp;lt;=(0=&amp;gt;a,2=&amp;gt;c,1=&amp;gt;b);&lt;/code&gt; equivale a &lt;code&gt;mv &amp;lt;= (c,b,a);&lt;/code&gt;. A utilidade principal deste tipo de atribui√ß√£o √© atribuir valores somente para as posi√ß√µes de interesse. mas n√£o √© necess√°rio atribuir para todos os elementos do vetor? Sim, mas temos uma palavra chave que diz exatamente o que fazer com todos as posi√ß√µes n√£o especificadas:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mv&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;-- atribui√ß√£o 0c0&lt;/span&gt;
&lt;span class="n"&gt;mv&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;-- 0c1&lt;/span&gt;
&lt;span class="n"&gt;mv&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;-- 000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Note que &lt;strong&gt;n√£o&lt;/strong&gt; precisamos saber o tamanho do vetor para usar &lt;code&gt;others&lt;/code&gt;, ent√£o este tipo de atribui√ß√£o √© muito √∫til quando associada com &lt;a href="https://balbertini.github.io/vhdl_generic-pt_BR.html"&gt;generics&lt;/a&gt;. De fato, a constru√ß√£o &lt;code&gt;vetor&amp;lt;=(others=&amp;gt;'0');&lt;/code&gt; zera qualquer vetor cujo tipo seja compat√≠vel com o literal &lt;code&gt;'0'&lt;/code&gt;, independentemente do tamanho.&lt;/p&gt;
&lt;h2&gt;Registros&lt;/h2&gt;
&lt;p&gt;Quando todos os elementos do vetor s√£o do mesmo tipo, usamos o &lt;code&gt;array&lt;/code&gt; para declar√°-lo, mas e se os tipos n√£o forem os mesmos? A palava chave &lt;code&gt;record&lt;/code&gt; serve exatamente para isso. Suponha que eu quero um conjunto de seis fios, sendo um &lt;em&gt;clock&lt;/em&gt;, um inteiro sem sinal de quatro bits e um &lt;em&gt;flag&lt;/em&gt; que pode ser &lt;em&gt;tri-state&lt;/em&gt;.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="n"&gt;meu_registro&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="k"&gt;record&lt;/span&gt;
  &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;mi&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt; &lt;span class="k"&gt;range&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;mf&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;std_logic&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;record&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Se declararmos um &lt;code&gt;signal mr: meu_registro;&lt;/code&gt;, teremos um conjunto de fios que representam exatamente o que est√° no registro. As atribui√ß√µes seguem as mesmas regras que para o vetor, inclusive para associa√ß√£o nomeada.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mr&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;mr&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;ck&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mi&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mf&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;As ferramentas de s√≠ntese na sua maioria n√£o suportam a s√≠ntese completa de registros, portanto evite-os em descri√ß√µes sintetiz√°veis.&lt;/p&gt;
&lt;h2&gt;Convers√£o&lt;/h2&gt;
&lt;p&gt;Muitas pessoas se confundem quando convertem entre agregados. Veja este post sobre &lt;a href="https://balbertini.github.io/vhdl_conversion-pt_BR.html"&gt;convers√£o de dados&lt;/a&gt; para um guia de como fazer a convers√£o corretamente.&lt;/p&gt;
&lt;h2&gt;Considera√ß√µes&lt;/h2&gt;
&lt;p&gt;Se voc√™ est√° na gradua√ß√£o ou est√° aprendendo a descrever hardware, seguem algumas dicas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Evite matrizes (vetores multidimensionais) pois voc√™ tender√° a esgotar seus recursos de projeto rapidamente. A exce√ß√£o s√£o mem√≥rias pois n√£o h√° outra maneira de descrev√™-las.&lt;/li&gt;
&lt;li&gt;A atribui√ß√£o nomeada pode n√£o ser sintetiz√°vel pelo seu software. Para evitar problemas, sempre fa√ßa uma atribui√ß√£o completa (para todos os elementos do vetor) e use &lt;code&gt;others&lt;/code&gt; somente para fazer o &lt;em&gt;reset&lt;/em&gt; de elementos de mem√≥ria.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Se voc√™ est√° na p√≥s-gradua√ß√£o, este guia n√£o √© suficiente para voc√™ e voc√™ deve seriamente considerar constru√ß√µes mais avan√ßadas, mas seguir as dicas acima n√£o prejudicar√° seu poder de express√£o, somente deixar√° seu c√≥digo mais prolixo.&lt;/p&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="basic"></category></entry><entry><title>Convers√£o e Cast</title><link href="https://balbertini.github.io/vhdl_conversion-pt_BR.html" rel="alternate"></link><published>2019-09-05T16:22:44-03:00</published><updated>2021-01-31T18:30:36-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2019-09-05:/vhdl_conversion-pt_BR.html</id><summary type="html">&lt;p&gt;Como converter entre tipos em VHDL&lt;/p&gt;</summary><content type="html">&lt;p&gt;VHDL √© uma linguagem fortemente tipada, o que na pr√°tica significa que voc√™ n√£o pode atribuir um sinal de um tipo a outro diretamente.&lt;/p&gt;
&lt;p&gt;No entanto, convers√µes entre tipos relacionados s√£o muito comuns, ent√£o apresentaremos aqui algumas formas de convers√£o.&lt;/p&gt;
&lt;h2&gt;Tipos agregados&lt;/h2&gt;
&lt;p&gt;H√° uma diferen√ßa muito grande entre tipos agregados e nativos.&lt;/p&gt;
&lt;p&gt;Uma das convers√µes mais comuns que existem em VHDL √© de/para inteiros, pois estes s√£o utilizados como indexadores ou comparadores com literais constantes. O inteiro no entanto, √© um tipo nativo do VHDL enquanto que outros tipos, como &lt;code&gt;unsigned&lt;/code&gt; ou &lt;code&gt;signed&lt;/code&gt; s√£o tipos compostos, considerados agregados (s√£o como vetores de bits com um significado especial). Os tipos vetores, em especial o &lt;code&gt;bit_vector&lt;/code&gt; e o &lt;code&gt;std_logic_vector&lt;/code&gt; tamb√©m s√£o vetores de bits, por√©m n√£o tem nenhum significado associado fora os definidos pelo seus respectivos tipos base.&lt;/p&gt;
&lt;p&gt;Para converter entre um tipo num√©rico e um agregado, √© necess√°rio uma fun√ß√£o de convers√£o pois s√£o tipos diferentes dentro da linguagem. J√° entre dois tipos num√©ricos ou entre dois tipos agregados, √© necess√°rio somente um &lt;em&gt;cast&lt;/em&gt;. Exceto pelo &lt;code&gt;bit_vector&lt;/code&gt;, todos os outros tipos e convers√µes precisam ser descritos, por√©m h√° bibliotecas padronizadas para todas as convers√µes poss√≠veis.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="right"&gt;Tipo&lt;/th&gt;
&lt;th align="center"&gt;Biblioteca&lt;/th&gt;
&lt;th align="center"&gt;Categoria&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;bit&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;nativo&lt;/td&gt;
&lt;td align="center"&gt;Simples&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;bit_vector&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;nativo&lt;/td&gt;
&lt;td align="center"&gt;Agregado&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;std_logic&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;code&gt;ieee.std_logic_1164&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;Enumerado&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;std_logic_vector&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;&lt;code&gt;ieee.std_logic_1164&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;Agregado&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Ao incluir a biblioteca &lt;code&gt;ieee.std_logic_1164&lt;/code&gt;, passamos a ter acesso aos tipos baseados em &lt;code&gt;std_logic&lt;/code&gt;. As bibliotecas padronizadas com as rotinas de convers√£o s√£o as &lt;code&gt;ieee.numeric_std&lt;/code&gt; para os derivados de &lt;code&gt;std_logic&lt;/code&gt;, e a &lt;code&gt;ieee.numeric_bit&lt;/code&gt; para os tipos derivados do &lt;code&gt;bit&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;As fun√ß√µes de convers√£o dispon√≠veis na &lt;code&gt;numeric_bit&lt;/code&gt; podem ser vista na figura:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Tabela de convers√£o de tipos da numeric_bit." src="https://balbertini.github.io/images/vhdl/conversaobitvectortabela.png"&gt;&lt;/p&gt;
&lt;p&gt;Em cinza as c√©lulas que dispensam de convers√£o (mesmo tipo), amarelo as que requerem uma fun√ß√£o de convers√£o espec√≠fica, verde as que dispensam a convers√£o mas precisam de um &lt;em&gt;cast&lt;/em&gt; para mudar a sem√¢ntica de interpreta√ß√£o. Em vermelho as convers√µes indispon√≠veis diretamente.&lt;/p&gt;
&lt;p&gt;De &lt;code&gt;integer&lt;/code&gt; para qualquer um dos outros tipos, temos que usar uma fun√ß√£o de convers√£o (em amarelo na tabela), que come√ßam com &lt;code&gt;to_&lt;/code&gt;. S√£o elas:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;I to_integer(S)&lt;/code&gt;: recebe um &lt;code&gt;signed&lt;/code&gt; e retorna um inteiro;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;I to_integer(U)&lt;/code&gt;: recebe um &lt;code&gt;unsigned&lt;/code&gt; e retorna um inteiro;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;S to_signed(I,S'lenght)&lt;/code&gt;: recebe um inteiro e retorna um &lt;code&gt;signed&lt;/code&gt;, segundo par√¢metro √© o tamanho do &lt;code&gt;signed&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;U to_unsigned(I,U'lenght)&lt;/code&gt;: recebe um inteiro e retorna um &lt;code&gt;unsigned&lt;/code&gt;, segundo par√¢metro √© o tamanho do &lt;code&gt;unsigned&lt;/code&gt;;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Nas convers√µes para inteiro, o inteiro resultante ter√° o tamanho necess√°rio para acomodar o tipo de origem (normalmente um bit a mais), mas a defini√ß√£o final do tamanho do inteiro depende do sintetizador. Nas convers√µes de inteiros, o tamanho do retorno deve ser especificado pois um inteiro tem tamanho indefinido, mas os vetores tem tamanho definido (veja &lt;a href="https://balbertini.github.io/vhdl_datatypes-pt_BR.html"&gt;o post sobre tipos de dados&lt;/a&gt; para limita√ß√µes dos simuladores/sintetizadores).&lt;/p&gt;
&lt;p&gt;Os demais tipos s√£o todos vetores de bits, portanto n√£o precisamos converter o tipo mas sim fazer um &lt;em&gt;cast&lt;/em&gt;, ou seja, ordenar o sintetizador a interpretar os dados com uma sem√¢ntica diferente. O &lt;em&gt;cast&lt;/em&gt; pode ser feito usando o tipo de destino e colocando a origem entre par√™nteses:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;V bit_vector(S)&lt;/code&gt;: recebe um &lt;code&gt;signed&lt;/code&gt; e o interpreta como um &lt;code&gt;bit_vector&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;V bit_vector(U)&lt;/code&gt;: recebe um &lt;code&gt;unsigned&lt;/code&gt; e o interpreta como um &lt;code&gt;bit_vector&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;S signed(V)&lt;/code&gt;: recebe um &lt;code&gt;bit_vector&lt;/code&gt; e o interpreta como &lt;code&gt;signed&lt;/code&gt;;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;U unsigned(V)&lt;/code&gt;: recebe um &lt;code&gt;bit_vector&lt;/code&gt; e o interpreta como &lt;code&gt;unsigned&lt;/code&gt;;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note que isto n√£o √© uma fun√ß√£o de convers√£o, o sintetizador apenas interpretar√° aquele conjunto de bits (agregado) com uma sem√¢ntica diferente do tipo original declarado.&lt;/p&gt;
&lt;p&gt;Para resumir, veja o diagrama abaixo:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Diagrama de convers√£o de tipos baseados em BIT." src="https://balbertini.github.io/images/vhdl/vhdlconversao.png"&gt;&lt;/p&gt;
&lt;p&gt;O diagrama acima foi inspirado no diagrama do site &lt;a href="http://www.bitweenie.com/listings/vhdl-type-conversion/"&gt;BitWeenie&lt;/a&gt; para &lt;code&gt;std_logic&lt;/code&gt;. Se o tipo base que voc√™ est√° usando e o &lt;code&gt;std_logic&lt;/code&gt;, voc√™ deve incluir a biblioteca &lt;code&gt;numeric_std&lt;/code&gt; pois as convers√µes de/para este tipo est√£o nesta biblioteca.&lt;/p&gt;
&lt;h3&gt;Contribui√ß√µes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;25/set/2020: Arthur Lopes corrigiu o tipo do &lt;code&gt;std_logic&lt;/code&gt; na tabela e o &lt;code&gt;bit_vector(U)&lt;/code&gt;  no diagrama.&lt;/li&gt;
&lt;/ul&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="basic"></category></entry><entry><title>Instanciando componentes parametricamente</title><link href="https://balbertini.github.io/vhdl_generate-pt_BR.html" rel="alternate"></link><published>2019-09-02T19:48:57-03:00</published><updated>2019-09-09T10:16:11-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2019-09-02:/vhdl_generate-pt_BR.html</id><summary type="html">&lt;p&gt;Usando o generate em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Em muitas situa√ß√µes, n√£o sabemos de antem√£o quantas inst√¢ncias de determinado componente precisaremos pois este n√∫mero √© parametriz√°vel. Em VHDL, h√° a constru√ß√£o &lt;code&gt;generate&lt;/code&gt; que permite instanciar componentes e fazer liga√ß√µes para as inst√¢ncias de modo program√°tico, dependendo de um par√¢metro. A √∫nica restri√ß√£o para que esta constru√ß√£o seja sintetiz√°vel √© que todos os par√¢metros sejam resolv√≠veis no momento da s√≠ntese.&lt;/p&gt;
&lt;h2&gt;Sintaxe&lt;/h2&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nc"&gt;nome&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;parametro&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;lista&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt;
    &lt;span class="n"&gt;primitivas&lt;/span&gt; &lt;span class="n"&gt;concorrentes&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt; &lt;span class="nc"&gt;nome&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Onde &lt;code&gt;nome&lt;/code&gt; √© opcional e pode ser um nome qualquer para este &lt;em&gt;for-generate&lt;/em&gt;. O &lt;code&gt;parametro&lt;/code&gt; √© o nome do par√¢metro que ir√° variar dentro do la√ßo, assumindo os valores da &lt;code&gt;lista&lt;/code&gt;, e as primitivas concorrentes s√£o as que ser√£o instanciadas parametricamente (usando o par√¢metro definido no la√ßo).&lt;/p&gt;
&lt;p&gt;O par√¢metro deve ser algo resolv√≠vel pois o sintetizador ir√° substituir as primitivas concorrentes por v√°rias c√≥pias das mesmas primitivas, variando o par√¢metro. A id√©ia √© que o projetista possa instanciar v√°rias inst√¢ncias do mesmo componente de uma s√≥ vez. Com o exemplo, a utiliza√ß√£o ficar√° mais clara, ent√£o vamos l√°!&lt;/p&gt;
&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;p&gt;Suponha que tenhamos a seguinte descri√ß√£o de um &lt;em&gt;flip-flop&lt;/em&gt; tipo D:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;ffd&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;processor&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;ffd&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="nc"&gt;sequencial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;elsif&lt;/span&gt; &lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Para fazer um registrador simples com &lt;span class="math"&gt;\(n\)&lt;/span&gt; bits baseado neste &lt;em&gt;flip-flop&lt;/em&gt;, devemos montar a seguinte estrutura:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Registrador Simples com FFD" src="https://balbertini.github.io/images/vhdl/regffd.png"&gt;&lt;/p&gt;
&lt;p&gt;Em VHDL, a estrutura base deste registrador (parametriz√°vel), fica como abaixo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;registrador&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;generic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;natural&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;arch&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;registrador&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="nc"&gt;ffd&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;component&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="nc"&gt;regs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt;
    &lt;span class="n"&gt;ffs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ffd&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Observe o &lt;code&gt;generate&lt;/code&gt; na arquitetura. A linha &lt;code&gt;ffs: ffd port map(clock, d(i), reset, q(i));&lt;/code&gt; instanciar√° &lt;span class="math"&gt;\(n\)&lt;/span&gt; &lt;em&gt;flip-flops&lt;/em&gt;, cada um ligado em um fio dos vetores (conjunto de fios) &lt;code&gt;d&lt;/code&gt; e &lt;code&gt;q&lt;/code&gt;, mas compartilhando o mesmo &lt;em&gt;clock&lt;/em&gt; e &lt;em&gt;reset&lt;/em&gt;. O fio do vetor que cada inst√¢ncia usar√° depende do par√¢metro &lt;code&gt;i&lt;/code&gt;, que ir√° variar de &lt;code&gt;n-1&lt;/code&gt; at√© &lt;code&gt;0&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Note que o nome da inst√¢ncia n√£o leva √≠ndice e fica s√≥ como &lt;code&gt;ffs&lt;/code&gt;. Cada sintetizador tem uma maneira de diferenciar as inst√¢ncias, mas a maioria deles colocar√° algum tipo de √≠ndice na inst√¢ncia. Quando formos usar este registrador, se setarmos o par√¢metro &lt;code&gt;n&lt;/code&gt; como 4 durante a instancia√ß√£o, o sintetizador instanciar√° quatro &lt;em&gt;flip-flops&lt;/em&gt;, chamados por exemplo de &lt;code&gt;ffs_3&lt;/code&gt;, &lt;code&gt;ffs_2&lt;/code&gt;, &lt;code&gt;ffs_1&lt;/code&gt; e &lt;code&gt;ffs_0&lt;/code&gt;. De fato, o c√≥digo acima ser√° transformado em algo similar a:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;arch&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;registrador&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="nc"&gt;ffd&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;component&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="n"&gt;ffs_3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ffd&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
  &lt;span class="n"&gt;ffs_2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ffd&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
  &lt;span class="n"&gt;ffs_1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ffd&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
  &lt;span class="n"&gt;ffs_0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ffd&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A √∫nica diferen√ßa √© que o sintetizador √© quem far√° o "desenrolamento" do la√ßo &lt;em&gt;for-generate&lt;/em&gt;, permitindo que o projetista descreva um hardware gen√©rico cujo tamanho n√£o √© conhecido.&lt;/p&gt;
&lt;h2&gt;Condicionando o &lt;em&gt;for-generate&lt;/em&gt;&lt;/h2&gt;
&lt;p&gt;Quando a estrutura √© regular como no caso do registrador, o &lt;em&gt;for-generate&lt;/em&gt; √© muito √∫til e simples de usar. Mas e se houver pequenas diferen√ßas? Para isso, h√° o &lt;em&gt;if-generate&lt;/em&gt;, cuja sintaxe √©:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;nome&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;condicao&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt;
  &lt;span class="n"&gt;primitivas&lt;/span&gt; &lt;span class="n"&gt;concorrentes&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt; &lt;span class="nc"&gt;nome&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Este tipo de &lt;em&gt;if&lt;/em&gt; s√≥ pode ser usado dentro de um &lt;em&gt;for-generate&lt;/em&gt; e serve justamente para fazer pequenas mudan√ßas na estrutura do hardware sendo descrito, sem abrir m√£o da parametriza√ß√£o. Vejamos novamente um exemplo.&lt;/p&gt;
&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;p&gt;Considere o &lt;em&gt;half-adder&lt;/em&gt; (&lt;code&gt;ha&lt;/code&gt;) e o &lt;em&gt;full-adder&lt;/em&gt; (&lt;code&gt;fa&lt;/code&gt;) abaixo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;ha&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;co&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;structural&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;ha&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="k"&gt;xor&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;co&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;fa&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ci&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;co&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;structural&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;fa&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="k"&gt;xor&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="k"&gt;xor&lt;/span&gt; &lt;span class="n"&gt;ci&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;co&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;ci&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;ci&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Um somador simples de &lt;span class="math"&gt;\(n\)&lt;/span&gt; bits tem a seguinte estrutura:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Somador Simples com FFD" src="https://balbertini.github.io/images/vhdl/somador.png"&gt;&lt;/p&gt;
&lt;p&gt;Note que o primeiro componente √© um &lt;em&gt;half-adder&lt;/em&gt; e n√£o possui entrada de &lt;em&gt;carry&lt;/em&gt;, enquanto todos os demais possuem. Usando somente um &lt;em&gt;for-generate&lt;/em&gt; este tipo de constru√ß√£o se torna complicada, inviabilizando sua utiliza√ß√£o. Por√©m, com o uso do &lt;em&gt;if-generate&lt;/em&gt;, podemos quebrar a regularidade do &lt;em&gt;for-generate&lt;/em&gt; somente para alguns elementos selecionados, como na descri√ß√£o do somador abaixo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;somador&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;generic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;bits&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;natural&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bits&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;   &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bits&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;co&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;estrutural&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;somador&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="nc"&gt;ha&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;co&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;component&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="nc"&gt;fa&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ci&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;co&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;component&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bits&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="nc"&gt;fas&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;bits&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt;
    &lt;span class="n"&gt;lsb&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt;
      &lt;span class="n"&gt;hai&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ha&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;msb&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt;
      &lt;span class="n"&gt;fai&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fa&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;generate&lt;/span&gt; &lt;span class="nc"&gt;fas&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;co&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bits&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Dentro do &lt;em&gt;for-generate&lt;/em&gt; temos dois &lt;em&gt;if-generates&lt;/em&gt;: um para o bit menos significativo do somador, que onde deve ser usado um &lt;code&gt;ha&lt;/code&gt; (sem entrada de &lt;em&gt;carry&lt;/em&gt;) e outro para os demais bits, onde deve ser usado um &lt;code&gt;fa&lt;/code&gt; com os &lt;em&gt;carries&lt;/em&gt; sendo ligados sequencialmente. Este tipo de constru√ß√£o chama-se &lt;em&gt;carry propagation&lt;/em&gt; ou &lt;em&gt;ripple carry&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Da mesma forma que o anterior, para um somador de quatro bits, o sintetizador "desenrolar√°" o &lt;em&gt;for-generate&lt;/em&gt; em (declara√ß√£o dos componentes suprimida):&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;estrutural&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;somador&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="p"&gt;...&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bits&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="n"&gt;fai_3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fa&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
  &lt;span class="n"&gt;fai_2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fa&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
  &lt;span class="n"&gt;fai_1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;fa&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
  &lt;span class="n"&gt;hai_0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ha&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;        &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="n"&gt;cots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h1&gt;Resumo&lt;/h1&gt;
&lt;p&gt;O &lt;em&gt;for-generate&lt;/em&gt;, aliado ao &lt;em&gt;if-generate&lt;/em&gt; √© uma poderosa ferramenta para descrever hardware parametriz√°vel em VHDL, pois n√£o sabemos no momento da descri√ß√£o qual o valor do par√¢metro. √â muito usado para estruturas regulares ou com pouca varia√ß√£o. √â poss√≠vel usar outros tipos de primitivas concorrentes dentro do &lt;em&gt;for-generate&lt;/em&gt; que n√£o sejam a instancia√ß√£o de componentes, e √© poss√≠vel at√© mesmo aninhar &lt;em&gt;for-generates&lt;/em&gt; para instanciar matrizes de componentes, por exemplo.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="basic"></category></entry><entry><title>Mem√≥rias em VHDL</title><link href="https://balbertini.github.io/vhdl_mem-pt_BR.html" rel="alternate"></link><published>2019-06-06T10:18:24-03:00</published><updated>2020-11-27T20:29:48-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2019-06-06:/vhdl_mem-pt_BR.html</id><summary type="html">&lt;p&gt;Mem√≥rias em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;As mem√≥rias s√£o parte integrante de qualquer sistema digital sequencial. Enquanto trabalhamos com circuitos simples ou m√°quinas de estado, costumamos usar &lt;em&gt;flip-flops&lt;/em&gt; como elementos de mem√≥ria. Contudo, as tarefas mais complexas n√£o escalam devido ao tamanho dos elementos de mem√≥ria envolvidos. Considerando a tarefa de guardar informa√ß√µes, √© √∫til utilizarmos estruturas de mem√≥rias espec√≠ficas, como RAMs ou ROMs.&lt;/p&gt;
&lt;p&gt;Neste artigo, veremos como representar mem√≥rias do tipo RAM e ROM em VHDL.&lt;/p&gt;
&lt;h2&gt;Descri√ß√£o base&lt;/h2&gt;
&lt;p&gt;Postergaremos a descri√ß√£o da entidade (veja os exemplos no final do artigo), bastando o conhecimento que a mem√≥ria possui uma porta de entrada de endere√ßos (&lt;code&gt;addr&lt;/code&gt;), uma entrada de dados (&lt;code&gt;data_i&lt;/code&gt;) e uma sa√≠da de dados (&lt;code&gt;data_o&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;A mem√≥ria em VHDL ser√° ent√£o uma &lt;strong&gt;matriz&lt;/strong&gt; (&lt;code&gt;array&lt;/code&gt;) do &lt;strong&gt;tipo de dado&lt;/strong&gt; que se quer representar. O tamanho (profundidade) da matriz define o tamanho da mem√≥ria e normalmente √© representado por &lt;span class="math"&gt;\(n\)&lt;/span&gt;, onde &lt;span class="math"&gt;\(n=2^{a_s}\)&lt;/span&gt; e &lt;span class="math"&gt;\(a_s\)&lt;/span&gt; √© o tamanho em bits do endere√ßo &lt;code&gt;addr&lt;/code&gt;. A matriz vai ent√£o de &lt;span class="math"&gt;\(0\)&lt;/span&gt; at√© &lt;span class="math"&gt;\(n-1\)&lt;/span&gt;, contendo efetivamente &lt;span class="math"&gt;\(n\)&lt;/span&gt; posi√ß√µes.&lt;/p&gt;
&lt;p&gt;Cada posi√ß√£o da matriz √© uma palavra de mem√≥ria, representada pelo tipo de dado que se quer armazenar. O tamanho de cada palavra de mem√≥ria √© igual ao tamanho do tipo de dado usado, expresso por &lt;span class="math"&gt;\(d_s\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Vamos ao exemplo, que deve estar no pre√¢mbulo da arquitetura:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="n"&gt;mem_t&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="k"&gt;array&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mem_t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;No trecho, estamos descrevendo duas coisas, uma abstrata (de apoio a representa√ß√£o de hardware) e uma descri√ß√£o f√≠sica (que ir√° de fato gerar um hardware). A descri√ß√£o abstrata √© a declara√ß√£o do sinal &lt;code&gt;mem_t&lt;/code&gt; na primeira linha. Apesar de n√£o gerar um hardware por si s√≥, estamos declarando um tipo do usu√°rio que √© uma matriz (&lt;code&gt;array&lt;/code&gt;) de 32 posi√ß√µes (de 0 a 31). Cada posi√ß√£o armazena um &lt;code&gt;bit_vector&lt;/code&gt; de 4 bits. Podemos dizer que acabamos de declarar uma mem√≥ria com &lt;span class="math"&gt;\(n=32\)&lt;/span&gt; (ou &lt;span class="math"&gt;\(a_s=5\)&lt;/span&gt;) e &lt;span class="math"&gt;\(d_s=4\)&lt;/span&gt;. Esta mem√≥ria possui ent√£o 32 palavras de 4 bits, ou 128 bits no total.&lt;/p&gt;
&lt;p&gt;A segunda declara√ß√£o efetivamente descreve a mem√≥ria, fazendo com que o sinal &lt;code&gt;mem&lt;/code&gt; seja interpretado como a matriz declarada anteriormente.&lt;/p&gt;
&lt;p&gt;Mas √© s√≥ isso? Sim, √© s√≥ isso. Ao declarar uma matriz da maneira descrita, o sintetizador ir√° entender automaticamente que o que voc√™ quer descrever √© uma mem√≥ria. O tipo de mem√≥ria ser√° determinado pelo restante da sua descri√ß√£o, que dever√° conter as opera√ß√µes poss√≠veis sobre a matriz rec√©m declarada.&lt;/p&gt;
&lt;h2&gt;Operando sobre a matriz de mem√≥ria&lt;/h2&gt;
&lt;p&gt;H√° duas opera√ß√µes poss√≠veis, a escrita e a leitura. Para ler do vetor, basta index√°-lo com a posi√ß√£o do vetor que deseja-se ler. O resultado da indexa√ß√£o ser√° um dado do mesmo tipo que o declarado anteriormente como o tipo de dado da mem√≥ria.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;data_o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;to_integer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="p"&gt;)));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Para escrever no vetor, basta inverter a escrita, ou seja, atribuir um valor do mesmo tipo que o declarado na mem√≥ria √† uma posi√ß√£o do vetor, indexada da mesma maneira.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;to_integer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;data_i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Note que o &lt;code&gt;addr&lt;/code&gt; deve ser um inteiro pois este √© o √∫nico tipo de dados permitido para indexa√ß√£o (neste caso usamos uma rotina de convers√£o para converter o &lt;code&gt;addr&lt;/code&gt; para um inteiro sem sinal). Tamb√©m observe que ambas as constru√ß√µes devem estar dentro do corpo da arquitetura e s√£o suscept√≠veis a qualquer estrutura em que estejam inseridas.&lt;/p&gt;
&lt;p&gt;Um conceito importante que costuma gerar d√∫vidas √© a inser√ß√£o destas opera√ß√µes dentro de um &lt;code&gt;process&lt;/code&gt;, o que a tornaria sequencial. No caso da leitura, isto √© opcional e o comando pode estar dentro ou fora do &lt;code&gt;process&lt;/code&gt;. Quando fora, a mem√≥ria gerada far√° uma leitura de forma combinat√≥ria e cabe ao utilizador da mem√≥ria esperar o tempo adequado para a estabiliza√ß√£o dos dados (decodifica√ß√£o do endere√ßo), evitando os poss√≠veis &lt;em&gt;glitches&lt;/em&gt;. Ao contr√°rio, a escrita deve estar dentro de um &lt;code&gt;process&lt;/code&gt; pois uma escrita combinat√≥ria pode gerar efeitos indesejados (e.g. escrita de parte da palavra em um endere√ßo e parte em outra). Isto n√£o √© uma limita√ß√£o da linguagem e sim uma descri√ß√£o errada. Lembro tamb√©m que isto n√£o tem rela√ß√£o com a sincronicidade da mem√≥ria a um &lt;em&gt;clock&lt;/em&gt;, pois o sinal de disparo do &lt;code&gt;process&lt;/code&gt; n√£o precisa ser um &lt;em&gt;clock&lt;/em&gt;. √â poss√≠vel descrever mem√≥rias com escritas combinat√≥rias em VHDL, mas nesse caso a decodifica√ß√£o de endere√ßo deve ser realizada antes da escrita, que deve ser controlada de fora da mem√≥ria. No entanto, se voc√™ est√° come√ßando, atenha-se a:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;escrita sequencial (dentro de um &lt;code&gt;process&lt;/code&gt;), e&lt;/li&gt;
&lt;li&gt;leitura combinat√≥ria para ROMs, e&lt;/li&gt;
&lt;li&gt;leitura sequencial ou combinat√≥ria para RAMs.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Carregamento Inicial&lt;/h2&gt;
&lt;p&gt;Em v√°rias situa√ß√µes, √© √∫til a mem√≥ria j√° conter algum valor no momento em que √© sintetizada, principalmente quando se trata de uma ROM. Isto pode ser feito de duas maneiras: atrav√©s de um literal constante na pr√≥pria descri√ß√£o ou atrav√©s de um arquivo externo.&lt;/p&gt;
&lt;h3&gt;Literal&lt;/h3&gt;
&lt;p&gt;Para carregar os valores com um literal na pr√≥pria descri√ß√£o, basta atribuir o valor na declara√ß√£o do sinal que representa a matriz. Isto pode ser feito da seguinte maneira:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mem_type&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
  &lt;span class="s"&gt;&amp;quot;0000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0001&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0010&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0011&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0100&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0101&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0110&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0111&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="s"&gt;&amp;quot;1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1001&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1010&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1011&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1100&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1101&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1110&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1111&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="s"&gt;&amp;quot;0000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0001&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0010&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0011&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0100&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0101&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0110&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0111&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="s"&gt;&amp;quot;1000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1001&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1010&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1011&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1100&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1101&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1110&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1111&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Ao declarar a matriz de mem√≥ria podemos atribuir um valor inicial usando o operador &lt;code&gt;:=&lt;/code&gt;. No exemplo acima, h√° exatamente 32 palavras de 4 bits, o que preenche completamente a mem√≥ria. A representa√ß√£o usada para cada palavra √© a mesma usada para o tipo de dados declarado no tipo da mem√≥ria (nesse caso &lt;code&gt;bit_vector&lt;/code&gt;).&lt;/p&gt;
&lt;h3&gt;Arquivo&lt;/h3&gt;
&lt;p&gt;A ideia de se carregar a memoria usando um literal parece interessante por√©m se torna dif√≠cil quando a mem√≥ria √© grande, pois o literal est√° junto com a descri√ß√£o da mem√≥ria no arquivo VHDL. Imagine uma mem√≥ria com o tamanho de uma mem√≥ria atual, e calcule a quantidade de palavras que voc√™ ter√° que especificar...&lt;/p&gt;
&lt;p&gt;Para amenizar o problema, h√° uma biblioteca chamada de &lt;code&gt;textio&lt;/code&gt;, que cont√©m primitivas de leitura de arquivos. Podemos facilmente utiliz√°-la para ler o conte√∫do inicial da mem√≥ria de um arquivo externo ao VHDL e escrev√™-lo na matriz de mem√≥ria. Para fazer uso desta biblioteca, temos que declarar o uso do pacote &lt;code&gt;std.textio&lt;/code&gt; (lembre-se do &lt;code&gt;.all&lt;/code&gt; ou das funcionalidades que ir√° utilizar), o que nos disponibilizar√° as rotinas de manipula√ß√£o de arquivos. Para atribuir um valor inicial √† matriz de mem√≥ria, escrevemos uma fun√ß√£o auxiliar que l√™ os dados do arquivo e preenche uma matriz tempor√°ria id√™ntica a matriz de mem√≥ria, assim podemos atribuir a matriz tempor√°ria √† matriz de mem√≥ria durante a sua declara√ß√£o. Vejamos um exemplo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;impure&lt;/span&gt; &lt;span class="k"&gt;function&lt;/span&gt; &lt;span class="n"&gt;inicializa&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nome_do_arquivo&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;string&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mem_t&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;file&lt;/span&gt;     &lt;span class="n"&gt;arquivo&lt;/span&gt;  &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="k"&gt;open&lt;/span&gt; &lt;span class="n"&gt;read_mode&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;nome_do_arquivo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;variable&lt;/span&gt; &lt;span class="n"&gt;linha&lt;/span&gt;    &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;variable&lt;/span&gt; &lt;span class="n"&gt;temp_bv&lt;/span&gt;  &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;variable&lt;/span&gt; &lt;span class="n"&gt;temp_mem&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mem_t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;mem_t&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;range&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
      &lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arquivo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linha&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;linha&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;temp_bv&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="n"&gt;temp_mem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;temp_bv&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;temp_mem&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mem_t&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;inicializa&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;rom32x4.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A fun√ß√£o, resumidamente, est√° lendo um arquivo (cujo nome √© seu √∫nico par√¢metro) linha por linha, considerando que h√° uma palavra de mem√≥ria por linha, na forma de um &lt;code&gt;bit_vector&lt;/code&gt; de 4 bits. Note que a fun√ß√£o s√≥ ler√° a quantidade de dados necess√°ria para preencher a mem√≥ria pois o la√ßo √© limitado pelo tamanho do tipo da mem√≥ria. No nosso exemplo, ela ler√° as primeiras 32 palavras (uma por linha, ent√£o 32 linhas) do arquivo, esperando que cada linha contenha exatamente 4 bits. Na √∫ltima linha do exemplo declaramos a matriz de mem√≥ria atribuindo como valor inicial o valor retornado pela fun√ß√£o, que √© invocada com o nome do arquivo como par√¢metro. Um exemplo de arquivo √©:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;0000&lt;/span&gt;
&lt;span class="err"&gt;0001&lt;/span&gt;
&lt;span class="err"&gt;0010&lt;/span&gt;
&lt;span class="err"&gt;...&lt;/span&gt;
&lt;span class="err"&gt;1111&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Observe que o arquivo ter√° 32 linhas, que omito por quest√µes de espa√ßo.&lt;/p&gt;
&lt;h3&gt;Considera√ß√µes sobre valores iniciais&lt;/h3&gt;
&lt;p&gt;Normalmente, atribui√ß√µes na declara√ß√£o do sinal ou vari√°vel n√£o s√£o levadas em considera√ß√£o pelo sintetizador e tem efeitos somente para simula√ß√£o. Contudo, em algumas situa√ß√µes a maioria dos sintetizadores leva em considera√ß√£o o valor declarado na descri√ß√£o. Uma delas √© quando declaramos uma constante e n√£o um sinal. Isto faz sentido pois o valor inicial de uma mem√≥ria faz sentido se esta for uma ROM, portanto n√£o ser√° escrita. Dessa forma, a declara√ß√£o da matriz de mem√≥ria ser√°:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;constant&lt;/span&gt; &lt;span class="n"&gt;mem&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mem_type&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Ambas as t√©cnicas de atribui√ß√£o de valores iniciais s√£o v√°lidas e podem ser usadas na declara√ß√£o da matriz de mem√≥ria (constante agora).&lt;/p&gt;
&lt;h2&gt;Exemplos&lt;/h2&gt;
&lt;p&gt;Os exemplos a seguir podem ser baixados e usados livremente, desde que respeitada a autoria &lt;a href="https://creativecommons.org/licenses/by/4.0/"&gt;CC-BY 4.0&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/balbertini/hwProjects/blob/master/vhdl_modules/memory/ram.vhd"&gt;RAM&lt;/a&gt; s√≠ncrona gen√©rica parametriz√°vel, com &lt;code&gt;WE&lt;/code&gt; (no exemplo o sinal chama-se &lt;code&gt;wr&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/balbertini/hwProjects/blob/master/vhdl_modules/memory/rom.vhd"&gt;ROM&lt;/a&gt; gen√©rica parametriz√°vel, com carga externa.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/balbertini/hwProjects/blob/master/vhdl_modules/memory/rom32x4.vhd"&gt;ROM&lt;/a&gt; de 32 palavras de 4 bits (como no exemplo deste artigo), com carga por literal e externa.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/balbertini/hwProjects/blob/master/vhdl_modules/memory/rom32x4.dat"&gt;Arquivo de dados&lt;/a&gt; para carga externa nos exemplos.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/balbertini/hwProjects/blob/master/vhdl_modules/memory/memorias_tb.vhd"&gt;&lt;em&gt;Testbench&lt;/em&gt;&lt;/a&gt; para todas as mem√≥rias acima (para rodar s√£o necess√°rios todos os arquivos).&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/balbertini/hwProjects/blob/master/vhdl_modules/memory/utils.vhd"&gt;Rotinas&lt;/a&gt; auxiliares para impress√£o dos vetores no &lt;em&gt;testbench&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;### Contribui√ß√µes
    * 27/nov/2020: Tomaz Maia Suller corrigiu um erro sobre o nome da &lt;code&gt;std.textio&lt;/code&gt;.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="memory"></category></entry><entry><title>M√°quinas de estado em VHDL</title><link href="https://balbertini.github.io/vhdl_fsm-pt_BR.html" rel="alternate"></link><published>2019-03-19T10:58:59-03:00</published><updated>2019-09-09T10:24:21-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2019-03-19:/vhdl_fsm-pt_BR.html</id><summary type="html">&lt;p&gt;M√°quinas de estado em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;M√°quinas de estado s√£o muito comuns pois, em sistemas digitais, todos os circuitos sequenciais podem ser vistos como uma m√°quina de estados finita. No entanto, especific√°-las em VHDL √© um desafio para os projetistas novatos devido aos problemas que surgem quando o tempo est√° envolvido. Circuitos combinat√≥rios n√£o dependem de tempo e n√£o possuem mem√≥ria, por√©m m√°quinas de estado possuem e precisam ser projetadas com o devido cuidado. Neste artigo mostrarei algumas formas seguras de especificar corretamente m√°quinas de estado finitas s√≠ncronas e determin√≠sticas em VHDL.&lt;/p&gt;
&lt;h3&gt;Revisitando o conceito de m√°quinas de estado&lt;/h3&gt;
&lt;p&gt;&lt;img alt="Modelo de FSM" src="https://balbertini.github.io/images/sd/fsmmodel.png"&gt;&lt;/p&gt;
&lt;p&gt;O modelo base de qualquer m√°quina de estados em sistemas digitais pode ser visto na figura. √â composto por um elemento de mem√≥ria (S) e duas fun√ß√µes combinat√≥rias, uma de transi√ß√£o de estados (T) e outra de sa√≠da (G). Quando a fun√ß√£o de sa√≠da depende somente do estado (aus√™ncia da seta tracejada na figura), dizemos que a m√°quina segue o modelo de Moore. Ao contr√°rio, quando a sa√≠da da m√°quina depende do estado e da entrada (presen√ßa da seta tracejada na figura), dizemos que a m√°quina segue o modelo de Mealy. Em ambos os casos, somente o elemento de mem√≥ria √© sequencial. As fun√ß√µes s√£o puramente combinat√≥rias e dependem somente da entrada (da fun√ß√£o) para produzir a sa√≠da. Note que, apesar de dependerem apenas na sua entrada, ambas as fun√ß√µes recebem a sa√≠da do elemento combinat√≥rio como entrada.&lt;/p&gt;
&lt;p&gt;Resumindo:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;T √© combinat√≥ria, recebe o estado e a entrada e produz o pr√≥ximo estado;&lt;/li&gt;
&lt;li&gt;G √© combinat√≥ria, recebe o estado (Moore) ou o estado e a entrada (Mealy), e produz a sa√≠da;&lt;/li&gt;
&lt;li&gt;S √© um elemento de mem√≥ria que armazena o estado atual.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Descrevendo a FSM em VHDL usando Moore ou Mealy&lt;/h2&gt;
&lt;p&gt;Aqui parte-se do pressuposto que voc√™ desenhou o diagrama de transi√ß√£o de estados da sua m√°quina de estados, ela √© finita e determin√≠stica. De fato, a grande maioria dos problemas sequenciais em sistemas digitais possuem a sua dificuldade no desenho do diagrama de transi√ß√£o e n√£o na implementa√ß√£o. Em outras palavras, implementar uma m√°quina de estados em VHDL √© relativamente simples, pois a parte dif√≠cil da solu√ß√£o do problema est√° imbu√≠da no diagrama de transi√ß√£o.&lt;/p&gt;
&lt;p&gt;Comece sua m√°quina de estados declarando a entidade e, consequentemente, a interface de entrada e sa√≠da da sua m√°quina de estados.&lt;/p&gt;
&lt;p&gt;Na arquitetura, sempre teremos duas partes: a parte sequencial e a parte combinat√≥ria. O elemento de mem√≥ria representa a parte sequencial da m√°quina de estado e portanto √© sens√≠vel ao &lt;em&gt;clock&lt;/em&gt;. Para implement√°-lo dessa maneira, utiliza-se o &lt;code&gt;process&lt;/code&gt;. Para detalhes sobre o uso correto do &lt;code&gt;process&lt;/code&gt;, veja &lt;a href="https://balbertini.github.io/vhdl_sequential-pt_BR.html"&gt;o artigo sobre circuitos s√≠ncronos&lt;/a&gt;. De fato, voc√™ n√£o precisa usar &lt;code&gt;process&lt;/code&gt; para mais nada em VHDL, exceto para a parte sequencial das m√°quinas de estado finitas. A parte combinat√≥ria √© o que diferencia os estilos de codifica√ß√£o em VHDL, e neste artigo veremos duas formas, atrav√©s de exemplos, portanto n√£o deixe de l√™-los e entend√™-los.&lt;/p&gt;
&lt;h3&gt;Exemplo 1 (Moore)&lt;/h3&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/sd/fsmexemplo1.png' width="15%" align="right" style="padding-left:5%" /&gt;
A m√°quina que iremos implementar como exemplo √© a m√°quina de Moore da figura ao lado. Cont√©m apenas dois estados e todas as quatro transi√ß√µes poss√≠veis totalmente especificadas. Comecemos pela declara√ß√£o de uso das bibliotecas e pela entidade:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;library&lt;/span&gt; &lt;span class="nn"&gt;ieee&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;ieee.numeric_bit.rising_edge&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;fsm&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;fsm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;div style="border: 0px; overflow: auto;width: 100%;"&gt;&lt;/div&gt;

&lt;p&gt;Na descri√ß√£o da arquitetura, o que teremos de novidade √© a utiliza√ß√£o de um tipo composto definido pelo usu√°rio. O tipo composto √© uma enumera√ß√£o e representa o conjunto S (todos os estados poss√≠veis). Ap√≥s declarado o tipo composto, √© poss√≠vel declarar sinais e vari√°veis deste tipo, ent√£o usaremos o tipo declarado para declarar a vari√°vel de estado, ou seja, o elemento de mem√≥ria que armazenar√° o estado.&lt;/p&gt;
&lt;h4&gt;Exemplo 1 (Moore) - Estilo tradicional&lt;/h4&gt;
&lt;p&gt;Neste primeiro estilo de descri√ß√£o, a arquitetura √© descrita usando exatamente o modelo tradicional de m√°quina de estados, ou seja, o elemento de mem√≥ria √© sequencial (dentro do &lt;code&gt;process&lt;/code&gt;) e as fun√ß√µes combinat√≥rias (fora do &lt;code&gt;process&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/sd/fsmvhdl01.png' width="50%" align="right" style="padding-left:0%" /&gt;&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;proccomb&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;fsm&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="n"&gt;estado_t&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;PE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;estado_t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="nc"&gt;sincrono&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;elsif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;PE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="nc"&gt;sincrono&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;
    &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;
    &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;proccomb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Note que h√° somente um processo. O processo faz o &lt;em&gt;reset&lt;/em&gt; ass√≠ncrono da m√°quina de estados, colocando-a no estado A (veja a seta de in√≠cio chegando no estado A do diagrama de transi√ß√£o de estados). Caso o &lt;em&gt;reset&lt;/em&gt; n√£o esteja ativo, o processo faz uma √∫nica tarefa que √© copiar o sinal PE (de Pr√≥ximo Estado) para o sinal EA (de Estado Atual) na borda de subida do &lt;em&gt;clock&lt;/em&gt;. Neste contexto, apenas o sinal EA representa um elemento combinat√≥rio pois fora destas duas condi√ß√µes, o sinal EA √© mantido inalterado. O comportamento √© exatamente o de um &lt;em&gt;flip-flop&lt;/em&gt; tipo D e, de fato, podemos ver que o circuito gerado cont√©m exatamente um &lt;em&gt;flip-flop&lt;/em&gt;, pois temos somente dois estados poss√≠veis. Caso o tipo composto &lt;code&gt;estado_t&lt;/code&gt; possu√≠sse mais de dois estados, o n√∫mero de &lt;em&gt;flip-flops&lt;/em&gt; seria maior para acomodar o maior n√∫mero de estados.&lt;/p&gt;
&lt;p&gt;Fora do processo, temos duas declara√ß√µes concorrentes ao &lt;code&gt;process&lt;/code&gt;, que representam as duas fun√ß√µes combinat√≥rias. A primeira calcula o pr√≥ximo estado (&lt;code&gt;PE&amp;lt;=...&lt;/code&gt;) e a segunda calcula a sa√≠da (&lt;code&gt;saida&amp;lt;=...&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Este estilo tem a vantagem de ser muito pr√≥ximo do modelo tradicional de m√°quinas de estado. O processo s√≠ncrono √© muito simples (ser√° similar independentemente da m√°quina) e com pouco espa√ßo para erros. A desvantagem √© que este estilo se torna cr√≠ptico rapidamente, pois a descri√ß√£o combinat√≥ria das fun√ß√µes de transi√ß√£o e de pr√≥ximo estado crescer√£o exponencialmente em complexidade e tamanho junto com a complexidade da m√°quina, tornando-se ileg√≠veis rapidamente.&lt;/p&gt;
&lt;p&gt;Use esse estilo nas suas primeiras m√°quinas de estado, para garantir que voc√™ n√£o ter√° problemas de sincronismo, ou se a m√°quina for muito simples ou com poucos estados.&lt;/p&gt;
&lt;h4&gt;Exemplo 1 (Moore) - Estilo com dois &lt;code&gt;process&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;No segundo estilo, levamos a descri√ß√£o combinat√≥ria para dentro de um &lt;code&gt;process&lt;/code&gt; novo, mantendo o &lt;code&gt;process&lt;/code&gt; sequencial que faz o papel de elemento de mem√≥ria inalterado. Este estilo exige um cuidado muito grande pois estamos descrevendo um elemento combinat√≥rio dentro de uma primitiva de VHDL que indica para o sintetizador que estamos descrevendo algo sequencial. Temos que ser claros com a descri√ß√£o para que o sintetizador entenda que a vari√°vel de estados √© o sinal EA somente, e os outros sinais (neste caso o PE e a &lt;code&gt;saida&lt;/code&gt;), s√£o combinat√≥rios.&lt;/p&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/sd/fsmvhdl02.png' width="50%" align="right" style="padding-left:0%" /&gt;&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;doisproc&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;fsm&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="n"&gt;estado_t&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;PE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;estado_t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;

  &lt;span class="nc"&gt;sincrono&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;elsif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;PE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="nc"&gt;sincrono&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="nc"&gt;combinatorio&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
      &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
          &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;
          &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
          &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;
          &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="k"&gt;others&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="nc"&gt;combinatorio&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;doisproc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A vantagem desta abordagem √© que temos acesso a estruturas sequenciais, como o &lt;code&gt;case&lt;/code&gt; usado como decisor no processo combinat√≥rio, que facilitam a descri√ß√£o comportamental de m√°quinas de estado. A desvantagem √© que um pequeno deslize pode levar o sintetizador a registrar ou inferir &lt;em&gt;latches&lt;/em&gt; para os sinais combinat√≥rios, comprometendo a sequencialidade da m√°quina.&lt;/p&gt;
&lt;p&gt;Note que o sinal PE foi inclu√≠do na lista de sensibilidade do processo sequencial, o que foi omitido no estilo anterior. A presen√ßa na lista de sensibilidade indica que PE pode mudar devido a fatores externos ao processo sequencial, e que o processo deve ser reavaliado se isto acontecer (mesmo que o resultado seja o mesmo pois n√£o h√° borda nem &lt;em&gt;reset&lt;/em&gt;). J√° o processo combinat√≥rio depende de EA (obrigat√≥rio), fechando a cadeia de depend√™ncia entre os sinais dos processos (um ativa o outro). Esta liga√ß√£o amplia as possibilidades de otimiza√ß√£o do sintetizador pois ele entende que os dois processos s√£o partes de um circuito √∫nico e os algoritmos de s√≠ntese foram preparados para otimizar esta situa√ß√£o (√© um pouco mais complexo que isso, mas basta saber que √© melhor assim). Note que o circuito gerado cont√©m um multiplexador no lugar das portas l√≥gicas.&lt;/p&gt;
&lt;p&gt;Este exemplo √© simples e h√° pouca diferen√ßa entre em manter o circuito combinat√≥rio isolado do sequencial (primeiro estilo), ou descrev√™-los em conjunto usando dois processos interligados (segundo estilo). Em circuitos complexos as otimiza√ß√µes podem ser bem diferentes, quase sempre com vantagem para o estilo de descri√ß√£o com dois processos.&lt;/p&gt;
&lt;p&gt;Outro ponto importante √© a aus√™ncia de sinais temporais no processo combinat√≥rio &lt;strong&gt;e a completude de todas as atribui√ß√µes&lt;/strong&gt;. Se esquecermos de uma atribui√ß√£o para PE em qualquer um dos casos poss√≠veis (incluindo a cl√°usula &lt;code&gt;when others&lt;/code&gt;), a atribui√ß√£o estar√° incompleta e o processo pode se tornar sequencial (e nesse caso ass√≠ncrono ainda por cima), fazendo com que a descri√ß√£o n√£o se comporte como o esperado.&lt;/p&gt;
&lt;p&gt;Aconselha-se a utiliza√ß√£o deste tipo de descri√ß√£o quando voc√™ estiver habituado a descrever m√°quinas de estados em VHDL e confort√°vel em encontrar problemas de sincronismo.&lt;/p&gt;
&lt;p&gt;Se voc√™ tem uma bagagem como programador de software, √© natural optar por este estilo pois √© muito parecido com os processos em software, mas evite-o at√© estar confort√°vel pois voc√™ n√£o est√° programando e sim descrevendo um hardware. A maioria dos problemas dos alunos iniciantes em pr√°ticas de sistemas digitais adv√©m da descri√ß√£o incorreta deste estilo de m√°quinas de estado, principalmente ligadas a infer√™ncia de &lt;em&gt;latches&lt;/em&gt; devido a atribui√ß√£o incompleta.&lt;/p&gt;
&lt;h3&gt;Outros estilos&lt;/h3&gt;
&lt;p&gt;Mas ent√£o por que n√£o usamos um processo s√≥ para tudo? Vamos ver:
&lt;img src='https://balbertini.github.io/images/sd/fsmvhdl03.png' width="50%" align="right" style="padding-left:0%" /&gt;&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;umproc&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;fsm&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="n"&gt;estado_t&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;estado_t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="nc"&gt;sincrono&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;elsif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
        &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;
          &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;else&lt;/span&gt;
            &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;
          &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;else&lt;/span&gt;
            &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="k"&gt;others&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;
          &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="nc"&gt;sincrono&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;umproc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;De fato isso √© poss√≠vel, mas o processo ser√° considerado sequencial pelo sintetizador pois cont√©m uma sensibilidade √† uma borda (no &lt;code&gt;rising_edge&lt;/code&gt;). Como processo sequencial, seus sinais ser√£o registrados, o que √© desej√°vel para o sinal EA pois ele representa a pr√≥pria vari√°vel de estado da m√°quina. Por√©m, pode n√£o ser desej√°vel tampouco aceit√°vel para os demais sinais. Neste caso, a sa√≠da foi o √∫nico sinal que sobrou pois o PE p√¥de ser eliminado, dado que n√£o precisamos mais calcular a fun√ß√£o de pr√≥ximo estado separadamente.&lt;/p&gt;
&lt;p&gt;Observe que o circuito gerado possui a sa√≠da registrada (inferida pelo sintetizador). Isto n√£o √© um problema se voc√™ puder conviver com a sa√≠da sempre defasada de um ciclo de &lt;em&gt;clock&lt;/em&gt;, mas est√° errado conceitualmente pois a m√°quina de estados se comportar√° em fase com o &lt;em&gt;clock&lt;/em&gt; para as transi√ß√µes e defasada de um ciclo para os demais sinais. Esta caracter√≠stica costuma confundir muito os iniciantes e dificulta consideravelmente a depura√ß√£o. Por estes motivos, se voc√™ √© meu aluno, &lt;strong&gt;n√£o use este estilo&lt;/strong&gt; em nenhum momento durante a gradua√ß√£o (p√≥s por favor consulte antes).&lt;/p&gt;
&lt;h3&gt;Exemplo 2 (Mealy)&lt;/h3&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/sd/fsmexemplo2.png' width="15%" align="right" style="padding-left:5%" /&gt;
Esta √© a mesma m√°quina que a do Exemplo 1, por√©m no modelo de Mealy, onde a sa√≠da depende tamb√©m da entrada.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;library&lt;/span&gt; &lt;span class="nn"&gt;ieee&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;ieee.numeric_bit.rising_edge&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;fsm&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;fsm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;div style="border: 0px; overflow: auto;width: 100%;"&gt;&lt;/div&gt;

&lt;h4&gt;Exemplo 2 (Mealy) - Estilo tradicional&lt;/h4&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/sd/fsmvhdl04.png' width="50%" align="right" style="padding-left:0%" /&gt;&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;proccombmealy&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;fsm&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="n"&gt;estado_t&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;PE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;estado_t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;

  &lt;span class="nc"&gt;sincrono&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;elsif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;PE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="nc"&gt;sincrono&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;
    &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;
    &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;proccombmealy&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Note que o circuito gerado √© um pouco maior devido a arquitetura para o qual foi sintetizado (FPGA).&lt;div style="border: 0px; overflow: auto;width: 100%;"&gt;&lt;/div&gt;&lt;/p&gt;
&lt;h4&gt;Exemplo 2 (Mealy) - Estilo com dois &lt;code&gt;process&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/sd/fsmvhdl05.png' width="50%" align="right" style="padding-left:0%" /&gt;&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;doisprocmealy&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;fsm&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="n"&gt;estado_t&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;PE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;estado_t&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;

  &lt;span class="nc"&gt;sincrono&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;elsif&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;EA&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;PE&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="nc"&gt;sincrono&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="nc"&gt;combinatorio&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EA&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
      &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
          &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;
          &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
          &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;
          &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="k"&gt;others&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;PE&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="nc"&gt;combinatorio&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;doisprocmealy&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Observe que n√£o h√° diferen√ßa entre o circuito gerado para esta m√°quina e para a m√°quina Moore com dois processos.
&lt;div style="border: 0px; overflow: auto;width: 100%;"&gt;&lt;/div&gt;&lt;/p&gt;
&lt;!-- ### Dicas gerais

Use nomes significativos. Para estados, tente --&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="state machine"></category></entry><entry><title>Componentes em VHDL</title><link href="https://balbertini.github.io/vhdl_component-pt_BR.html" rel="alternate"></link><published>2019-03-14T15:40:49-03:00</published><updated>2020-09-18T19:49:39-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2019-03-14:/vhdl_component-pt_BR.html</id><summary type="html">&lt;p&gt;Usando componentes em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;A linguagem VHDL √© inerentemente hier√°rquica, sendo muito f√°cil usar um componente de um projeto em outro. Esta caracter√≠stica permite algumas vantagens como: reutiliza√ß√£o de descri√ß√µes, divis√£o do projeto e partes menores (permite que projetistas trabalhem em paralelo e aumenta a legibilidade) e o teste separado (de um m√≥dulo e da integra√ß√£o).&lt;/p&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/74181simbolo.png' width="30%" align="right" style="padding-left:5%" /&gt;
Usar componentes √© muito simples em VHDL pois toda a entidade (&lt;code&gt;entity&lt;/code&gt;) define um componente. No entanto, precisamos declarar e instanciar o componente, o que veremos neste post.&lt;/p&gt;
&lt;p&gt;Considere a figura ao lado, que representa uma ULA (Unidade L√≥gica e Aritm√©tica) modelo 74181 (fonte: &lt;em&gt;datasheet&lt;/em&gt; da Texas). Os n√∫meros nos pinos representam o n√∫mero do pino f√≠sico (e.g. a entrada &lt;code&gt;M&lt;/code&gt; est√° no pino 8). Como convencionado, entradas de dados est√£o acima, sa√≠das abaixo, entradas de controle a esquerda e sa√≠da de controle a direita. As entradas de dados s√£o &lt;code&gt;A&lt;/code&gt; e &lt;code&gt;B&lt;/code&gt; de 4 bits e a sa√≠da de dados &lt;code&gt;F&lt;/code&gt; tamb√©m √© de 4 bits. O &lt;em&gt;carry_in&lt;/em&gt; (&lt;span class="math"&gt;\(\overline{C_n}\)&lt;/span&gt;) e o &lt;em&gt;carry_out&lt;/em&gt; (&lt;span class="math"&gt;\(\overline{C_{n+4}}\)&lt;/span&gt;) s√£o ambos ambos ativos baixo. A entrada &lt;code&gt;M&lt;/code&gt; define se a opera√ß√£o √© l√≥gica ou aritm√©tica e a entrada &lt;code&gt;S&lt;/code&gt; (4 bits) define qual opera√ß√£o a ULA realizar√°. H√° ainda a sa√≠da &lt;span class="math"&gt;\(A=B\)&lt;/span&gt; e as sa√≠das para cascateamento &lt;em&gt;generate&lt;/em&gt; (&lt;span class="math"&gt;\(\overline{G}\)&lt;/span&gt;) e &lt;em&gt;propagate&lt;/em&gt; (&lt;span class="math"&gt;\(\overline{P}\)&lt;/span&gt;), ambas ativas baixo.&lt;/p&gt;
&lt;p&gt;A entidade para este componente √© algo assim:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;alu181&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;cn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;cn4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aeqb&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;gn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pn&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Para usar essa ULA como componente, h√° duas fases distintas: a declara√ß√£o e a inst√¢ncia.&lt;/p&gt;
&lt;h2&gt;Declarando um componente&lt;/h2&gt;
&lt;p&gt;A declara√ß√£o tem o seguinte formato:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="nc"&gt;nome_da_entidade&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
  &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;elementos_genericos&lt;/span&gt; &lt;span class="p"&gt;)]&lt;/span&gt;
  &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;portas&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="nc"&gt;nome_da_entidade&lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A cl√°usula &lt;code&gt;is&lt;/code&gt; √© opcional, assim como o &lt;code&gt;nome_da_entidade&lt;/code&gt; no final da declara√ß√£o. O &lt;code&gt;generic&lt;/code&gt; serve para declarar componentes parametriz√°veis, que &lt;a href="https://balbertini.github.io/vhdl_generic-pt_BR.html"&gt;est√° coberto em outro post&lt;/a&gt;. J√° o &lt;code&gt;port&lt;/code&gt;, apesar de opcional, √© o que declara as portas do componente dispon√≠veis para a entidade que o utilizar√° como m√≥dulo. De modo geral, √© esperado que as cl√°usulas &lt;code&gt;generic&lt;/code&gt; e &lt;code&gt;port&lt;/code&gt; &lt;strong&gt;sejam id√™nticas&lt;/strong&gt; √† declara√ß√£o da entidade, ent√£o a ULA 181 do nosso exemplo deve ser declarada como componente assim:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="nc"&gt;alu181&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;cn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;cn4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aeqb&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;gn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pn&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;component&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h2&gt;Instanciando um componente&lt;/h2&gt;
&lt;p&gt;Depois de declarado, ainda precisamos instanciar o componente.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;nome_da_instancia&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;component&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="n"&gt;nome_do_componente&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;nome_da_entidade&lt;/span&gt; &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;nome_da_arquitetura&lt;/span&gt;&lt;span class="p"&gt;)]]&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="k"&gt;configuration&lt;/span&gt; &lt;span class="n"&gt;nome_da_configura√ß√£o&lt;/span&gt;
    &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_associacao_de_elementos_genericos&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_associacao_de_portas&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Note que h√° tr√™s modos distintos de instanciar um componente, que s√£o mutuamente exclusivos. O primeiro usamos o nome do componente (opcionalmente antecedido por &lt;code&gt;component&lt;/code&gt;), no segundo usamos o nome da entidade e no terceiro usamos o nome da configura√ß√£o (a configura√ß√£o √© um elemento prim√°rio do VHDL).&lt;/p&gt;
&lt;p&gt;Quando usamos a instancia√ß√£o pelo &lt;code&gt;component&lt;/code&gt;, instanciaremos exatamente o componente que declaramos. A escolha de qual arquitetura depende do sintetizador (normalmente √© a √∫ltima arquitetura descrita no arquivo).&lt;/p&gt;
&lt;p&gt;Na instancia√ß√£o pela entidade, podemos escolher qual arquitetura usamos. A sintaxe comum √© &lt;code&gt;work.nome_da_entidade(nome_da_arquitetura)&lt;/code&gt;, mas pode-se omitir o &lt;code&gt;nome_da_arquitetura&lt;/code&gt; (deixando a cargo do sintetizador escolher). A palavra reservada &lt;code&gt;work&lt;/code&gt; refere-se √† biblioteca padr√£o, o local onde ficam todos os componentes do seu projeto que n√£o pertencem a uma biblioteca (n√£o est√£o em um &lt;code&gt;package&lt;/code&gt;). Neste caso de instancia√ß√£o podemos omitir a declara√ß√£o do componente se o nome da entidade for √∫nico. Caso seja necess√°rio, voc√™ pode incluir a biblioteca &lt;code&gt;work&lt;/code&gt; no pre√¢mbulo o arquivo VHDL usando &lt;code&gt;use work.all;&lt;/code&gt; ou selecionando explicitamente o componente que quer usar: &lt;code&gt;use work.nome_da_entidade;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;A terceira maneira √© declarar explicitamente uma configura√ß√£o (&lt;code&gt;configuration&lt;/code&gt;), mas n√£o cobrirei neste post.&lt;/p&gt;
&lt;p&gt;Na pr√°tica, acabamos quase sempre por usar o primeiro m√©todo por ser mais simples e compat√≠vel com todas as vers√µes de VHDL:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;nome_da_instancia&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;nome_do_componente&lt;/span&gt;
    &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_associacao_de_elementos_genericos&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_associacao_de_portas&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Agora observe as cl√°usulas &lt;code&gt;map&lt;/code&gt;. Elas mapeiam os sinais do seu componente para a inst√¢ncia e ambos seguem o mesmo padr√£o usado para declara√ß√£o de portas. O &lt;code&gt;generic map&lt;/code&gt; &lt;a href="https://balbertini.github.io/vhdl_generic-pt_BR.html"&gt;est√° coberto em outro post&lt;/a&gt;, ent√£o vamos focar na inst√¢ncia simples da nossa ULA.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;minha_alu&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;alu181&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Op&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;co4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aeqb0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;open&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;open&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;No trecho acima, declaramos uma inst√¢ncia do componente &lt;code&gt;alu181&lt;/code&gt; chamada &lt;code&gt;minha_alu&lt;/code&gt;. Note que a ordem dos sinais √© a mesma usada na declara√ß√£o do componente. Isto significa que o sinal &lt;code&gt;A&lt;/code&gt;, que deve existir na arquitetura que est√° usando este componente, ser√° ligado ao sinal &lt;code&gt;a&lt;/code&gt; desta inst√¢ncia de ULA. Chamamos este tipo de associa√ß√£o de &lt;strong&gt;associa√ß√£o posicional&lt;/strong&gt; pois a ordem do sinal importa. Repare tamb√©m que n√£o vamos usar o _carry_in__ (&lt;code&gt;cn&lt;/code&gt;), portanto fixamos esta entrada em &lt;code&gt;0&lt;/code&gt;. Tamb√©m n√£o usaremos as sa√≠das &lt;code&gt;gn&lt;/code&gt; e &lt;code&gt;pn&lt;/code&gt;, ent√£o n√£o conectaremos a lugar algum, o que pode ser feito em VHDL usando a palavra reservada &lt;code&gt;open&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Uma outra forma de fazer a associa√ß√£o √© usando &lt;strong&gt;associa√ß√£o nomeada&lt;/strong&gt;. Neste tipo de associa√ß√£o, dizemos explicitamente qual sinal √© ligado em qual porta da inst√¢ncia do componente, ent√£o a ordem em que fazemos o &lt;code&gt;port map&lt;/code&gt; n√£o importa:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;minha_alu&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;alu181&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;Op&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="n"&gt;gn&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;open&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pn&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;open&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cn&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cn4&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;co4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="n"&gt;aeqb&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;aeqb0&lt;/span&gt;
           &lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A sintaxe √© sempre &lt;code&gt;sinal_do_componente =&amp;gt; sinal_da_arquitetura_pai&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;p&gt;Neste exemplo, usamos duas ULAs 181 para formar uma ULA de 8 bits, sem &lt;em&gt;carry_in&lt;/em&gt;, &lt;em&gt;carry_out&lt;/em&gt; e sem sa√≠das de cascateamento, mas mantendo a sa√≠da de igualdade. Usamos os dois tipos de associa√ß√£o para exemplificar. Lembre-se que as portas de uma entidade s√£o sinais v√°lidos dentro da sua arquitetura.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;ula2x&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;Op&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;aeqb&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;arch&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;ula2x&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="nc"&gt;alu181&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="n"&gt;cn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="n"&gt;cn4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aeqb&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;gn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pn&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;component&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;co4&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;aeqb_it&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;

  &lt;span class="n"&gt;alu1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;alu181&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;Op&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;co4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aeqb_it&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="k"&gt;open&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;open&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

  &lt;span class="n"&gt;alu0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;alu181&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
  &lt;span class="n"&gt;minha_alu&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;alu181&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;Op&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;gn&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;open&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pn&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;open&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cn&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cn4&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;co4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;aeqb&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;aeqb_it&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;

  &lt;span class="n"&gt;aeqb&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;aeqb_it&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;aeqb_it&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h2&gt;Qual associa√ß√£o utilizar?&lt;/h2&gt;
&lt;p&gt;A associa√ß√£o nomeada torna o c√≥digo mais robusto pois se algo mudar de lugar na entidade, os sinais continuam a mapear a inst√¢ncia corretamente. Tamb√©m facilita a compreens√£o da liga√ß√£o pois, se usar nomes significativos para seus sinais, o projetista n√£o precisar√° consultar a declara√ß√£o do componente a todo momento para entender a liga√ß√£o na inst√¢ncia.  &lt;/p&gt;
&lt;p&gt;J√° a associa√ß√£o posicional √© mais enxuta e aumenta a legibilidade do c√≥digo. No entanto para entender a liga√ß√£o do seu componente voc√™ precisa consultar a declara√ß√£o.&lt;/p&gt;
&lt;p&gt;Na pr√°tica, sugiro usar declara√ß√£o posicional sempre que poss√≠vel, sempre acompanhada de coment√°rios explicando sua inten√ß√£o. No entanto, se o seu componente tem portas suficientes para que o &lt;code&gt;port map&lt;/code&gt; ultrapasse uma ou duas linhas, considere fortemente usar a associa√ß√£o nomeada para melhorar o entendimento.&lt;/p&gt;
&lt;h2&gt;Uso nas disciplinas de gradua√ß√£o&lt;/h2&gt;
&lt;p&gt;Voc√™ est√° livre para usar qualquer um dos dois formatos que desejar. No entanto, o juiz usado nas disciplinas de gradua√ß√£o usa a associa√ß√£o posicional, o que significa que se voc√™ montar uma entidade diferente do enunciado, sua descri√ß√£o n√£o ser√° avaliada. Siga estritamente o enunciado, especialmente em rela√ß√£o √† entidade.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="basic"></category></entry><entry><title>M√≥dulos gen√©ricos parametriz√°veis em VHDL</title><link href="https://balbertini.github.io/vhdl_generic-pt_BR.html" rel="alternate"></link><published>2019-03-12T14:58:40-03:00</published><updated>2019-09-09T10:16:11-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2019-03-12:/vhdl_generic-pt_BR.html</id><summary type="html">&lt;p&gt;Usando o generic em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Uma das caracter√≠sticas interessantes de HDLs (incluindo VHDL), √© a capacidade de reutiliza√ß√£o de m√≥dulos. Podemos aumentar ainda mais a reutiliza√ß√£o descrevendo m√≥dulos parametriz√°veis. Este artigo trata de como descrever m√≥dulos gen√©ricos parametriz√°veis em VHDL.&lt;/p&gt;
&lt;h2&gt;Declarando um par√¢metro genericamente&lt;/h2&gt;
&lt;p&gt;Em muitos casos, a descri√ß√£o de um m√≥dulo em VHDL pode n√£o ser reaproveit√°vel porque precisamos de um m√≥dulo ligeiramente diferente. Um exemplo: se descrevermos um registrador de 8 bits, poderemos usar este registrador somente em projetos que utilizam registradores de exatamente 8 bits. Contudo, quando o hardware √© regular, ou seja, seu funcionamento √© id√™ntico independentemente da caracter√≠stica vari√°vel, √© poss√≠vel descrev√™-lo de forma a definir a caracter√≠stica vari√°vel no momento da inst√¢ncia e n√£o da descri√ß√£o. Dessa forma, descreve-se o m√≥dulo genericamente e somente no momento de utiliz√°-lo parametrizamos as caracter√≠sticas vari√°veis. No exemplo do registrador, podemos descrev√™-lo genericamente de forma que o seu tamanho seja um par√¢metro.&lt;/p&gt;
&lt;p&gt;A palavra reservada que possibilita isso √© a &lt;code&gt;generic&lt;/code&gt;. Na descri√ß√£o da entidade do m√≥dulo, podemos incluir esta palavra, como a seguir:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;nome_da_entidade&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
   &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_elementos_genericos&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
   &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_portas&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;nome_da_entidade&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A &lt;code&gt;lista_de_elementos_genericos&lt;/code&gt; √© uma lista de todas as caracter√≠sticas parametriz√°veis, no formato: &lt;code&gt;nome: tipo := valor_padrao&lt;/code&gt;, separadas por &lt;code&gt;;&lt;/code&gt;. O &lt;code&gt;nome&lt;/code&gt; pode ser o que voc√™ desejar, desde que seja um nome v√°lido em VHDL. O tipo define qual tipo de dados ser√° utilizado para aquele par√¢metro e pode ser &lt;a href="https://balbertini.github.io/vhdl_datatypes-pt_BR.html"&gt;qualquer tipo suportado&lt;/a&gt;. O &lt;code&gt;valor_padrao&lt;/code&gt; √© opcional e pode ser omitido. Quando omitido, termina-se a declara√ß√£o ap√≥s a declara√ß√£o do tipo (exclui-se tamb√©m o &lt;code&gt;:=&lt;/code&gt;). No caso da omiss√£o do valor padr√£o, a declara√ß√£o do valor no momento da instancia√ß√£o √© obrigat√≥ria. Caso o valor padr√£o esteja presente, ele ser√° usado somente se a inst√¢ncia n√£o especificar nenhum valor, caso contr√°rio o valor da inst√¢ncia sobrep√µe o valor padr√£o. Como boa pr√°tica, sempre defina o valor padr√£o. O &lt;code&gt;valor_padrao&lt;/code&gt; deve ser obrigatoriamente uma constante do mesmo &lt;code&gt;tipo&lt;/code&gt; que o par√¢metro correspondente.&lt;/p&gt;
&lt;p&gt;Depois de especificados, os par√¢metros da &lt;code&gt;lista_de_elementos_genericos&lt;/code&gt; tornam-se constantes dispon√≠veis em todo o restante do projeto, incluindo a declara√ß√£o de portas da entidade e toda a arquitetura. Como est√£o dispon√≠veis e podem ser usados no lugar de qualquer constante, √© poss√≠vel declarar portas, sinais e qualquer outra estrutura de VHDL usando o par√¢metro no lugar de um valor fixo.&lt;/p&gt;
&lt;h3&gt;Inst√¢ncia&lt;/h3&gt;
&lt;p&gt;No momento da inst√¢ncia do componente, podemos definir os par√¢metros que desejarmos. Lembre-se que, caso a descri√ß√£o n√£o estabele√ßa um valor padr√£o para um determinado par√¢metro, a defini√ß√£o na instancia√ß√£o √© obrigat√≥ria. A sintaxe da inst√¢ncia √©:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;nome_instancia&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;nome_componente&lt;/span&gt;
    &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_associacao_de_elementos_genericos&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_associacao_de_portas&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Se o componente n√£o possui nenhum par√¢metro (aus√™ncia de &lt;code&gt;generic&lt;/code&gt;) ou n√£o deseja-se especificar nenhum (todos os valores padr√µes ser√£o utilizados), toda a linha do &lt;code&gt;generic map&lt;/code&gt; pode ser omitida. A &lt;code&gt;lista_de_associacao_de_elementos_genericos&lt;/code&gt; segue o mesmo padr√£o de associa√ß√£o usado para as portas.&lt;/p&gt;
&lt;h3&gt;S√≠ntese&lt;/h3&gt;
&lt;p&gt;O &lt;code&gt;generic&lt;/code&gt; n√£o √© uma estrutura sintetiz√°vel. No momento da s√≠ntese, todos os valores gen√©ricos parametriz√°veis devem ser resolv√≠veis, ou seja, o valor do par√¢metro √© fixo na inst√¢ncia. N√£o √© poss√≠vel mudar este valor dinamicamente durante ou ap√≥s a s√≠ntese, e muito menos mud√°-lo no hardware pronto. √â poss√≠vel herdar par√¢metros, desde que a √°rvore de heran√ßa seja resolv√≠vel para um valor constante no momento da s√≠ntese.&lt;/p&gt;
&lt;p&gt;√â poss√≠vel usar o &lt;code&gt;generic&lt;/code&gt; para parametrizar algo n√£o sintetiz√°vel. Exemplos deste uso incluem vari√°veis condicionais de depura√ß√£o e temporiza√ß√£o.&lt;/p&gt;
&lt;h2&gt;Exemplo&lt;/h2&gt;
&lt;p&gt;Neste exemplo, mostrarei um registrador de deslocamento gen√©rico com entrada paralela e sa√≠da serial, carga paralela s√≠ncrona, &lt;em&gt;reset&lt;/em&gt; ass√≠ncrono e deslocamento para a direita ou para a esquerda. A modelagem contempla temporiza√ß√£o (atraso e &lt;em&gt;setup time&lt;/em&gt;) e depura√ß√£o.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;library&lt;/span&gt; &lt;span class="nn"&gt;ieee&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;ieee.numeric_bit.rising_edge&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;reg_deslocamento&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;generic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;natural&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;time&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;time&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt;  &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;entrada_serial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;direcao&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;-- 1=direita, 0=esquerda&lt;/span&gt;
    &lt;span class="n"&gt;carrega&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
  &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
  &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Este registrador precisa ter tamanho &amp;gt; 1 e foi instanciado com &amp;quot;&lt;/span&gt;
         &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;reg_deslocamento&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;funcional&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;reg_deslocamento&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;interno&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;

  &lt;span class="n"&gt;saida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;interno&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="n"&gt;interno&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;elsif&lt;/span&gt; &lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;carrega&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;stable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
          &lt;span class="n"&gt;interno&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt; &lt;span class="k"&gt;after&lt;/span&gt; &lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;else&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;direcao&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
          &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;entrada_serial&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;stable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="n"&gt;interno&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;entrada_serial&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;interno&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;after&lt;/span&gt; &lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;
          &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;entrada_serial&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;stable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="n"&gt;interno&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;interno&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;entrada_serial&lt;/span&gt; &lt;span class="k"&gt;after&lt;/span&gt; &lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;debug&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;carrega&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
          &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;stable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
          &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Setup time violado na entrada paralela.&amp;quot;&lt;/span&gt;
          &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;warning&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;elsif&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;carrega&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
          &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;entrada_serial&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;stable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
          &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Setup time violado na entrada serial.&amp;quot;&lt;/span&gt;
          &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;warning&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Um poss√≠vel &lt;em&gt;testbench&lt;/em&gt; para este registrador pode ser visto abaixo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;library&lt;/span&gt; &lt;span class="nn"&gt;ieee&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;ieee.numeric_bit.rising_edge&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;reg_deslocamento_tb&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;reg_deslocamento_tb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;stim&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;reg_deslocamento_tb&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="nc"&gt;reg_deslocamento&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;generic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;natural&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;time&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;st&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;time&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt;  &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="n"&gt;entrada_serial&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;direcao&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;-- 1=direita, 0=esquerda&lt;/span&gt;
      &lt;span class="n"&gt;carrega&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;component&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;entrada_serial&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;direcao&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;carrega&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;simula&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;

  &lt;span class="n"&gt;reg&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;reg_deslocamento&lt;/span&gt;
    &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;true&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;entrada_serial&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;direcao&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;carrega&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

  &lt;span class="n"&gt;clock&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;simula&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt; &lt;span class="k"&gt;after&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="nc"&gt;stim&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="n"&gt;simula&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;reset_n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;reset_n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;entrada&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1010&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;carrega&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;95&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;entrada&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1011&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;carrega&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;95&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;entrada_serial&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="n"&gt;carrega&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;entrada&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1010&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;carrega&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;entrada_serial&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="n"&gt;simula&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;architecture&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A execu√ß√£o deste &lt;em&gt;testbench&lt;/em&gt; ir√° imprimir:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;reg_deslocamento.vhd:59:11:@350ns:&lt;span class="o"&gt;(&lt;/span&gt;assertion warning&lt;span class="o"&gt;)&lt;/span&gt;: Setup &lt;span class="nb"&gt;time&lt;/span&gt; violado na entrada paralela.
reg_deslocamento.vhd:63:11:@450ns:&lt;span class="o"&gt;(&lt;/span&gt;assertion warning&lt;span class="o"&gt;)&lt;/span&gt;: Setup &lt;span class="nb"&gt;time&lt;/span&gt; violado na entrada serial.
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;No c√≥digo do &lt;em&gt;testbench&lt;/em&gt; h√° tr√™s usos distintos do &lt;code&gt;generic&lt;/code&gt;. Note a inst√¢ncia do registrador usado no &lt;em&gt;testbench&lt;/em&gt;:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;reg&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;reg_deslocamento&lt;/span&gt;
  &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tp&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;true&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;entrada_serial&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;direcao&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;carrega&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A primeira coisa que podemos notar √© que a atribui√ß√£o dos par√¢metros no &lt;code&gt;generic map&lt;/code&gt; foi feita por nome e n√£o posicionalmente (como feita no &lt;code&gt;port map&lt;/code&gt;). Contudo, podemos usar atribui√ß√£o posicional se desejado. O tamanho foi parametrizado como 4 bits, o tempo de propaga√ß√£o (&lt;code&gt;tp&lt;/code&gt;) como 40ns e foi habilitada a depura√ß√£o. A primeira utiliza√ß√£o do &lt;code&gt;generic&lt;/code&gt; foram estas atribui√ß√µes. J√° a segunda, foi uma atribui√ß√£o impl√≠cita. O &lt;em&gt;setup time&lt;/em&gt; (&lt;code&gt;st&lt;/code&gt;) n√£o foi definido no &lt;code&gt;genric map&lt;/code&gt;, portanto a inst√¢ncia utilizar√° o valor padr√£o, que nesse caso √© 15ns. J√° a terceira diz respeito ao par√¢metro &lt;code&gt;debug&lt;/code&gt;. Note que este par√¢metro, se habilitado, permite a ativa√ß√£o de um &lt;code&gt;process&lt;/code&gt; (o √∫ltimo da descri√ß√£o do registrador) que n√£o √© sintetiz√°vel e serve exclusivamente para emitir mensagens de viola√ß√£o do &lt;em&gt;setup time&lt;/em&gt; durante uma simula√ß√£o.&lt;/p&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="basic"></category></entry><entry><title>Testbenchs em VHDL</title><link href="https://balbertini.github.io/vhdl_testbench-pt_BR.html" rel="alternate"></link><published>2018-11-09T01:04:03-02:00</published><updated>2019-09-09T10:16:11-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2018-11-09:/vhdl_testbench-pt_BR.html</id><summary type="html">&lt;p&gt;Como fazer um testbench em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Em HDLs, √© muito comum escrever-se um &lt;em&gt;testbench&lt;/em&gt; para cada m√≥dulo que for desenvolvido. Dessa forma, os m√≥dulos podem ser testados antes da integra√ß√£o. Tamb√©m √© aconselh√°vel escrever um &lt;em&gt;testbench&lt;/em&gt; para o arquivo &lt;em&gt;toplevel&lt;/em&gt;, ou seja, para o arquivo de integra√ß√£o, para garantir que esta foi realizada corretamente.&lt;/p&gt;
&lt;p&gt;A principal fun√ß√£o de um &lt;em&gt;testbench&lt;/em&gt; √© testar ou validar um m√≥dulo. Nesse sentido, um &lt;em&gt;testbench&lt;/em&gt; nada mais √© que um m√≥dulo VHDL que:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Instancia o(s) m√≥dulo(s) a serem testados;&lt;/li&gt;
&lt;li&gt;Injeta sinais de entrada no(s) m√≥dulo(s) em teste;&lt;/li&gt;
&lt;li&gt;Verifica se a sa√≠da do(s) m√≥dulo(s) s√£o as esperadas.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Normalmente o &lt;em&gt;testbench&lt;/em&gt; n√£o √© projetado para ser sintetiz√°vel, o que libera o projetista para utilizar primitivas funcionais n√£o sintetiz√°veis e n√£o requer uma interface (entidade vazia), pois o objetivo n√£o √© modelar um hardware. A maneira mais comum de se montar um &lt;em&gt;testbench&lt;/em&gt; √© usando o modelo &lt;strong&gt;DUT&lt;/strong&gt; (do ingl√™s &lt;em&gt;Device Under Test&lt;/em&gt;). Este modelo pode ser visto na figura abaixo:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Modelo DUT de textbench" src="https://balbertini.github.io/images/vhdl/testbench.png"&gt;&lt;/p&gt;
&lt;p&gt;A inst√¢ncia do(s) m√≥dulos(s) a serem testados √© realizada atrav√©s de um comando de inst√¢ncia de componente (palavra reservada &lt;code&gt;component&lt;/code&gt;), da mesma maneira como √© utilizada para implementar a modulariza√ß√£o em sistemas digitais, quando um m√≥dulo utiliza v√°rios outros m√≥dulos menores como componentes para formar um m√≥dulo maior. Um exemplo cl√°ssico √© um contador, que utiliza v√°rios &lt;em&gt;flip-flops&lt;/em&gt; para formar uma estrutura contadora (nesse caso h√° um m√≥dulo &lt;em&gt;flip-flop&lt;/em&gt; instanciado v√°rias vezes e organizado na forma de um contador).&lt;/p&gt;
&lt;h3&gt;Assert&lt;/h3&gt;
&lt;p&gt;Para verificar os resultados, usa-se a palavra reservada &lt;code&gt;assert&lt;/code&gt;, que tem o seguinte formato:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;condicao&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="n"&gt;mensagem_string&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;nivel_de_gravidade&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A &lt;code&gt;condicao&lt;/code&gt; pode ser qualquer uma que retorne um valor &lt;code&gt;boolean&lt;/code&gt;, a &lt;code&gt;mensagem_string&lt;/code&gt; √© qualquer uma do tipo &lt;code&gt;string&lt;/code&gt; e o &lt;code&gt;nivel_de_severidade&lt;/code&gt; √© uma das op√ß√µes &lt;code&gt;note&lt;/code&gt;, &lt;code&gt;warning&lt;/code&gt;, &lt;code&gt;error&lt;/code&gt; ou &lt;code&gt;failure&lt;/code&gt;. √â usual que a condi√ß√£o seja uma compara√ß√£o. As duas √∫ltimas (mensagem e n√≠vel de severidade) podem ser omitidas, caso em que uma mensagem padr√£o ser√° mostrada e a gravidade ser√° &lt;code&gt;error&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;A mensagem ser√° impressa caso a condi√ß√£o falhe, portanto deve ser algo que tenha sentido para o projetista. √â poss√≠vel mostrar o valor de sinais ou vari√°veis usando a propriedade &lt;code&gt;image&lt;/code&gt; do tipo de dado que se quer mostrar. Essa propriedade √© definida pelo pr√≥prio tipo de dado e retorna uma &lt;em&gt;string&lt;/em&gt; leg√≠vel que representa o valor (e.g. &lt;code&gt;integer'image(123)&lt;/code&gt; retorna a string "123").&lt;/p&gt;
&lt;p&gt;Quanto √† severidade do erro, √© uma dica para o simulador sobre a a√ß√£o que ele deve tomar caso a condi√ß√£o falhe. O n√≠vel &lt;code&gt;note&lt;/code&gt; n√£o faz nada e s√≥ mostra a mensagem. O &lt;code&gt;warning&lt;/code&gt; mostra a mensagem com destaque, mas n√£o p√°ra a simula√ß√£o, portanto deve ser utilizada para mostrar erros n√£o cr√≠ticos. O &lt;code&gt;error&lt;/code&gt; mostra a mensagem com um destaque maior e deve ser utilizado para erros que possam ocasionar mais erros na simula√ß√£o ou erros cr√≠ticos recuper√°veis (o circuito n√£o se comportou como o esperado mas pode voltar a se comportar). Este n√≠vel normalmente n√£o p√°ra a simula√ß√£o, mas dependendo da implementa√ß√£o do simulador pode ocasionar problemas ou at√© mesmo a parada da simula√ß√£o. J√° o n√≠vel &lt;code&gt;failure&lt;/code&gt; sempre p√°ra a simula√ß√£o e deve ser usado para erros cr√≠ticos n√£o recuper√°veis.&lt;/p&gt;
&lt;p&gt;A origem dos dados de entrada e sa√≠da, que ser√£o usados respectivamente para injetar os sinais de entrada do m√≥dulo e para verificar se a sa√≠da √© a esperada, pode ser feita de v√°rias formas. As mais usuais e recomendadas s√£o:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="#programatico"&gt;Geradas programaticamente no pr√≥prio &lt;em&gt;testbench&lt;/em&gt; em VHDL;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#vetor"&gt;Atrav√©s de um vetor de testes embutido no &lt;em&gt;testbench&lt;/em&gt;;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#arquivoexterno"&gt;Geradas externamente e lidas pelo &lt;em&gt;testbench&lt;/em&gt; em VHDL.&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Cobriremos cada um destes m√©todos neste post.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a name="programatico"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Exemplo: escrevendo o testbench programaticamente&lt;/h2&gt;
&lt;p&gt;Considere o m√≥dulo em VHDL de um contador universal, cuja entidade tem a seguinte declara√ß√£o:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;contador&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;generic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt; &lt;span class="k"&gt;range&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;right&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clear_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;qi&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;qo&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;contador&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Este contador √© gen√©rico, cujo m√≥dulo √© calculado atrav√©s do par√¢metro chamado &lt;code&gt;modulo&lt;/code&gt;, na ocasi√£o da instancia√ß√£o. √© sens√≠vel √† borda de subida, possui &lt;em&gt;clear&lt;/em&gt; ativo baixo ass√≠ncrono, carga paralela s√≠ncrona, determina√ß√£o do sentido de contagem (&lt;code&gt;up=1&lt;/code&gt; contagem crescente), e um &lt;em&gt;enable&lt;/em&gt; que desabilita a contagem.&lt;/p&gt;
&lt;p&gt;O &lt;em&gt;testbench&lt;/em&gt; para este m√≥dulo come√ßa declarando-se as bibliotecas que utilizaremos e a entidade vazia:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;library&lt;/span&gt; &lt;span class="nn"&gt;ieee&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;ieee.numeric_bit.&lt;/span&gt;&lt;span class="k"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;ieee.math_real.&lt;/span&gt;&lt;span class="k"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;contador_tb&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;-- Entidade vazia, so serve para TB&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Ap√≥s a declara√ß√£o da entidade, declaramos a arquitetura normalmente, como em um m√≥dulo VHDL qualquer. A delcara√ß√£o completa pode ser vista abaixo, e a dissecaremos no decorrer deste post:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;dut&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;contador_tb&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;constant&lt;/span&gt; &lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="nc"&gt;contador&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;generic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt; &lt;span class="k"&gt;range&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;right&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clear_n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="n"&gt;qi&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="n"&gt;qo&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;component&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;log2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;real&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="p"&gt;))))&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt; &lt;span class="k"&gt;range&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;constant&lt;/span&gt; &lt;span class="n"&gt;periodoClock&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;time&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="n"&gt;clk&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;clk&lt;/span&gt; &lt;span class="k"&gt;after&lt;/span&gt; &lt;span class="n"&gt;periodoClock&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;saidai&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;to_integer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

  &lt;span class="n"&gt;dut&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;contador&lt;/span&gt;
    &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

  &lt;span class="nc"&gt;st&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="c1"&gt;--! Imprime mensagem de inicio de teste&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;BOT&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;note&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;--! Testa se o clear est√° OK&lt;/span&gt;
    &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste de clear falhou.&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
      &lt;span class="s"&gt;&amp;quot; Obtido: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;--! Testa se a contagem crescente est√° OK&lt;/span&gt;
    &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
      &lt;span class="c1"&gt;--! Verifica a contagem&lt;/span&gt;
      &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot;Contagem falhou. Esperado: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot; Obtido: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste de overflow falhou.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste de underflow falhou.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="c1"&gt;--! Testa se a contagem decrescente est√° OK&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
      &lt;span class="c1"&gt;--! Verifica a contagem&lt;/span&gt;
      &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot;Contagem falhou. Esperado: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot; Obtido: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;entrada&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste de load max falhou.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;entrada&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste de load min falhou.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
      &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="c1"&gt;--! Verifica a contagem&lt;/span&gt;
      &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot;Teste de enable falhou no &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot; ciclo.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;EOT&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;note&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;dut&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;No pre√¢mbulo da arquitetura, declarou-se o componente e os sinais necess√°rios para lig√°-lo. Ainda declarou-se duas constantes, que ser√£o usadas posteriormente.&lt;/p&gt;
&lt;p&gt;O primeiro bloco do &lt;em&gt;testbench&lt;/em&gt; gera o sinal de &lt;em&gt;clock&lt;/em&gt; necess√°rio para alimentar o contador (contadores s√£o circuitos sequenciais) e um sinal de suporte cujo √∫nico prop√≥sito √© copiar o pr√≥prio sinal de sa√≠da do contador (&lt;code&gt;saida&lt;/code&gt;), mas convertido para inteiro (&lt;code&gt;saida&lt;/code&gt; √© um &lt;code&gt;bit_vector&lt;/code&gt; e &lt;code&gt;saidai&lt;/code&gt; √© um &lt;code&gt;integer&lt;/code&gt;). Este sinal de suporte facilita a montagem do &lt;em&gt;testbench&lt;/em&gt; pois podemos us√°-lo para as compara√ß√µes posteriormente sem precisar chamar as fun√ß√µes de convers√£o &lt;code&gt;to_integer&lt;/code&gt; e &lt;code&gt;unsigned&lt;/code&gt; toda vez que formos fazer uma compara√ß√£o. Para gera√ß√£o do &lt;em&gt;clock&lt;/em&gt;, usou-se uma atribui√ß√£o com cl√°usula &lt;code&gt;after&lt;/code&gt;, ou seja, a cada &lt;code&gt;periodoClock/2&lt;/code&gt; o sinal ser√° invertido, gerando um clock de &lt;code&gt;periodoClock&lt;/code&gt; (uma constante que vale 1ns e foi declarada no pre√¢mbulo da arquitetura) e &lt;em&gt;duty-cycle&lt;/em&gt; de 50%. Note que este tipo de declara√ß√£o (&lt;code&gt;after&lt;/code&gt;) n√£o √© sintetiz√°vel e serve somente para fins de temporiza√ß√£o em simula√ß√£o.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="n"&gt;clk&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;clk&lt;/span&gt; &lt;span class="k"&gt;after&lt;/span&gt; &lt;span class="n"&gt;periodoClock&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;saidai&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;to_integer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;unsigned&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O segundo bloco do &lt;em&gt;testbench&lt;/em&gt; efetivamente instancia o DUT, que nesse caso √© o contador. Note que o contador est√° ligado aos sinais criados no pre√¢mbulo da arquitetura, incluindo o &lt;code&gt;modulo&lt;/code&gt; (nesse caso uma constante que vale 256). A fun√ß√£o deste bloco √© somente esta: instanciar e ligar o DUT no &lt;em&gt;testbench&lt;/em&gt;.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="n"&gt;dut&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;contador&lt;/span&gt;
    &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;entrada&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;saida&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O terceiro e √∫ltimo bloco √© o gerador de est√≠mulos para o DUT (por isso o nome &lt;code&gt;st&lt;/code&gt;). √â composto por apenas um &lt;code&gt;process&lt;/code&gt; que injeta e verifica os sinais de entrada e sa√≠da, respectivamente. Vamos dissec√°-lo em blocos novamente.&lt;/p&gt;
&lt;p&gt;Esta parte declara o &lt;code&gt;process&lt;/code&gt; e imprime uma mensagem incondicionalmente (normalmente as mensagens aparecer√£o na tela do simulador, no terminal ou no arquivo de sa√≠da da simula√ß√£o). Note que o &lt;code&gt;assert&lt;/code&gt; est√° verificando um valor constante &lt;code&gt;false&lt;/code&gt;, portanto este &lt;code&gt;assert&lt;/code&gt; sempre ir√° falhar, causando a impress√£o da mensagem "BOT" com severidade baixa (sem parar a simula√ß√£o). BOT √© um acr√¥nimo para &lt;em&gt;Begin Of Test&lt;/em&gt;, para indicar que o teste come√ßou.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="nc"&gt;st&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="c1"&gt;--! Imprime mensagem de inicio de teste&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;BOT&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;note&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Agora sim come√ßamos a testar o contador. Nesta parte, colocamos o &lt;em&gt;clear&lt;/em&gt; em zero, portanto o contador deve manter as sa√≠das zeradas independentemente das demais entradas. Este teste n√£o √© √≥timo, pois seria necess√°rio testar todas as combina√ß√µes de entradas mantendo-se o &lt;em&gt;clear&lt;/em&gt; baixo para garantir uma cobertura total. Mas, √© suficiente para os prop√≥sitos que desejamos testar, que √© a sa√≠da em zero mesmo com borda do &lt;em&gt;clock&lt;/em&gt;. Os &lt;code&gt;wait&lt;/code&gt; esperam a borda de subida (&lt;code&gt;rising_edge&lt;/code&gt;) e de descida (&lt;code&gt;falling_edge&lt;/code&gt;) do &lt;em&gt;clock&lt;/em&gt; antes de fazer a verifica√ß√£o, portanto garantimos que o contador recebeu uma de cada uma das bordas com a as condi√ß√µes do teste (nesse caso as entradas &lt;code&gt;clr=0&lt;/code&gt;, &lt;code&gt;load=0&lt;/code&gt;, &lt;code&gt;up=1&lt;/code&gt; e &lt;code&gt;en=1&lt;/code&gt;). Se a sa√≠da n√£o for zero, o &lt;code&gt;assert&lt;/code&gt; ir√° mostrar a mensagem de falha com o valor da sa√≠da, e tamb√©m ir√° parar a simula√ß√£o (severidade &lt;code&gt;failure&lt;/code&gt;).&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="c1"&gt;--! Testa se o clear est√° OK&lt;/span&gt;
    &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;rising_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste de clear falhou.&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
      &lt;span class="s"&gt;&amp;quot; Obtido: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O teste anterior √© simples pois s√≥ testa se a sa√≠da se mant√©m em zero. No teste seguinte, mostrado abaixo, mudamos os valores atribu√≠dos √†s entradas para configurar a contagem crescente do contador, simulando uma opera√ß√£o normal em contagem crescente. Para cada valor do &lt;code&gt;loop&lt;/code&gt;, verificamos se a sa√≠da condiz com o valor esperado (note que a sa√≠da inicial √© zero pois passamos no teste anterior) e aguardamos uma borda de descida do &lt;em&gt;clock&lt;/em&gt;, garantindo que o contador avan√ßou para o pr√≥ximo valor esperado, que ser√° verificado na pr√≥xima itera√ß√£o do &lt;code&gt;loop&lt;/code&gt;.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="c1"&gt;--! Testa se a contagem crescente est√° OK&lt;/span&gt;
    &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
      &lt;span class="c1"&gt;--! Verifica a contagem&lt;/span&gt;
      &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot;Contagem falhou. Esperado: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot; Obtido: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Ao final do teste anterior, o valor da contagem √© o m√°ximo poss√≠vel +1 (√∫ltima itera√ß√£o do teste anterior). Aproveitamos para testar o &lt;em&gt;overflow&lt;/em&gt;, ou seja, a sa√≠da deve ser zero novamente. Tamb√©m aproveitou-se para inverter o sentido de contagem e verificar o &lt;em&gt;underflow&lt;/em&gt;, ou seja, a partir do valor m√°ximo +1, se contarmos decrescente o valor deve ser o m√°ximo. Os nomes &lt;em&gt;overflow&lt;/em&gt; e &lt;em&gt;underflow&lt;/em&gt; foram usados pelo projetista mas tem significados distintos do utilizado neste contexto (i.e. quando lidando com n√∫meros inteiros ou ponto flutuante esta nomenclatura n√£o √© usada para indicar esta transi√ß√£o).&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste de overflow falhou.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste de underflow falhou.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Este pr√≥ximo bloco de testes √© id√™ntico ao bloco onde testou-se a contagem, mas dessa vez decrescente pois a √∫ltima configura√ß√£o das entradas (para o teste de &lt;em&gt;underflow&lt;/em&gt;) deixou o contador configurado desta maneira. Novamente aproveita-se o √∫ltimo teste sabendo que o contador parte do valor m√°ximo poss√≠vel.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="c1"&gt;--! Testa se a contagem decrescente est√° OK&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
      &lt;span class="c1"&gt;--! Verifica a contagem&lt;/span&gt;
      &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot;Contagem falhou. Esperado: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot; Obtido: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Ainda falta testar a carga paralela. Neste bloco, o projetista resolveu testar a carga m√°xima (entrada toda em 1) e m√≠nima (entrada toda em 0). Obviamente este teste n√£o garante uma boa cobertura, mas √© suficiente para os prop√≥sitos deste exemplo.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;entrada&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;modulo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste de load max falhou.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;entrada&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste de load min falhou.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Por √∫ltimo, testou-se a contagem por tr√™s ciclos de &lt;em&gt;clock&lt;/em&gt;, com o &lt;em&gt;enable&lt;/em&gt; desativado. O contador terminou o √∫ltimo teste com uma carga de zero, portanto este valor deve-se manter na sa√≠da durante todos os tr√™s ciclos de &lt;em&gt;clock&lt;/em&gt;.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="n"&gt;clr&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
      &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;falling_edge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
      &lt;span class="c1"&gt;--! Verifica a contagem&lt;/span&gt;
      &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;saidai&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot;Teste de enable falhou no &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;image&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
        &lt;span class="s"&gt;&amp;quot; ciclo.&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Este √∫ltimo peda√ßo n√£o √© um teste em si mas tem duas fun√ß√µes. A primeira √© mostrar uma mensagem de fim de teste (&lt;em&gt;End Of Test&lt;/em&gt;) e a segunda √© terminar o processo de gera√ß√£o e verifica√ß√£o de est√≠mulos. Isso √© feito atrav√©s do &lt;code&gt;wait&lt;/code&gt; incondicional, que suspende indefinidamente o &lt;code&gt;process&lt;/code&gt; do ponto de vista do simulador, indicando que este &lt;code&gt;process&lt;/code&gt; j√° realizou o trabalho que deveria.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;EOT&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;note&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;dut&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;&lt;a name="vetor"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Exemplo: vetor de testes no c√≥digo&lt;/h2&gt;
&lt;p&gt;Este exemplo testa um comparador de 12 bits cuja entidade √©:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;comp12bit&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;XD&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;YD&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="kt"&gt;std_logic_vector&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;XLTY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;XEQY&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;XGTY&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;std_logic&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;comp12bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Os procedimentos para instanciar e ligar o DUT ao &lt;em&gt;testbench&lt;/em&gt; s√£o os mesmos, portanto os omitiremos. A principal diferen√ßa est√° no processo gerador de est√≠mulos. No exemplo anterior, os est√≠mulos eram gerados programaticamente, um a um. Neste caso, o &lt;code&gt;process&lt;/code&gt; apenas percorre uma estrutura contendo os vetores de teste, injetando as entradas e comparando as sa√≠das com as do vetor. Os valores no vetor de testes devem ser previamente gerados (e.g. atrav√©s de software, simula√ß√£o ou manualmente).&lt;/p&gt;
&lt;p&gt;No pre√¢mbulo do &lt;code&gt;process&lt;/code&gt;, declara-se um novo tipo (&lt;code&gt;pattern_type&lt;/code&gt;) baseado no registro (&lt;code&gt;record&lt;/code&gt;), que ir√° conter os valores do vetor de testes. Este registro representa um teste auto-contido, portanto deve conter as entradas e todas as sa√≠das esperadas para estas entradas. Logo ap√≥s a declara√ß√£o do tipo do vetor de testes, declara-se o tipo do vetor em si (&lt;code&gt;pattern_array&lt;/code&gt;), seguido do vetor (&lt;code&gt;patterns&lt;/code&gt;) propriamente dito. O vetor foi declarado como contante pois ele n√£o deve ser modificado durante os testes.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;-- Exemplo cortesia do Prof. Edson S. Gomi (PCS)&lt;/span&gt;
&lt;span class="nc"&gt;st&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="n"&gt;pattern_type&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="k"&gt;record&lt;/span&gt;
    &lt;span class="c1"&gt;--  Entradas&lt;/span&gt;
    &lt;span class="n"&gt;xd&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;std_logic_vector&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;yd&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;std_logic_vector&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="c1"&gt;--  Saidas&lt;/span&gt;
    &lt;span class="n"&gt;xlty&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;std_logic&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;xeqy&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;std_logic&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;xgty&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;std_logic&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;record&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="n"&gt;pattern_array&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="k"&gt;array&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;natural&lt;/span&gt; &lt;span class="k"&gt;range&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="n"&gt;pattern_type&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;constant&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;pattern_array&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt;
    &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100000000000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;010000000000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
     &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;000000000001&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;000100000000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
     &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;010000100000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;000000000100&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
     &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;011111111111&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100000000000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
     &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;000100000000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;000010000100&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
     &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;000011111000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;100000000001&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
     &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;000000000000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;000000000000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Note que o vetor √© composto por 7 testes distintos, cada um com duas entradas e as tr√™s sa√≠das poss√≠veis.&lt;/p&gt;
&lt;p&gt;Com o vetor de testes declarado e preenchido, o teste √© simples: iterar sobre o vetor injetando as entradas e verificando as sa√≠das para cada um dos testes, at√© exauri-los. O restante do &lt;code&gt;process&lt;/code&gt; que faz isso pode ser visto abaixo.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="c1"&gt;--  Para cada padrao de teste no vetor&lt;/span&gt;
  &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;range&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
    &lt;span class="c1"&gt;--  Injeta as entradas&lt;/span&gt;
    &lt;span class="n"&gt;xd&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;xd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;yd&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;yd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;--  Aguarda que o modulo produza a saida&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="c1"&gt;--  Verifica as saidas&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;xlty&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;xlty&lt;/span&gt;
      &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;bad check xlty&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;xeqy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;xeqy&lt;/span&gt;
      &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;back check xeqy&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;xgty&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;xgty&lt;/span&gt;
      &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;bad check xgty&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt; &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;end of test&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;note&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="k"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;hr&gt;
&lt;p&gt;&lt;a name="arquivoexterno"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Exemplo: lendo os casos de teste de um arquivo externo&lt;/h2&gt;
&lt;p&gt;Neste exemplo, vamos mostrar como ler os casos de teste de um arquivo externo. A primeira coisa a se fazer √© gerar os dados de teste. A entidade que testaremos √© uma ALU (&lt;em&gt;Arithmetic and Logic Unit&lt;/em&gt;, ou ULA, Unidade L√≥gica e Aritm√©tica), cuja declara√ß√£o da entidade pode ser vista abaixo.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;-- @brief ALU is signed and uses 2-complement&lt;/span&gt;
&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;alu&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;signed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;-- inputs&lt;/span&gt;
    &lt;span class="n"&gt;F&lt;/span&gt;    &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;signed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;-- output&lt;/span&gt;
    &lt;span class="n"&gt;S&lt;/span&gt;    &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit_vector&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;-- op selection&lt;/span&gt;
    &lt;span class="n"&gt;Z&lt;/span&gt;    &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;out&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt; &lt;span class="c1"&gt;-- zero flag&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;alu&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A fun√ß√£o realizada √© definida pela entrada &lt;code&gt;S&lt;/code&gt;, sendo 0000 AND, 0001 OR, 0010 soma A+B, 0110 subtra√ß√£o A-B, 0111 sa√≠da alta se A&amp;lt;B e baixa caso contr√°rio, e 1100 NOR. Para gerar os casos de teste, escrevi um script em Python que gera alguns casos considerados importantes e depois 100 entradas aleat√≥rias &lt;code&gt;A&lt;/code&gt; e &lt;code&gt;B&lt;/code&gt;, calculando a sa√≠da esperada para cada uma das seis opera√ß√µes que a ALU pode realizar. O script pode ser visto abaixo.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#-------------------------------------------------------------------------------&lt;/span&gt;
&lt;span class="c1"&gt;# @file alu_tb.py&lt;/span&gt;
&lt;span class="c1"&gt;# @brief Generate test cases for64-bit ALU&lt;/span&gt;
&lt;span class="c1"&gt;# @author Bruno Albertini (balbertini@usp.br)&lt;/span&gt;
&lt;span class="c1"&gt;# @date 20180807&lt;/span&gt;
&lt;span class="c1"&gt;#-------------------------------------------------------------------------------&lt;/span&gt;

&lt;span class="c1"&gt;# Given two long integers, print all test cases&lt;/span&gt;
&lt;span class="c1"&gt;# Format of this file is A B A&amp;amp;B A|B A+B A-B A&amp;lt;B?1:0 ~(A|B)&lt;/span&gt;
&lt;span class="c1"&gt;# Space is the separator between bit words&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;print_cases&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;out&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0:064b}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0:064b}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0:064b}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0:064b}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0:064b}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0:064b}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;ai&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;bi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0:064b}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ai&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;bi&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0:064b}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;out&lt;/span&gt;

&lt;span class="c1"&gt;# Corner cases&lt;/span&gt;
&lt;span class="n"&gt;print_cases&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# all zeroes&lt;/span&gt;
&lt;span class="n"&gt;print_cases&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# all ones&lt;/span&gt;
&lt;span class="n"&gt;print_cases&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# A zeroed, B all ones&lt;/span&gt;
&lt;span class="n"&gt;print_cases&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# A all ones, B zeroed&lt;/span&gt;

&lt;span class="c1"&gt;# Random cases&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;uuid&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;uuid&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uuid4&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;int&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;uuid&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uuid4&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;int&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;print_cases&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Com este script, gerei um arquivo contendo oito valores bin√°rios de 64 bits em cada linha, sendo &lt;code&gt;A&lt;/code&gt;, &lt;code&gt;B&lt;/code&gt; e os seis resultados esperados, em ordem e separados por espa√ßo. Para gerar, basta executar o script com atrav√©s de um interpretador Python (testado com a vers√£o 2.7).&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="go"&gt;python alu_tb.py &amp;gt; alu_tb.dat&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Um exemplo de uma linha deste arquivo √© (note que √© UMA linha):&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;1001101010001010110011010000011110011001110000111010011111110111 1001001101000100001110011110100110000101010111011110110011100000 1001001000000000000010010000000110000001010000011010010011100000 1001101111001110111111011110111110011101110111111110111111110111 0010110111001111000001101111000100011111001000011001010011010111 0000011101000110100100110001111000010100011001011011101100010111 0000000000000000000000000000000000000000000000000000000000000000 0110010000110001000000100001000001100010001000000001000000001000&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Agora que temos o arquivo com os vetores de teste, podemos usar o vetor dentro do &lt;em&gt;testbench&lt;/em&gt;. Os procedimentos para instanciar a ALU como &lt;em&gt;DUT&lt;/em&gt; s√£o id√™nticos ao exemplo anterior, portanto pularei este passo.&lt;/p&gt;
&lt;p&gt;A primeira mudan√ßa necess√°ria √© incluir a declara√ß√£o de uso da biblioteca &lt;code&gt;textio&lt;/code&gt;, que √© utilizada justamente para ler arquivos. Esta declara√ß√£o deve ser colocada no pre√¢mbulo do arquivo VHDL que descreve o &lt;em&gt;testbench&lt;/em&gt;. √â importante notar que esta biblioteca n√£o √© sintetiz√°vel, portanto se o seu c√≥digo usar a &lt;code&gt;textio&lt;/code&gt; h√° grandes chances de ele n√£o ser sintetizado (h√° uma exce√ß√£o para a carga do conte√∫do inicial de mem√≥rias, que explorarei em outro artigo). De modo geral, utilize esta biblioteca somente em &lt;em&gt;testbench&lt;/em&gt;.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;library&lt;/span&gt; &lt;span class="nn"&gt;ieee&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;std.textio.&lt;/span&gt;&lt;span class="k"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Com a declara√ß√£o de uso da biblioteca, podemos utilizar as fun√ß√µes de acesso a arquivos. Isso √© feito no pre√¢mbulo do processo que gera os est√≠mulos (que nesse caso n√£o gerar√° propriamente, mas sim ler√° os casos de um arquivo gerado previamente).&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nc"&gt;stim&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;file&lt;/span&gt; &lt;span class="n"&gt;tb_file&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="k"&gt;open&lt;/span&gt; &lt;span class="n"&gt;read_mode&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;alu_tb.dat&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;variable&lt;/span&gt; &lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;variable&lt;/span&gt; &lt;span class="n"&gt;space&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;character&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;variable&lt;/span&gt; &lt;span class="n"&gt;Av&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Bv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A declara√ß√£o &lt;code&gt;tb_file&lt;/code&gt; √© a principal, que efetivamente instancia o arquivo especificado como um objeto dentro do ambiente de simula√ß√£o. Neste caso, o arquivo foi aberto somente para leitura, mas √© poss√≠vel tamb√©m escrever em um arquivo (n√£o explorarei esta caracter√≠stica neste exemplo, mas ela pode ser √∫til para gravar os resultados em um arquivo externo). As vari√°veis &lt;code&gt;tb_line&lt;/code&gt; e &lt;code&gt;space&lt;/code&gt; s√£o usadas para ler o arquivo linha a linha, e tamb√©m para ler o caracter que separa os oito valores em uma linha (poderia ser qualquer caractere, basta que seja apenas um).&lt;/p&gt;
&lt;p&gt;O centro de uma verifica√ß√£o baseada em arquivo √© um la√ßo que percorre todo o arquivo lendo-o linha por linha. A cada linha, deve-se ler os valores das entradas e injet√°-las no DUT:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;endfile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
  &lt;span class="c1"&gt;-- read inputs&lt;/span&gt;
  &lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Av&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="kt"&gt;signed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Av&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;space&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Bv&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;B&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="kt"&gt;signed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Bv&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Note que h√° a leitura da linha (&lt;code&gt;readline&lt;/code&gt;), seguida pela leitura de um &lt;code&gt;bit_vector&lt;/code&gt; de 64 bits (pois o sinal &lt;code&gt;Av&lt;/code&gt; foi declarado como tal), e a inje√ß√£o deste vetor no sinal &lt;code&gt;A&lt;/code&gt; ligado ao DUT. Repete-se o mesmo para o sinal &lt;code&gt;B&lt;/code&gt;, por√©m ao inv√©s de lermos outra linha, lemos um caractere (o espa√ßo), e outro vetor de 64 bits e, &lt;code&gt;Bv&lt;/code&gt; para injetarmos em &lt;code&gt;B&lt;/code&gt;. As leituras do &lt;code&gt;read&lt;/code&gt; s√£o posicionais, ou seja, ele sempre ler√° a quantidade de caracteres necess√°ria para preencher o receptor da leitura. Note que o caractere lido poderia ser qualquer coisa, o nome &lt;strong&gt;space&lt;/strong&gt; √© apenas um identificador. Note tamb√©m que n√£o usamos o valor lido neste sinal para nada, ele foi declarado com o √∫nico prop√≥sito de ler um caractere entre os vetores.&lt;/p&gt;
&lt;p&gt;Com os valores das entradas injetados, devemos verificar a sa√≠da para cada opera√ß√£o. Sabemos que os pr√≥ximos valores na linha s√£o vetores de 64 bits correspondentes √†s sa√≠das para todas as opera√ß√µes da ULA. A primeira opera√ß√£o √© o AND, portanto devemos configurar a ULA para isso (&lt;code&gt;S=0000&lt;/code&gt;) e comparar a sua sa√≠da com o valor lido do vetor de testes:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;-- AND test&lt;/span&gt;
&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;space&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="n"&gt;S&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;equalSignedBitvector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
 &lt;span class="n"&gt;report&lt;/span&gt;
  &lt;span class="s"&gt;&amp;quot;AND checked failed.&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;LF&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
  &lt;span class="s"&gt;&amp;quot;  A=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
  &lt;span class="s"&gt;&amp;quot;  B=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
  &lt;span class="s"&gt;&amp;quot;res=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
  &lt;span class="s"&gt;&amp;quot;exp=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Em ordem, fizemos neste √∫ltimo teste: leitura do caractere separador dos vetores, leitura do valor esperado (armazenado em &lt;code&gt;res&lt;/code&gt;), configura√ß√£o do DUT para fazer a opera√ß√£o esperada (&lt;code&gt;S=0000&lt;/code&gt;), espera para o DUT produzir a sa√≠da e finalmente a asser√ß√£o de que o valor correto foi produzido. A fun√ß√£o &lt;code&gt;equalSignedBitvector&lt;/code&gt; retorna verdadeiro se &lt;code&gt;F=res&lt;/code&gt; e foi usada pois &lt;code&gt;F&lt;/code&gt; √© do tipo &lt;code&gt;signed&lt;/code&gt; e &lt;code&gt;res&lt;/code&gt; do tipo &lt;code&gt;bit_vector&lt;/code&gt;, uma compara√ß√£o n√£o padr√£o. A fun√ß√£o pode ser vista no final desta se√ß√£o.&lt;/p&gt;
&lt;p&gt;Este padr√£o repete-se para todas as fun√ß√µes do DUT. O restante do arquivo de testes pode ser visto abaixo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;  &lt;span class="c1"&gt;-- OR test&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;space&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;S&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0001&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;equalSignedBitvector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="n"&gt;report&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;OR checked failed.&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;LF&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;  A=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;  B=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;res=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;exp=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="c1"&gt;-- ADD test&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;space&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;S&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0010&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;equalSignedBitvector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="n"&gt;report&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;ADD checked failed.&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;LF&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;  A=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;  B=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;res=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;exp=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="c1"&gt;-- SUB test&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;space&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;S&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0110&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;equalSignedBitvector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="n"&gt;report&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;SUB checked failed.&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;LF&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;  A=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;  B=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;res=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;exp=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="c1"&gt;-- SLT test&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;space&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;S&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;0111&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;equalSignedBitvector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="n"&gt;report&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;SLT checked failed.&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;LF&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;  A=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;  B=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;res=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;exp=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="c1"&gt;-- NOR test&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;space&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tb_line&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;S&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;1100&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;equalSignedBitvector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
   &lt;span class="n"&gt;report&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;NOR checked failed.&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;LF&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;  A=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;  B=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;res=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LF&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
    &lt;span class="s"&gt;&amp;quot;exp=&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;to_bstring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O la√ßo ser√° repetido at√© que o arquivo acabe, ou seja, n√£o h√° mais linhas para serem lidas. Para cada linha, o DUT √© testado v√°rias vezes, para cada fun√ß√£o.&lt;/p&gt;
&lt;p&gt;No geral, este m√©todo √© √∫til quando n√£o se pode testar todas as entradas poss√≠veis para um determinado m√≥dulo, ou quando testamos a id√©ia do hardware modelando-a atrav√©s de uma prova de conceito em software. No primeiro caso, quando √© invi√°vel testar todas as entradas poss√≠veis, gera-se valores aleat√≥rios de forma a garantir uma cobertura m√≠nima dos testes. Um exemplo comum do segundo caso, quando modela-se em software primeiro, √© a criptografia. Come√ßa-se testando a id√©ia matematicamente, depois faz-se uma implementa√ß√£o em software onde pode-se testar o desempenho e a seguran√ßa do algoritmo (e da implementa√ß√£o), e s√≥ depois implementa-se um hardware (e nem sempre todo o algoritmo √© vantajoso em hardware). Neste caso, o motivo principal √© que temos uma implementa√ß√£o de refer√™ncia em software que confiamos estar correta (chamada de &lt;em&gt;golden model&lt;/em&gt; ou &lt;em&gt;reference model&lt;/em&gt;). Os valores para testar o hardware descrito podem ser facilmente retirados do software instrumentando-o de maneira que as entradas e sa√≠das das partes desejadas (e.g. fun√ß√µes) sejam gravadas em um arquivo. Este arquivo pode ent√£o ser lido pelo &lt;em&gt;testbench&lt;/em&gt; e usado como verifica√ß√£o.&lt;/p&gt;
&lt;p&gt;Fun√ß√£o de compara√ß√£o usada no exemplo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;-- Funcao de comparacao de igualdade bit a bit entre signed e bit_vector&lt;/span&gt;
&lt;span class="k"&gt;function&lt;/span&gt; &lt;span class="n"&gt;equalSignedBitvector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;signed&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;length&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;length&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;/=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;hr&gt;
&lt;h1&gt;Parando uma simula√ß√£o baseada em eventos&lt;/h1&gt;
&lt;p&gt;Em ambos os exemplos, a parada da simula√ß√£o √© efetivada pelo &lt;code&gt;wait&lt;/code&gt; incondicional no final do &lt;em&gt;process&lt;/em&gt;, que suspende-o definitivamente dentro do escalonador de eventos do simulador. Quando todos os &lt;em&gt;process&lt;/em&gt; estiverem suspensos indefinidamente, a simula√ß√£o termina ap√≥s a estabiliza√ß√£o dos sinais combinat√≥rios pois n√£o h√° mais como nenhum sinal mudar de valor, portanto n√£o h√° mais o que simular.&lt;/p&gt;
&lt;p&gt;Contudo, h√° um problema: ainda estamos gerando o sinal de &lt;em&gt;clock&lt;/em&gt;. Em quase todos os simuladores baseados em eventos, o simples fato de existir um sinal peri√≥dico sendo gerado faz com que a simula√ß√£o seja executada indefinidamente. Para resolver o problema, podemos criar um sinal que habilita ou n√£o o &lt;em&gt;clock&lt;/em&gt;, substituindo a linha de gera√ß√£o por uma vers√£o contendo um sinal controlador, como abaixo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;clk&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;simulando&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;clk&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;after&lt;/span&gt; &lt;span class="n"&gt;periodoClock&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O sinal &lt;code&gt;simulando&lt;/code&gt; serve para controlar a gera√ß√£o do &lt;code&gt;clock&lt;/code&gt;. Se ele for alto, o &lt;code&gt;clock&lt;/code&gt; √© gerado normalmente, caso contr√°rio ele permanecer√° baixo devido ao AND inserido. O sinal deve ser declarado no pre√¢mbulo da arquitetura como um sinal de um bit. No come√ßo do &lt;code&gt;process&lt;/code&gt; (em qualquer lugar, i.e. ap√≥s o &lt;code&gt;begin&lt;/code&gt;), adicionamos a seguinte linha:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;simulando&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;E ao final do &lt;code&gt;process&lt;/code&gt; (antes do &lt;code&gt;wait&lt;/code&gt; incondicional), a seguinte:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;simulando&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Isso ir√° parar a gera√ß√£o do &lt;em&gt;clock&lt;/em&gt;, permitindo que o &lt;code&gt;wait&lt;/code&gt; incondicional pare o simulador. Este procedimento n√£o √© necess√°rio em todos os simuladores, mas √© necess√°rio em todos os que utilizamos nas aulas de gradua√ß√£o, portanto utilize-o.&lt;/p&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="testbench"></category></entry><entry><title>Arquitetura</title><link href="https://balbertini.github.io/vhdl_architecture-pt_BR.html" rel="alternate"></link><published>2018-10-04T20:45:55-03:00</published><updated>2020-09-23T08:41:56-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2018-10-04:/vhdl_architecture-pt_BR.html</id><summary type="html">&lt;p&gt;Arquiteturas em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;As descri√ß√µes em VHDL sempre possuem uma &lt;a href="https://balbertini.github.io/vhdl_entity-pt_BR.html"&gt;entidade&lt;/a&gt;, que define as interfaces do m√≥dulo descrito. Por√©m, a entidade n√£o descreve a funcionalidade, que √© descrita na arquitetura.&lt;/p&gt;
&lt;p&gt;Assim como a entidade √© a &lt;em&gt;cara&lt;/em&gt; do m√≥dulo que est√° descrevendo, a arquitetura, declarada pela palavra reservada &lt;code&gt;architecture&lt;/code&gt;, √© o &lt;em&gt;corpo&lt;/em&gt; da sua descri√ß√£o. Na arquitetura √© onde descrevemos a funcionalidade do componente, ou seja, onde as coisas realmente acontecem. No diagrama esquem√°tico, seria o equivalente de mostrar o que tem dentro do s√≠mbolo do seu componente.&lt;/p&gt;
&lt;p&gt;Faz sentido descrever um componente com entradas e sa√≠das mas sem nada dentro? Claro que n√£o, por isso toda entidade deve ter ao menos uma arquitetura pois, sem ela, o componente n√£o tem fun√ß√£o. √â poss√≠vel que uma entidade tenha varias arquiteturas, cada uma realizando a tarefa que seu componente se prop√µe a fazer de uma maneira diferente. Contudo, uma arquitetura s√≥ pode pertencer a uma entidade. De fato, todas as arquiteturas pertencentes a uma entidade devem estar no mesmo arquivo que ela, depois da declara√ß√£o da entidade.&lt;/p&gt;
&lt;p&gt;A sintaxe de uma arquitetura em VHDL √©:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;nome_da_arquitetura&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;nome_da_entidade&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="n"&gt;declaracoes&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="n"&gt;declaracoes_combinatorias&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;nome_da_arquitetura&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Onde &lt;code&gt;declaracoes&lt;/code&gt; √© a lista de elementos que ser√£o utilizados na sua arquitetura, como sinais e componentes. As &lt;code&gt;declaracoes_combinatorias&lt;/code&gt; s√£o todas as declara√ß√µes concorrentes desta descri√ß√£o, como uma atribui√ß√£o (condicional ou n√£o), uma inst√¢ncia de componente ou um &lt;code&gt;process&lt;/code&gt;. O &lt;code&gt;nome_da_arquitetura&lt;/code&gt; pode ser qualquer nome v√°lido em VHDL, e o &lt;code&gt;nome_da_entidade&lt;/code&gt; deve ser o nome da entidade que esta arquitetura descreve.&lt;/p&gt;
&lt;p&gt;Como uma entidade pode ter mais de uma arquitetura, √© comum termos um arquivo VHDL com v√°rias arquiteturas pertencentes a mesma entidade. Isso √© √∫til pois podemos ter o mesmo componente descrito de maneiras diferentes (e.g. otimizado para velocidade, consumo de energia ou √°rea, descrito especificamente para uma tecnologia (ASIC, FPGA, etc.), ou at√© mesmo com estilos de descri√ß√£o diferentes). N√£o h√° uma conven√ß√£o, mas se n√£o for utilizado nenhum mecanismo expl√≠cito para escolher uma das arquiteturas dispon√≠veis, a maioria dos softwares de s√≠ntese utiliza a √∫ltima arquitetura encontrada no arquivo.&lt;/p&gt;
&lt;h2&gt;Escolha expl√≠cita da arquitetura&lt;/h2&gt;
&lt;p&gt;A entidade, exceto se for uma entidade &lt;em&gt;toplevel&lt;/em&gt; (entidade m√°xima, que representa o circuito como um todo), sempre ser√° usada como componente por uma arquitetura pertencente a outra entidade. Na pr√°tica, isso significa que h√° uma entidade raiz, que representa o circuito todo e possui ao menos uma arquitetura. Nesta  arquitetura, outras entidades filhas podem usadas como componentes para formar o circuito. Cada entidade filha usada pode usar outras como componente e assim por diante, criando uma √°rvore.&lt;/p&gt;
&lt;p&gt;Considerando que o componente j√° foi declarado corretamente, h√° duas possibilidades de inst√¢ncia. Sem escolher qual arquitetura, a inst√¢ncia segue a seguinte sintaxe:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;nome_da_instancia&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
  &lt;span class="n"&gt;nome_da_entidade&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nome_da_arquitetura&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;atribuicao_de_parametros&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;atribuicao_de_portas&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Isto far√° com que o sintetizador escolha a √∫ltima arquitetura descrita (ou a que for configurada no sintetizador). Contudo, esta sintaxe existe pois, na maioria das vezes, as entidades s√≥ possuem uma arquitetura. Voc√™ pode fazer uma escolha expl√≠cita da arquitetura, pr√°tica recomendada caso a entidade possua mais de uma. Para isso, basta modificar a declara√ß√£o da inst√¢ncia para a sintaxe completa, como abaixo:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;nome_da_intancia&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
  &lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;work&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nome_da_entidade&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;nome_da_arquitetura&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;atribuicao_de_parametros&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;atribuicao_de_portas&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A palavra reservada &lt;code&gt;work&lt;/code&gt; faz refer√™ncia ao pacote de trabalho local, onde se encontram todas as entidades que foram desenvolvidas por voc√™ e n√£o foram colocadas em um pacote. Caso voc√™ tenha colocado sua entidade em um pacote ou esteja usando uma entidade que voc√™ n√£o fez e que est√° em um pacote, deve substituir &lt;code&gt;work&lt;/code&gt; pelo pacote onde a entidade se encontra. Algumas ferramentas de s√≠ntese exigem que voc√™ declare a utiliza√ß√£o da bilbioteca &lt;code&gt;work&lt;/code&gt; explicitamente colocando &lt;code&gt;use work.nome_da_entidade&lt;/code&gt; ou &lt;code&gt;use work.all&lt;/code&gt; no pre√¢mbulo do seu arquivo.&lt;/p&gt;
&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/mux2to1_arquitetura.png' width="39%" align="right" style="padding-left:5%" /&gt;&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;mux2to1&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;    &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="k"&gt;out&lt;/span&gt;   &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;mux2to1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;whenelse&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;mux2to1&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;whenelse&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;struct&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;mux2to1&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;struct&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Acima, vemos um componente com duas arquiteturas, representadas tanto na descri√ß√£o VHDL quanto na representa√ß√£o gr√°fica. Note que o componente possui uma entidade externa camada &lt;code&gt;mux2to1&lt;/code&gt;, que define as interfaces de entrada e sa√≠da. Por dentro, tem duas arquiteturas, que definem o comportamento do componente de duas maneiras distintas. Por padr√£o, se n√£o especificarmos explicitamente, o software de s√≠ntese ir√° considerar a √∫ltima arquitetura descrita como sendo a que ele deve utilizar, por isso ligamos as interfaces do desenho na arquitetura padr√£o.&lt;/p&gt;
&lt;p&gt;A arquitetura padr√£o nesse caso √© a √∫ltima descrita, chamada &lt;code&gt;struct&lt;/code&gt;, e descreve estruturalmente o multiplexador usando portas l√≥gicas. Note que o nome &lt;code&gt;struct&lt;/code&gt; n√£o √© uma palavra reservada e sim um identificador v√°lido em VHDL, portanto poderia ser qualquer outro. √â recomendado que o nome da arquitetura reflita o que foi feito, nesse caso uma descri√ß√£o estrutural. Podemos escolher a outra arquitetura se desejarmos, que √© chamada de &lt;code&gt;whenelse&lt;/code&gt;. Note que ambas fazem a mesma coisa, mas de maneiras diferentes.&lt;/p&gt;
&lt;p&gt;No exemplo abaixo, temos a descri√ß√£o de uma arquitetura pertencente a uma &lt;code&gt;entidade_mae&lt;/code&gt; que utiliza o multiplexador como componente tr√™s vezes. Na inst√¢ncia &lt;code&gt;mux1&lt;/code&gt; (linha 12), a arquitetura √© deixada a escolha do sintetizador, portanto ser√° a arquitetura &lt;code&gt;struct&lt;/code&gt;. Na inst√¢ncia &lt;code&gt;mux2&lt;/code&gt; (linha 13), a arquitetura utilizada ainda √© a struct, mas dessa vez instru√≠mos explicitamente o sintetizador a utiliz√°-la. Por √∫ltimo, na inst√¢ncia &lt;code&gt;mux3&lt;/code&gt; (linha 14) o projetista escolheu explicitamente a arquitetura &lt;code&gt;whenelse&lt;/code&gt;.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;architecture&lt;/span&gt; &lt;span class="nc"&gt;muxes&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="nc"&gt;entidade_mae&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;component&lt;/span&gt; &lt;span class="nc"&gt;mux2to1&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;    &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="k"&gt;out&lt;/span&gt;   &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;component&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;o1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;o2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;o3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="n"&gt;mux1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mux2to1&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;o1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;mux2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;work&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mux2to1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;struct&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;o2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;mux3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;work&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mux2to1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;whenelse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="k"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;o3&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;muxes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Lembre-se que esta √© a descri√ß√£o de um hardware, portanto as tr√™s inst√¢ncias s√£o tr√™s circuitos &lt;strong&gt;diferentes&lt;/strong&gt;, cada um com seu pr√≥prio arranjo de portas l√≥gicas. A diferen√ßa √© que o &lt;code&gt;mux1&lt;/code&gt; e o &lt;code&gt;mux2&lt;/code&gt; s√£o id√™nticos, ou seja, se voc√™ observar o circuito gerado, s√£o duas c√≥pias do mesmo circuito. O &lt;code&gt;mux3&lt;/code&gt;, apesar de ter mesma funcionalidade, √© diferente. Se voc√™ sintetizar o circuito acima para um circuito real em sil√≠cio, poder√° ver em um microsc√≥pio duas √°reas id√™nticas e uma diferente, todas recebendo as mesmas entradas e cada uma com sua pr√≥pria sa√≠da. &lt;strong&gt;Nota:&lt;/strong&gt; este par√°grafo √© uma simplifica√ß√£o did√°tica, se tiver conhecimento de s√≠ntese de ASICs e quiser saber mais detalhes do que acontece durante a s√≠ntese, me escreva.&lt;/p&gt;
&lt;p&gt;Quando a entidade possui diversas arquiteturas, se uma determinada arquitetura n√£o for escolhida por nenhuma inst√¢ncia, o sintetizador n√£o a considerar√°. Isso significa que n√£o ser√° gerado nenhum circuito para aquela arquitetura, portanto ter v√°rias arquiteturas n√£o significa que o circuito gerado ir√° gastar mais energia ou ocupar mais √°rea, pois s√≥ as arquiteturas utilizadas ser√£o de fato sintetizadas.&lt;/p&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="basic"></category></entry><entry><title>Entidade</title><link href="https://balbertini.github.io/vhdl_entity-pt_BR.html" rel="alternate"></link><published>2018-09-25T13:25:12-03:00</published><updated>2021-01-31T18:30:36-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2018-09-25:/vhdl_entity-pt_BR.html</id><summary type="html">&lt;p&gt;Entidades em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Toda descri√ß√£o em VHDL segue um padr√£o base de uma entidade e uma arquitetura. Neste artigo, explicarei como funciona a entidade.&lt;/p&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/vhdl_maqrefri.png' width="20%" align="left" style="padding-right:5%" /&gt;
A entidade, declarada pela palavra reservada &lt;code&gt;entity&lt;/code&gt;, √© a unidade b√°sica de descri√ß√£o de VHDL. O equivalente em um diagrama esquem√°tico √© o desenho que voc√™ faz para representar seu componente. Por exemplo, pense em uma m√°quina de vender refrigerantes em lata. Suponha que voc√™ (abstratamente), tenha que desenhar um s√≠mbolo para sua m√°quina. O meu s√≠mbolo seria como o da figura: entra dinheiro e sai latas.
&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;A sintaxe de uma entidade em VHDL √©:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;nome_da_entidade&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
   &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_elementos_genericos&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
   &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_portas&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;nome_da_entidade&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/entidade.png' width="20%" align="right" style="padding-left:5%" /&gt;
No caso do VHDL, a entidade segue o mesmo princ√≠pio que voc√™ pensou para definir as entradas e sa√≠das da m√°quina de refrigerantes, mas obviamente estamos descrevendo um circuito digital, ent√£o as entradas e sa√≠das s√£o digitais. A palavra reservada &lt;code&gt;generic&lt;/code&gt; √© opcional e n√£o ser√° explicada neste artigo. Na entidade, quem declara os sinais que s√£o usados para modelar as suas entradas e sa√≠das √© a palavra reservada &lt;code&gt;port&lt;/code&gt;. O &lt;code&gt;port&lt;/code&gt; tem a seguinte sintaxe: &lt;code&gt;port(lista_de_portas);&lt;/code&gt;, onde a &lt;code&gt;lista_de_portas&lt;/code&gt; deve ser as portas separadas por &lt;code&gt;;&lt;/code&gt;, como em &lt;code&gt;port(porta1; porta2; porta3);&lt;/code&gt;. Pode-se colocar quantas portas desejar na sua descri√ß√£o, separadas por ponto e v√≠rgula &lt;code&gt;;&lt;/code&gt;. Note que a √∫ltima porta declarada n√£o tem &lt;code&gt;;&lt;/code&gt; pois o par√™nteses &lt;code&gt;)&lt;/code&gt; fecha a declara√ß√£o. O √∫ltimo &lt;code&gt;;&lt;/code&gt; pertence √† declara√ß√£o do &lt;code&gt;port&lt;/code&gt; e n√£o √† uma porta espec√≠fica.&lt;/p&gt;
&lt;p&gt;Cada porta em VHDL deve ser descrita com o formato &lt;code&gt;nome: dire√ß√£o tipo&lt;/code&gt;. O nome pode ser o que voc√™ desejar, desde que seja um nome v√°lido em VHDL. O tipo da porta define qual tipo de dados ser√° utilizado para aquela porta e pode ser &lt;a href="https://balbertini.github.io/vhdl_datatypes-pt_BR.html"&gt;qualquer tipo suportado&lt;/a&gt;. Quanto a dire√ß√£o, h√° quatro dire√ß√µes poss√≠veis: &lt;code&gt;in&lt;/code&gt;, &lt;code&gt;out&lt;/code&gt;, &lt;code&gt;buffer&lt;/code&gt; ou &lt;code&gt;inout&lt;/code&gt;. O &lt;code&gt;in&lt;/code&gt; √© uma entrada e, como tal, s√≥ pode ser lida pelo seu componente. Analogamente, o &lt;code&gt;out&lt;/code&gt; indica uma sa√≠da, que s√≥ pode ser escrita pelo seu componente (note que &lt;strong&gt;n√£o&lt;/strong&gt; pode ser lida). As dire√ß√µes de sa√≠da &lt;code&gt;buffer&lt;/code&gt; e &lt;code&gt;inout&lt;/code&gt; devem ser evitados (o motivo est√° &lt;a href="#bufferEinout"&gt;no final do artigo&lt;/a&gt;).&lt;/p&gt;
&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/mux2x1_entidade.png' width="70%"/&gt;&lt;/p&gt;
&lt;p&gt;Vamos descrever um multiplexador como o da figura. A entidade chama-se &lt;code&gt;mux2to1&lt;/code&gt; e, na figura, est√° a esquerda. O equivalente em um diagrama esquem√°tico est√° a direita na figura. √â uma conven√ß√£o desenhar entradas a esquerda do componente, sa√≠das a direita e sinais de controle embaixo ou em cima. O tamanho, quando n√£o especificado, √© assumido em 1 bit (nesse caso os tamanhos foram especificados).&lt;/p&gt;
&lt;p&gt;O c√≥digo VHDL para esta entidade √©:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;mux2to1&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="k"&gt;in&lt;/span&gt;  &lt;span class="kt"&gt;bit&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;-- selection: 0=a, 1=b&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt;    &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;-- inputs&lt;/span&gt;
        &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;    &lt;span class="k"&gt;out&lt;/span&gt;   &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;-- output&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;mux2to1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h2&gt;Boas pr√°ticas ao definir a entidade&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Use um nome de entidade que indique o que ela faz.&lt;/li&gt;
&lt;li&gt;O nome do arquivo deve ser &lt;code&gt;&amp;lt;nome_da_entidade&amp;gt;.vhd&lt;/code&gt; (e.g. &lt;code&gt;mux2to1.vhd&lt;/code&gt;). Isso n√£o se refere ao VHDL mas sim √† algumas ferramentas de s√≠ntese que exigem este tipo de padroniza√ß√£o para encontrar sua entidade.&lt;/li&gt;
&lt;li&gt;Descreva primeiro os sinais de controle, depois as entradas e depois as sa√≠das. N√£o h√° nenhuma restri√ß√£o quando a isso, mas ficar√° mais f√°cil de associar sua entidade como um componente depois.&lt;/li&gt;
&lt;li&gt;Sua entidade √© a "cara" do seu componente. Capriche nos nomes das entradas e sa√≠das e descreva-as como se estivesse desenhando-as em um diagrama esquem√°tico.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;Uso do &lt;code&gt;begin&lt;/code&gt; e nome da entidade&lt;/h1&gt;
&lt;p&gt;√â poss√≠vel que uma entidade tenha um &lt;code&gt;begin&lt;/code&gt;. Dentro da entidade (ap√≥s o &lt;code&gt;begin&lt;/code&gt; e antes do &lt;code&gt;end&lt;/code&gt;) podemos colocar qualquer declara√ß√£o passiva, ou seja, que n√£o altera nenhum sinal (i.e. processos passivos, asser√ß√µes est√°ticas e chamadas de procedimentos passivas). A mais utilizada √© a asser√ß√£o, assim podemos fazer verifica√ß√µes est√°ticas sobre a utiliza√ß√£o da entidade.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;nome_da_entidade&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
   &lt;span class="k"&gt;generic&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_elementos_genericos&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
   &lt;span class="k"&gt;port&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_portas&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="n"&gt;verificacoes_estaticas&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nc"&gt;nome_da_entidade&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;p&gt;No exemplo a seguir colocamos uma asser√ß√£o na parte est√°tica da entidade para verificar se o registrador foi instanciado corretamente. Caso o registrador tenha um tamanho especificado menor que 2, a asser√ß√£o ir√° falhar e qualquer simula√ß√£o ou s√≠ntese ser√° interrompida com a mensagem especificada.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;reg_deslocamento&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
  &lt;span class="k"&gt;generic&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;natural&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(...);&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="k"&gt;assert&lt;/span&gt; &lt;span class="n"&gt;tamanho&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
  &lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Este registrador precisa ter tamanho m√≠nimo 2.&amp;quot;&lt;/span&gt;
  &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;failure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;entity&lt;/span&gt; &lt;span class="nc"&gt;reg_deslocamento&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;&lt;a name="bufferEinout"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;Sa√≠das com dire√ß√£o &lt;code&gt;buffer&lt;/code&gt; e &lt;code&gt;inout&lt;/code&gt;&lt;/h1&gt;
&lt;p&gt;Uma sa√≠da que pode ser lida √© especificada pelo tipo &lt;code&gt;buffer&lt;/code&gt;. Este tipo de porta √© considerada especial pois implica que o sintetizador vai colocar um elemento sequencial na sa√≠da (&lt;em&gt;latch&lt;/em&gt; ou &lt;em&gt;flip-flop&lt;/em&gt;), para fazer o papel de &lt;em&gt;buffer&lt;/em&gt;, registrando a sua sa√≠da para ela que possa ser lida. Se voc√™ utilizar o &lt;code&gt;buffer&lt;/code&gt;, seu circuito nunca ser√° combinat√≥rio. Quase todos os dispositivos de prototipa√ß√£o FPGA modernos suportam o &lt;code&gt;buffer&lt;/code&gt;, mas voc√™ pode aumentar um pouco a √°rea utilizada devido ao roteamento.&lt;/p&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/entidade.png' width="30%" align="right" style="padding-left:5%" /&gt;
Note que usando o &lt;code&gt;buffer&lt;/code&gt; voc√™ n√£o pode ler um valor que foi colocado na sa√≠da por um elemento externo ao seu, voc√™ apenas pode ler os valores que o seu pr√≥prio componente colocou na sa√≠da. Para ler o valor que um componente externo colocou na sua sa√≠da, existe o &lt;code&gt;inout&lt;/code&gt;, um tipo de porta diferente pois √© bidirecional: pode ser usada como entrada, quando voc√™ l√™ um sinal escrito por algo externo para dentro do seu componente, e pode ser usada como sa√≠da, quando voc√™ escreve o sinal de dentro do seu componente para que algo de fora leia. O &lt;code&gt;inout&lt;/code&gt; indica para o sintetizador que ele deve colocar um &lt;em&gt;buffer&lt;/em&gt; que suporte &lt;em&gt;tri-state&lt;/em&gt; na sua sa√≠da. Neste caso, voc√™ deve garantir que os elementos em VHDL que possam escrever ou ler fa√ßam isso de forma mutuamente exclusiva, para que o sintetizador possa inferir corretamente os sinais de controle do &lt;em&gt;buffer tri-state&lt;/em&gt;. Os dispositivos de prototipa√ß√£o FPGA modernos costumam possuir este tipo de &lt;em&gt;bufer&lt;/em&gt; somente nos pinos de sa√≠da do FPGA, o que deve aumentar bastante seu roteamento e, consequentemente, a √°rea do seu circuito.&lt;/p&gt;
&lt;p&gt;Resumindo, n√£o utilize &lt;code&gt;buffer&lt;/code&gt; nem &lt;code&gt;inout&lt;/code&gt; nas suas descri√ß√µes exceto se voc√™ quer mesmo os componente que ser√£o inferidos na sua descri√ß√£o. Recomendo &lt;strong&gt;fortemente&lt;/strong&gt; que aprendizes n√£o os utilizem. A maneira de contornar a restri√ß√£o de leitura de uma porta &lt;code&gt;out&lt;/code&gt; √© criar um sinal tempor√°rio, fazer o que voc√™ tem que fazer sobre este sinal e, no final da arquitetura, atribuir o sinal tempor√°rio √† sa√≠da que ele representa.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Nota:&lt;/strong&gt; se voc√™ √© meu aluno, n√£o utilize &lt;code&gt;buffer&lt;/code&gt; ou &lt;code&gt;inout&lt;/code&gt; somente com a inten√ß√£o de ler o valor na sa√≠da em hip√≥tese alguma.&lt;/p&gt;
&lt;h3&gt;Contribui√ß√µes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;24/set/2020: Arthur Lopes corrigiu o tamanho da sa√≠da do MUX do exemplo.&lt;/li&gt;
&lt;/ul&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="basic"></category></entry><entry><title>Tipos de Dados B√°sicos em VHDL</title><link href="https://balbertini.github.io/vhdl_datatypes-pt_BR.html" rel="alternate"></link><published>2018-09-15T13:01:58-03:00</published><updated>2021-01-31T18:30:36-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2018-09-15:/vhdl_datatypes-pt_BR.html</id><summary type="html">&lt;p&gt;Tipos de dados b√°sicos existentes em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;Um tipo de dado √© uma classifica√ß√£o do conjunto poss√≠vel de valores que determinado item pode assumir. VHDL √© uma linguagem fortemente tipada, o que significa que a escolha do tipo de dado para um sinal, vari√°vel ou constante √© de suma import√¢ncia pois, para converter de um tipo ao outro, devemos utilizar fun√ß√µes de convers√£o. Uma vantagem de se utilizar uma linguagem fortemente tipada √© que o sintetizador pode perceber a maioria dos erros cometidos pelos projetistas. Exemplos (todos erros que podem ser capturados em VHDL, mas dif√≠cil de detectar em outras linguagens): atribuir um grupo de sinais de 4 bits para um grupo de 8 bits; atribuir um grupo de bits sem representa√ß√£o num√©rica para um grupo de bits representando um inteiro.&lt;/p&gt;
&lt;p&gt;√â importante salientar que, apesar de usar um estilo program√°tico, a linguagem VHDL √© uma linguagem de descri√ß√£o de hardware, portanto no final da s√≠ntese todos os tipos assumem valores altos ou baixos. Os conceitos de tipos das linguagens de programa√ß√£o n√£o existem em nenhuma HDL e esse √© um dos erros mais comuns dos projetistas de hardware. Lembre-se: voc√™ n√£o est√° descrevendo um programa e sim um hardware.&lt;/p&gt;
&lt;p&gt;O tipo de dado implicitamente influencia na s√≠ntese do seu circuito. Neste artigo veremos os tipos de dados mais comuns em VHDL e como utiliz√°-los.&lt;/p&gt;
&lt;h1&gt;Tipos pr√©-definidos&lt;/h1&gt;
&lt;p&gt;Os tipos de VHDL s√£o definidos pelos padr√µes IEEE 1076 e IEEE 1164. S√£o divididos em escalares, vetores, enumerados e compostos. Todos os tipos pr√©-definidos est√£o na biblioteca &lt;code&gt;std.standard&lt;/code&gt;, que √© inclu√≠da implicitamente em todos os projetos de VHDL (n√£o √© necess√°rio inclu√≠-la).&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="right"&gt;Tipo&lt;/th&gt;
&lt;th align="center"&gt;Categoria&lt;/th&gt;
&lt;th align="center"&gt;Sintetiz√°vel?&lt;/th&gt;
&lt;th align="left"&gt;Valores&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;bit&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;enumerado&lt;/td&gt;
&lt;td align="center"&gt;Sim&lt;/td&gt;
&lt;td align="left"&gt;&lt;code&gt;0&lt;/code&gt; ou &lt;code&gt;1&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;boolean&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;enumerado&lt;/td&gt;
&lt;td align="center"&gt;Sim&lt;/td&gt;
&lt;td align="left"&gt;&lt;code&gt;FALSE&lt;/code&gt; ou &lt;code&gt;TRUE&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;real&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;escalar&lt;/td&gt;
&lt;td align="center"&gt;N√£o&lt;/td&gt;
&lt;td align="left"&gt;-1.0E38 a +1.0E38&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;character&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;enumerado&lt;/td&gt;
&lt;td align="center"&gt;N√£o&lt;/td&gt;
&lt;td align="left"&gt;ASCII&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;O tipo &lt;code&gt;bit&lt;/code&gt; √© o mais utilizado. O &lt;code&gt;boolean&lt;/code&gt; √© √∫til para tomadas de decis√£o, como por exemplo em condi√ß√µes para um &lt;code&gt;if-else&lt;/code&gt;. √â importante notar que h√° um mapeamento direto entre &lt;code&gt;FALSE&lt;/code&gt; e &lt;code&gt;0&lt;/code&gt;, e entre &lt;code&gt;TRUE&lt;/code&gt; e &lt;code&gt;1&lt;/code&gt;, portanto &lt;code&gt;FALSE&lt;/code&gt;&amp;lt;&lt;code&gt;TRUE&lt;/code&gt;.  O &lt;code&gt;real&lt;/code&gt; normalmente √© tratado como um n√∫mero de ponto flutuante de precis√£o dupla. O &lt;code&gt;character&lt;/code&gt; representa um grupo de 8 bits correspondentes aos 256 caracteres da tabela ASCII. Note que estes dois √∫ltimos &lt;strong&gt;n√£o s√£o sintetiz√°veis&lt;/strong&gt;, portanto n√£o devem ser utilizados como entradas ou sa√≠das dos m√≥dulos. Apesar de n√£o serem sintetiz√°veis, estes tipos s√£o √∫teis durante as simula√ß√µes.&lt;/p&gt;
&lt;p&gt;O tipo &lt;code&gt;integer&lt;/code&gt; tamb√©m √© bastante utilizado e possui dois subtipos padr√µes:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="right"&gt;Tipo&lt;/th&gt;
&lt;th align="center"&gt;Categoria&lt;/th&gt;
&lt;th align="center"&gt;Sintetiz√°vel?&lt;/th&gt;
&lt;th align="left"&gt;Valores&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;integer&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;escalar&lt;/td&gt;
&lt;td align="center"&gt;Sim&lt;/td&gt;
&lt;td align="left"&gt;-2147483647 a 2147483647&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;natural&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;escalar&lt;/td&gt;
&lt;td align="center"&gt;Sim&lt;/td&gt;
&lt;td align="left"&gt;0 a 2147483647&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;positive&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;escalar&lt;/td&gt;
&lt;td align="center"&gt;Sim&lt;/td&gt;
&lt;td align="left"&gt;1 a 2147483647&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;A especifica√ß√£o da linguagem demanda que no m√≠nimo os n√∫meros da tabela sejam aceitos, mas n√£o limita o n√∫mero de bits do inteiro. Grande parte das ferramentas implementam o inteiro como um mapeamento direto para o inteiro de 32 bits, presente na maioria das plataformas. A forma de interpreta√ß√£o tamb√©m n√£o √© definida, mas a maioria das ferramentas interpreta como uma representa√ß√£o em complemento de dois. Os tipos &lt;code&gt;natural&lt;/code&gt; e &lt;code&gt;positive&lt;/code&gt; s√£o apenas limita√ß√µes nos valores que um objeto deste tipo poder√° assumir. √â poss√≠vel declarar inteiros com uma limita√ß√£o personalizada:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;meusinal&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;integer&lt;/span&gt; &lt;span class="k"&gt;range&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="k"&gt;to&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O trecho acima declara o &lt;code&gt;meusinal&lt;/code&gt; como um inteiro de 4 bits. Contudo, valores maiores que a implementa√ß√£o da ferramenta de s√≠ntese n√£o s√£o poss√≠veis, portanto se voc√™ precisar de um inteiro maior que 32 bits, verifique se sua ferramenta suporta inteiros grandes ou utilize vetores. A utiliza√ß√£o da limita√ß√£o do inteiro (com &lt;code&gt;range&lt;/code&gt; ou usando os subtipos &lt;code&gt;natural&lt;/code&gt; e &lt;code&gt;positive&lt;/code&gt;) ajuda na detec√ß√£o de erros pois, se em algum momento da simula√ß√£o for feita a tentativa de atribuir um valor fora da faixa permitida, o simulador ir√° emitir uma mensagem de erro. Al√©m disso, usar a limita√ß√£o expl√≠cita diminui o n√∫mero de bits utilizados para a representa√ß√£o, o que economizar√° portas l√≥gicas no seu circuito. Pense assim: por que voc√™ precisa de um somador de 32 bits se seus inteiros s√≥ v√£o assumir valores de -16 a 15?&lt;/p&gt;
&lt;p&gt;Os tipos &lt;code&gt;bit&lt;/code&gt; e &lt;code&gt;character&lt;/code&gt; tamb√©m possuem suas vers√µes em vetores:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="right"&gt;Tipo&lt;/th&gt;
&lt;th align="center"&gt;Categoria&lt;/th&gt;
&lt;th align="center"&gt;Sintetiz√°vel?&lt;/th&gt;
&lt;th align="left"&gt;Valores&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;bit_vector&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;vetor&lt;/td&gt;
&lt;td align="center"&gt;Sim&lt;/td&gt;
&lt;td align="left"&gt;bits&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;string&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;vetor&lt;/td&gt;
&lt;td align="center"&gt;N√£o&lt;/td&gt;
&lt;td align="left"&gt;caracteres&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;O &lt;code&gt;bit_vector&lt;/code&gt; √© muito utilizado para representar um grupo de bits. J√° o tipo &lt;code&gt;string&lt;/code&gt; √© usado somente para mensagens durante a simula√ß√£o (note que ele n√£o √© sintetiz√°vel).&lt;/p&gt;
&lt;p&gt;H√° ainda dois tipos que n√£o s√£o sintetiz√°veis mas s√£o importantes em VHDL:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="right"&gt;Tipo&lt;/th&gt;
&lt;th align="center"&gt;Categoria&lt;/th&gt;
&lt;th align="center"&gt;Sintetiz√°vel?&lt;/th&gt;
&lt;th align="left"&gt;Valores&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;severity_level&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;enumerado&lt;/td&gt;
&lt;td align="center"&gt;N√£o&lt;/td&gt;
&lt;td align="left"&gt;&lt;code&gt;note&lt;/code&gt;, &lt;code&gt;warning&lt;/code&gt;, &lt;code&gt;error&lt;/code&gt; ou &lt;code&gt;failure&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;time&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;enumerado&lt;/td&gt;
&lt;td align="center"&gt;N√£o&lt;/td&gt;
&lt;td align="left"&gt;depende&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;O tipo &lt;code&gt;severity_level&lt;/code&gt; √© usado em &lt;em&gt;testbenchs&lt;/em&gt; para informar a gravidade do problema encontrado. O tipo &lt;code&gt;time&lt;/code&gt; √© usado para descrever a temporiza√ß√£o do circuito, tanto em descri√ß√µes temporizadas quanto em &lt;em&gt;testbenchs&lt;/em&gt;. Os valores de tempo s√£o acompanhados dos multiplicadores que indicam a escala de tempo: &lt;code&gt;fs&lt;/code&gt; (fentosegundos), &lt;code&gt;ps&lt;/code&gt; (picosegungos), &lt;code&gt;ns&lt;/code&gt; (nanosegundos), &lt;code&gt;us&lt;/code&gt; (microsegundos), &lt;code&gt;ms&lt;/code&gt; (milisegundos), &lt;code&gt;sec&lt;/code&gt; (segundos), &lt;code&gt;min&lt;/code&gt; (minutos) e &lt;code&gt;hr&lt;/code&gt; (horas).&lt;/p&gt;
&lt;p&gt;No exemplo abaixo, a mensagem "Teste" ser√° impressa na tela sem parar a simula√ß√£o e o &lt;code&gt;sinal&lt;/code&gt; assumir√° o valor &lt;code&gt;entrada&lt;/code&gt;, mas somente ap√≥s 10ns.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;report&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Teste&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;severity&lt;/span&gt; &lt;span class="n"&gt;note&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;sinal&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;entrada&lt;/span&gt; &lt;span class="k"&gt;after&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="n"&gt;ns&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h1&gt;Pacote IEEE 1164&lt;/h1&gt;
&lt;p&gt;Um dos pacotes mais utilizados em VHDL √© o &lt;code&gt;std_logic_1164&lt;/code&gt; da biblioteca &lt;code&gt;ieee&lt;/code&gt;, que define um MVL (l√≥gica multivariada, ou o nome completo &lt;em&gt;Multivalue Logic System for VHDL Model Interoperability&lt;/em&gt;). Pra usar este pacote, √© necess√°rio incluir a declara√ß√£o de uso no preambulo do seu projeto:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;library&lt;/span&gt; &lt;span class="nn"&gt;ieee&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt; &lt;span class="nn"&gt;ieee.std_logic_1164.&lt;/span&gt;&lt;span class="k"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O tipo de dado prim√°rio definido nesta biblioteca √© o &lt;code&gt;std_ulogic&lt;/code&gt; (&lt;em&gt;standard unresolved logic&lt;/em&gt;), que pode assumir outros valores usados em projeto digital al√©m dos valores ideais &lt;code&gt;0&lt;/code&gt; e &lt;code&gt;1&lt;/code&gt;. Esta modelagem de valores √© mais pr√≥xima do mundo real, mas deve ser utilizada com cuidado.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="right"&gt;Valor&lt;/th&gt;
&lt;th align="center"&gt;Significado&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;U&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;N√£o inicializado (&lt;em&gt;uninitialized&lt;/em&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;X&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;Desconhecido (forte)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;0&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;Zero (forte)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;1&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;Um (forte)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;Z&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;Alta imped√¢ncia (&lt;em&gt;tri-state&lt;/em&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;W&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;Desconhecido (fraco)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;L&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;Zero (fraco)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;H&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;Um (fraco)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;-&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;Qualquer um (&lt;em&gt;don't care&lt;/em&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;O valor &lt;code&gt;U&lt;/code&gt; n√£o foi pensado para ser utilizado pelo projetista mas sim pelas ferramentas de simula√ß√£o. Quando seu circuito √© simulado, um sinal em &lt;code&gt;U&lt;/code&gt; significa que at√© aquele momento n√£o houve nenhuma atribui√ß√£o para aquele sinal. Isso √© √∫til para depura√ß√£o pois permite diferenciar um sinal que nunca foi atribu√≠do de um que foi atribu√≠do com zero, por exemplo. √â especialmente √∫til para detectar o esquecimento do acionamento do &lt;em&gt;reset&lt;/em&gt; de um circuito, pois √© comum os projetistas negligenciarem o &lt;em&gt;reset&lt;/em&gt; antes de come√ßar a simular.&lt;/p&gt;
&lt;p&gt;J√° o &lt;code&gt;X&lt;/code&gt; e o &lt;code&gt;W&lt;/code&gt; indicam valores que est√£o fora do escopo naquele ponto do projeto. Atribuir o valor &lt;code&gt;X&lt;/code&gt; para um sinal n√£o √© uma boa pr√°tica, mas ele tamb√©m √© √∫til em uma simula√ß√£o. Quando aparecer um sinal com valor &lt;code&gt;X&lt;/code&gt; ou &lt;code&gt;W&lt;/code&gt; na sua simula√ß√£o, muito provavelmente houve mais de uma atribui√ß√£o para o mesmo sinal e elas s√£o divergentes (e.g. uma atribui√ß√£o &lt;code&gt;0&lt;/code&gt; e uma &lt;code&gt;1&lt;/code&gt; em pontos diferentes da sua descri√ß√£o). Se sua simula√ß√£o tem um destes valores, corrija o seu circuito antes de sintetiz√°-lo  pois este valor n√£o existe no mundo real: o circuito vai efetivamente assumir &lt;code&gt;1&lt;/code&gt; ou &lt;code&gt;0&lt;/code&gt;, fechando um curto-circuito caso haja uma atribui√ß√£o divergente.&lt;/p&gt;
&lt;p&gt;Note tamb√©m que o &lt;code&gt;X&lt;/code&gt; &lt;strong&gt;n√£o representa&lt;/strong&gt; o &lt;em&gt;don't care&lt;/em&gt; mas sim um valor desconhecido. Como a letra X √© utilizada para o &lt;em&gt;don't care&lt;/em&gt; nos m√©todos manuais (e.g. mapa de Karnaugh), √© comum a confus√£o entre os dois valores.&lt;/p&gt;
&lt;p&gt;A diferen√ßa entre um valor &lt;em&gt;forte&lt;/em&gt; e &lt;em&gt;fraco&lt;/em&gt; √© apenas que os fracos indicam a utiliza√ß√£o de resistores de &lt;em&gt;pull-up&lt;/em&gt; ou &lt;em&gt;pull-down&lt;/em&gt;, portanto se uma sa√≠da &lt;code&gt;H&lt;/code&gt; for ligada a uma sa√≠da &lt;code&gt;0&lt;/code&gt;, o sinal ser√° &lt;code&gt;0&lt;/code&gt; e n√£o h√° problemas al√©m do consumo de energia extra ocasionado pelo resistor. Contudo, se uma sa√≠da forte &lt;code&gt;1&lt;/code&gt; for ligada a uma sa√≠da &lt;code&gt;0&lt;/code&gt;, o resultado √© um curto-circuito e poss√≠vel dano ao circuito. Voc√™ pode livremente atribuir &lt;code&gt;H&lt;/code&gt;, &lt;code&gt;1&lt;/code&gt;, &lt;code&gt;L&lt;/code&gt; ou &lt;code&gt;0&lt;/code&gt; para um sinal, e ambos ser√£o sintetizados similarmente, mas as vers√µes &lt;code&gt;H&lt;/code&gt; e &lt;code&gt;L&lt;/code&gt; instruem o sintetizador a usar portas com tecnologia de dreno aberto (&lt;em&gt;open-drain&lt;/em&gt;) ou similar, permitindo a utiliza√ß√£o de resistores de &lt;em&gt;pull-up&lt;/em&gt; ou &lt;em&gt;pull-down&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Se a plataforma alvo n√£o suportar buffers &lt;em&gt;tri-state&lt;/em&gt; o valor &lt;code&gt;Z&lt;/code&gt; n√£o ser√° sintetizado, mas as ferramentas normalmente conseguem inferir um decisor baseado em multiplexador para substituir a escolha de qual sa√≠da ser√° colocada no sinal. Note que a plataforma alvo pode n√£o ter &lt;em&gt;tri-state&lt;/em&gt;, ent√£o tome cuidado ao interlig√°-la com circuitos externos que esperam que ela tenha.&lt;/p&gt;
&lt;p&gt;Outro tipo desta biblioteca √© o &lt;code&gt;std_logic&lt;/code&gt;. Ele √© id√™ntico ao &lt;code&gt;std_ulogic&lt;/code&gt; e pode assumir qualquer valor dos citados acima, mas tem uma diferen√ßa aos olhos do sintetizador: ele pode ser resolvido. O &lt;code&gt;std_ulogic&lt;/code&gt; n√£o especifica o que acontece quando voc√™ faz duas atribui√ß√µes para o mesmo sinal (n√£o importa se diferente ou iguais). Se o sinal for &lt;code&gt;std_logic&lt;/code&gt;, o sintetizador entende que voc√™ sabe o que est√° fazendo e n√£o te indicar√° nada ou no m√°ximo mostrar√° uma mensagem de alerta, enquanto se o sinal for do tipo &lt;code&gt;std_ulogic&lt;/code&gt;, o sintetizador ir√° se recusar a continuar a s√≠ntese, alertando-o que h√° mais de uma atribui√ß√£o para aquele sinal.&lt;/p&gt;
&lt;p&gt;Ambos os tipos desta biblioteca suportam a vers√£o em vetor:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="right"&gt;Tipo&lt;/th&gt;
&lt;th align="center"&gt;Categoria&lt;/th&gt;
&lt;th align="center"&gt;Sintetiz√°vel?&lt;/th&gt;
&lt;th align="left"&gt;Valores&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;std_ulogic&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;enumerado&lt;/td&gt;
&lt;td align="center"&gt;Sim&lt;/td&gt;
&lt;td align="left"&gt;multivariado&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;std_logic&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;enumerado&lt;/td&gt;
&lt;td align="center"&gt;Sim&lt;/td&gt;
&lt;td align="left"&gt;multivariado&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;std_ulogic_vector&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;vetor&lt;/td&gt;
&lt;td align="center"&gt;Sim&lt;/td&gt;
&lt;td align="left"&gt;&lt;code&gt;std_ulogic&lt;/code&gt;s&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;std_logic_vector&lt;/code&gt;&lt;/td&gt;
&lt;td align="center"&gt;vetor&lt;/td&gt;
&lt;td align="center"&gt;Sim&lt;/td&gt;
&lt;td align="left"&gt;&lt;code&gt;std_logic&lt;/code&gt;s&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Os valores multivariados s√£o qualquer um da tabela no in√≠cio desta se√ß√£o. A s√≠ntese √© poss√≠vel para estes tipos, mas esteja atento para as observa√ß√µes nesta se√ß√£o quando eles forem diferentes de &lt;code&gt;0&lt;/code&gt; ou &lt;code&gt;1&lt;/code&gt;.&lt;/p&gt;
&lt;h1&gt;Qual tipo utilizar?&lt;/h1&gt;
&lt;p&gt;N√£o existe uma regra de que tipo utilizar, mas h√° v√°rias dicas de como utilizar melhor a infraestrutura de tipos em VHDL.&lt;/p&gt;
&lt;p&gt;A primeira dica √© usar o bom senso. Se voc√™ est√° projetando uma unidade aritm√©tica (e.g. multiplicador), faz pleno sentido que as entradas e sa√≠das sejam &lt;code&gt;unsigned&lt;/code&gt; ou &lt;code&gt;signed&lt;/code&gt; de acordo com a maneira como a unidade aritm√©tica as interpreta (e.g. o multiplicador √© de inteiros sem ou com sinal). Contudo, se voc√™ est√° projetando um multiplexador, n√£o faz sentido usar um tipo de dados com interpreta√ß√£o embutida pois o multiplexador n√£o opera sobre os dados. Nesse caso, utilize o tipo &lt;code&gt;bit&lt;/code&gt; ou &lt;code&gt;std_logic&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;&lt;code&gt;std_logic&lt;/code&gt; ou &lt;code&gt;bit&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Este √© um tema de debate entre os projetistas h√° anos. A maioria dos projetistas opta por utilizar o &lt;code&gt;std_logic&lt;/code&gt; e evitar aborrecimentos, mas esta n√£o √© uma boa pr√°tica. Para escolher corretamente, voc√™ precisa pensar no circuito que est√° desenvolvendo e na arquitetura alvo.&lt;/p&gt;
&lt;p&gt;O FPGA, por exemplo, n√£o suporta internamente nenhum dos tipos do &lt;code&gt;std_logic&lt;/code&gt;, portanto n√£o faz sentido utiliz√°-lo pois internamente s√≥ haver√° bits. Se sua arquitetura alvo √© um FPGA, como por exemplo nas disciplinas de laborat√≥rio, use sempre o tipo &lt;code&gt;bit&lt;/code&gt;. As excess√µes onde a utiliza√ß√£o do &lt;code&gt;std_logic&lt;/code&gt; √© correta s√£o: (i) quando voc√™ estiver projetando um barramento, (ii) quando estiver lidando com a sa√≠da, e (iii) em simula√ß√µes.&lt;/p&gt;
&lt;p&gt;No caso (i) a utiliza√ß√£o do &lt;em&gt;tri-state&lt;/em&gt; pode ser √∫til pois voc√™ poder√° interligar sa√≠das sem problemas, desde que somente uma delas esteja ativa e as demais estejam em &lt;em&gt;tri-state&lt;/em&gt;. Contudo, se o seu barramento for interno ao FPGA, ele ser√° sintetizado usando multiplexadores e n√£o &lt;em&gt;tri-state&lt;/em&gt; real pois o FPGA n√£o tem esta funcionalidade internamente. Lembre-se que o &lt;em&gt;tri-state&lt;/em&gt; do &lt;code&gt;std_logic&lt;/code&gt; √© representado por &lt;code&gt;Z&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;J√° no caso (ii) voc√™ pode utilizar o &lt;code&gt;std_logic&lt;/code&gt; livremente pois a maioria dos FPGAs implementa &lt;em&gt;open-drain&lt;/em&gt; e &lt;em&gt;tri-state&lt;/em&gt; nos buffers de sa√≠da. Voc√™ pode facilmente usar &lt;em&gt;tri-state&lt;/em&gt; e valores de &lt;em&gt;weak&lt;/em&gt; (que implementam &lt;em&gt;pull-up&lt;/em&gt; e &lt;em&gt;pull-down&lt;/em&gt;), mas lembre-se que nem todos os valores do &lt;code&gt;std_logic&lt;/code&gt; s√£o sintetiz√°veis.&lt;/p&gt;
&lt;p&gt;No √∫ltimo caso (iii), o valor &lt;code&gt;U&lt;/code&gt; (&lt;em&gt;uninitialized&lt;/em&gt;) pode ser √∫til para saber se um determinado valor foi ou n√£o escrito alguma vez durante a simula√ß√£o pois √© o valor padr√£o do &lt;code&gt;std_logic&lt;/code&gt;. Na simula√ß√£o todos os valores do &lt;code&gt;std_logic&lt;/code&gt; s√£o expressos corretamente, mas lembre-se que na s√≠ntese os valores sempre v√£o assumir &lt;code&gt;0&lt;/code&gt; ou &lt;code&gt;1&lt;/code&gt; mesmo que nunca tenham tido um valor atribu√≠do.&lt;/p&gt;
&lt;p&gt;Uma das fal√°cias do tipo &lt;code&gt;std_logic&lt;/code&gt; √© o &lt;em&gt;don't care&lt;/em&gt;. Ele √© representado pelo &lt;code&gt;-&lt;/code&gt; e n√£o pelo &lt;code&gt;X&lt;/code&gt; (&lt;em&gt;unknown&lt;/em&gt;) normalmente usado nos m√©todos manuais (e.g mapa de Karnaugh). Se usado corretamente, a maioria das ferramentas interpreta o &lt;code&gt;-&lt;/code&gt; como o &lt;em&gt;don't care&lt;/em&gt; esperado, inclusive na atribui√ß√£o condicional. Algumas ferramentas tratam ambos os &lt;code&gt;X&lt;/code&gt; e o &lt;code&gt;-&lt;/code&gt; como &lt;em&gt;don't care&lt;/em&gt; para evitar a confus√£o, mas ela ainda acontece especialmente entre projetistas iniciantes, portanto evite-o.&lt;/p&gt;
&lt;p&gt;De fato, a maioria dos projetos n√£o necessita do &lt;code&gt;std_logic&lt;/code&gt; e acabam por utiliz√°-lo apenas com os valores &lt;code&gt;0&lt;/code&gt; ou &lt;code&gt;1&lt;/code&gt;, como substitui√ß√£o ao tipo &lt;code&gt;bit&lt;/code&gt;. Como regra geral, utilize o tipo de dado certo para o trabalho que est√° fazendo e, enquanto voc√™ estiver aprendendo, utilize somente o tipo &lt;code&gt;bit&lt;/code&gt; para evitar problemas. Quando estiver confort√°vel, transicione para o tipo &lt;code&gt;std_ulogic&lt;/code&gt; quando precisar de sinais multivariados e s√≥ quando realmente precisar de um sinal de multivariado com m√∫ltiplas atribui√ß√µes (e.g. barramento) use o &lt;code&gt;std_logic&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;Contribui√ß√µes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;19/set/2020: Gabriel Youssef Campos fez algumas corre√ß√µes sint√°ticas.&lt;/li&gt;
&lt;li&gt;22/nov/2020: Lucas Ventura Monegatto alterou os limites do inteiro.&lt;/li&gt;
&lt;/ul&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="tipos"></category></entry><entry><title>M√°quina virtual com GHDL</title><link href="https://balbertini.github.io/vhdl_vmghdl-pt_BR.html" rel="alternate"></link><published>2018-09-13T22:22:27-03:00</published><updated>2020-02-14T13:33:01-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2018-09-13:/vhdl_vmghdl-pt_BR.html</id><summary type="html">&lt;p&gt;Como utilizar a VM com GHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;O GHDL √© um simulador de VHDL que gera c√≥digo nativo, o que significa que as simula√ß√µes s√£o muito r√°pidas. Contudo, foi escrito em ADA, uma linguagem na imin√™ncia de ser considerada ex√≥tica. Como v√°rios professores de Sistemas Digitais usam este software para corrigir os exerc√≠cios dados nas disciplinas te√≥ricas, mantemos uma m√°quina virtual com uma vers√£o recente do GHDL instalada, que tamb√©m compartilhamos com os alunos. Neste artigo, mostrarei como usar uma VM que cont√©m o &lt;a href="http://ghdl.free.fr/"&gt;GHDL&lt;/a&gt; para simular e testar funcionalmente sua descri√ß√£o VHDL.&lt;/p&gt;
&lt;p&gt;H√° tamb√©m uma grava√ß√£o de uma Live dispon√≠vel no YouTube.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://youtu.be/PEaDYHk8CBc"&gt;Link para o tutorial no YouTube&lt;/a&gt;&lt;/p&gt;
&lt;h1&gt;Preparando o ambiente&lt;/h1&gt;
&lt;p&gt;Comece fazendo download da m√°quina virtual clicando nos links abaixo:&lt;/p&gt;
&lt;p&gt;Vers√£o atualizada, ligeiramente diferente do tutorial:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://drive.google.com/file/d/1FWxiqSNX6iPKouRYjEhJapvXQrdRMHhL" target="_blank"&gt;&lt;i style="font-size: 1em;" class="fas fa-download"&gt;&lt;/i&gt; GHDL_2020.ova&lt;/a&gt;  &lt;/li&gt;
&lt;li&gt;&lt;a href="https://drive.google.com/file/d/1UhiNQtl6ekwnnUDQc2Ztlrxc90uenr7O" target="_blank"&gt;&lt;i style="font-size: 1em;" class="fas fa-download"&gt;&lt;/i&gt; GHDL_2020.ova.md5sum&lt;/a&gt;  &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Vers√£o antiga, id√™ntica a usada no tutorial:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://drive.google.com/file/d/1_KPXSVHjk3UmFIFHAbIfzLdwWwrXGmHQ" target="_blank"&gt;&lt;i style="font-size: 1em;" class="fas fa-download"&gt;&lt;/i&gt; GHDL.ova&lt;/a&gt;  &lt;/li&gt;
&lt;li&gt;&lt;a href="https://drive.google.com/file/d/1wqwmZvWUJHamL2AnWSRm3D2B2eI7pi2f" target="_blank"&gt;&lt;i style="font-size: 1em;" class="fas fa-download"&gt;&lt;/i&gt; GHDL.ova.md5sum&lt;/a&gt;  &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;O arquivo md5sum possui o hash MD5 do arquivo e n√£o precisa ser baixado. Aconselha-se que baixe-o e verifique se o arquivo &lt;code&gt;GHDL.ova&lt;/code&gt; que voc√™ baixou possui o mesmo hash contido no arquivo &lt;code&gt;GHDL.ova.md5sum&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;A m√°quina atualizada pode possuir algumas diferen√ßas nas telas em rela√ß√£o a utilizada no tutorial, por√©m √© f√°cil seguir o tutorial mesmo com a m√°quina atualizada.&lt;/p&gt;
&lt;p&gt;A m√°quina est√° no formato &lt;em&gt;Open Virtual Appliance&lt;/em&gt;, portanto voc√™ tamb√©m precisar√° de um software de virtualiza√ß√£o compat√≠vel com sua m√°quina e com o formato OVF 2.0 (&lt;em&gt;Open Virtualization Format&lt;/em&gt;). Este artigo usar√° o &lt;a href="https://www.virtualbox.org/"&gt;VirtualBox&lt;/a&gt; como software de virtualiza√ß√£o.&lt;/p&gt;
&lt;h1&gt;Preparando a m√°quina virtual&lt;/h1&gt;
&lt;p&gt;Abra o arquivo &lt;code&gt;GHDL.ova&lt;/code&gt; com o seu software de virtualiza√ß√£o (e.g. clique duas vezes, v√° em &lt;code&gt;Arquivo/Importar Appliance&lt;/code&gt;, etc).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Adicionando a VM" src="https://balbertini.github.io/images/vhdl/vmghdl1.png"&gt;&lt;/p&gt;
&lt;p&gt;N√£o √© necess√°rio mudar nenhum par√¢metro da VM neste momento. Opcionalmente desligue os itens que n√£o pretende utilizar, como por exemplo o controlador USB ou a placa de som. N√£o desabilite a placa de rede pois iremos utiliz√°-la para acessar a m√°quina. Quando estiver satisfeito, clique no bot√£o &lt;code&gt;Importar&lt;/code&gt; finalize a importa√ß√£o da m√°quina.&lt;/p&gt;
&lt;p&gt;Com a importa√ß√£o finalizada, a VM deve aparecer na sua lista de VMs. Com a VM selecionada, v√° em &lt;code&gt;M√°quina/Configura√ß√µes&lt;/code&gt; ou clique com o bot√£o direito dobre a m√°quina e escolha &lt;code&gt;Configura√ß√µes&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Configurando a VM" src="https://balbertini.github.io/images/vhdl/vmghdl2.png"&gt;&lt;/p&gt;
&lt;p&gt;Na caixa que abrir√°, selecione &lt;code&gt;Rede&lt;/code&gt;, expanda a aba &lt;code&gt;Avan√ßado&lt;/code&gt; e clique no bot√£o &lt;code&gt;Redirecionamento de Portas&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Redirecionamento de portas" src="https://balbertini.github.io/images/vhdl/vmghdl3.png"&gt;&lt;/p&gt;
&lt;p&gt;Na tela que se abrir√°, voc√™ deve ver uma regra pr√©-carregada. Confira os dados ou caso n√£o veja nenhuma regra, clique no bot√£o de adicionar uma nova regra e adicione o seguinte:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Nome&lt;/code&gt;: qualquer um, no exemplo usarei "SSH"&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Protocolo&lt;/code&gt;: TCP&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Endere√ßo IP do Hospedeiro&lt;/code&gt;: deixar em branco&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Porta do Hospedeiro&lt;/code&gt;: qualquer uma alta, no exemplo usei 5022&lt;/li&gt;
&lt;li&gt;&lt;code&gt;IP do Convidado&lt;/code&gt;: deixar em branco&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Porta do Convidado&lt;/code&gt;: 22&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Regra de redirecionamento" src="https://balbertini.github.io/images/vhdl/vmghdl4.png"&gt;&lt;/p&gt;
&lt;p&gt;Note que a imagem n√£o mostra todos os campos. Configure todos como na lista acima. Aqui terminamos com a rede. Clique no OK e volte para a tela de configura√ß√£o da m√°quina virtual. Dessa vez v√° para aba &lt;code&gt;Pastas Compartilhadas&lt;/code&gt; e use o bot√£o para adicionar uma nova pasta.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Regra de redirecionamento" src="https://balbertini.github.io/images/vhdl/vmghdl5.png"&gt;&lt;/p&gt;
&lt;p&gt;No campo &lt;code&gt;Caminho da Pasta&lt;/code&gt;, escolha uma pasta qualquer da sua m√°quina. No campo &lt;code&gt;Nome da Pasta&lt;/code&gt;, coloque o nome que desejar (neste exemplo usei &lt;em&gt;VMShared&lt;/em&gt;). O &lt;code&gt;Caminho da Pasta&lt;/code&gt; √© a pasta na sua m√°quina real (host) e o &lt;code&gt;Nome da Pasta&lt;/code&gt; √© o nome do compartilhamento. A pasta que voc√™ escolher em &lt;code&gt;Caminho da Pasta&lt;/code&gt; ser√° compartilhada com a m√°quina virtual na montagem da pasta compartilhada, portanto escolha uma pasta onde vai colocar os arquivos. Resumo: a pasta que voc√™ escolher em &lt;code&gt;Caminho da Pasta&lt;/code&gt; ser√° exatamente a mesma dentro da m√°quina virtual: o que voc√™ colocar/editar em uma aparece na outra e vice-versa.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Regra de redirecionamento" src="https://balbertini.github.io/images/vhdl/vmghdl6.png"&gt;&lt;/p&gt;
&lt;p&gt;Finalizamos a configura√ß√£o da VM. Clique no OK at√© voltar para a tela do software de virtualiza√ß√£o.&lt;/p&gt;
&lt;h1&gt;Iniciando a m√°quina virtual&lt;/h1&gt;
&lt;p&gt;Antes de come√ßar, leia esta se√ß√£o toda, caso contr√°rio voc√™ poder√° ficar com o mouse e teclado capturados pela m√°quina virtual. Com a m√°quina selecionada na tela principal do software de virtualiza√ß√£o, clique no bot√£o &lt;code&gt;Iniciar&lt;/code&gt; (bot√£o com seta verde). A m√°quina ir√° iniciar e voc√™ ver√° uma tela preta com o &lt;em&gt;prompt&lt;/em&gt; de login. Esta tela √© como se fosse a tela de outro computador, com a diferen√ßa que ele √© virtual.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Prompt de login" src="https://balbertini.github.io/images/vhdl/vmghdl7.png"&gt;&lt;/p&gt;
&lt;p&gt;Dependendo da configura√ß√£o da sua m√°quina, a tela inicial estar√° toda preta; nesse caso, pressione qualquer tecla (e.g. enter) para habilitar o &lt;em&gt;prompt&lt;/em&gt; de login. Se desejar logar na m√°quina, clique na tela e utilize o usu√°rio padr√£o e a senha padr√£o, que √© &lt;code&gt;poli&lt;/code&gt; para ambos. Contudo, esta m√°quina n√£o tem interface gr√°fica para ficar mais r√°pida e diminuir o tamanho do download (voc√™ pode instalar se desejar, mas o tamanho da m√°quina aumentar√° consideravelmente). Se voc√™ est√° confort√°vel com sistemas em modo texto, pule a pr√≥xima se√ß√£o e utilize esta tela para o restante deste artigo, caso contr√°rio a pr√≥xima se√ß√£o mostrar√° como logar via SSH. Caso voc√™ esteja com o mouse ou apontador presona sua m√°quina virtual, veja a tecla de desabilitar a captura do mouse e teclado no canto direito inferior da m√°quina (no exemplo √© Left &amp;#8984;). Pressione essa tecla por 2s e solte. Seu mouse e teclado agora devem ser devolvidos para a sua m√°quina.&lt;/p&gt;
&lt;h1&gt;Acessando a m√°quina virtual por SSH&lt;/h1&gt;
&lt;p&gt;Uma forma mais f√°cil de acessar a m√°quina √© logar via SSH, pois assim voc√™ pode aproveitar todos os benef√≠cios da sua pr√≥pria m√°quina, como interface gr√°fica e editores modernos, usando o SHH apenas para executar o GHDL. H√° clientes SSH para v√°rios sistemas operacionais, como o &lt;a href="https://www.putty.org"&gt;PuTTY&lt;/a&gt; (Windows, Linux). Os sistemas operacionais baseados em *nix (e.g. MacOS e Linux) e algumas vers√µes do Windows (e.g. Windows 10) j√° possuem um cliente SSH pr√©-instalado, portanto basta abrir um terminal (no Windows, o terminal chama-se &lt;code&gt;cmd.exe&lt;/code&gt;e pode ser acessado pelo menu principal/executar/cmd.exe).&lt;/p&gt;
&lt;p&gt;No terminal aberto na sua m√°quina, abra uma sess√£o SSH para a VM atrav√©s do comando &lt;code&gt;ssh -p5022 poli@127.0.0.1&lt;/code&gt;. O usu√°rio √© &lt;code&gt;poli&lt;/code&gt; (j√° especificado na linha de comando) e a senha tamb√©m √© &lt;code&gt;poli&lt;/code&gt;. Se voc√™ escolheu outra porta no momento de adicionar a regra de redirecionamento, dever√° substituir de acordo.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;Brunos-MacBook-Pro:~ balbertini$ &lt;/span&gt;ssh -p5022 poli@127.0.0.1
&lt;span class="go"&gt;The authenticity of host &amp;#39;[127.0.0.1]:5022 ([127.0.0.1]:5022)&amp;#39; can&amp;#39;t be established.&lt;/span&gt;
&lt;span class="go"&gt;ECDSA key fingerprint is SHA256:fSLO3evzG//rjYMSM0OwLPx1XeqHPg4Sj7NTeQdVfq0.&lt;/span&gt;
&lt;span class="go"&gt;Are you sure you want to continue connecting (yes/no)? yes&lt;/span&gt;
&lt;span class="go"&gt;Warning: Permanently added &amp;#39;[127.0.0.1]:5022&amp;#39; (ECDSA) to the list of known hosts.&lt;/span&gt;
&lt;span class="go"&gt;poli@127.0.0.1&amp;#39;s password:&lt;/span&gt;
&lt;span class="go"&gt;Welcome to Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-30-generic x86_64)&lt;/span&gt;

&lt;span class="go"&gt; * Documentation:  https://help.ubuntu.com&lt;/span&gt;
&lt;span class="go"&gt; * Management:     https://landscape.canonical.com&lt;/span&gt;
&lt;span class="go"&gt; * Support:        https://ubuntu.com/advantage&lt;/span&gt;

&lt;span class="go"&gt;Last login: Wed Aug  8 14:22:50 2018&lt;/span&gt;
&lt;span class="gp"&gt;poli@ghdl:~$&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;No primeiro acesso, seu cliente vai mostrar a chave de criptografia do servidor SSH executando na m√°quina virtual. Aceite com &lt;em&gt;yes&lt;/em&gt; e o cliente solicitar√° a senha do usu√°rio &lt;code&gt;poli&lt;/code&gt;, que tamb√©m √© &lt;code&gt;poli&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Caso esteja usando o PuTTY, abra um terminal e digite o comando equivalente, substituindo &lt;code&gt;ssh -p5022 poli@127.0.0.1&lt;/code&gt; por &lt;code&gt;putty -p5022 poli@127.0.0.1&lt;/code&gt; (Linux) ou &lt;code&gt;putty.exe -p5022 poli@127.0.0.1&lt;/code&gt; (Windows).
Se preferir usar a vers√£o gr√°fica, veja um tutorial &lt;a href="https://www.secnet.com.br/blog/ssh-com-putty"&gt;aqui&lt;/a&gt;. As credenciais s√£o:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Host Name (or IP address)&lt;/code&gt;: 127.0.0.1&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Port&lt;/code&gt;: 5022 (ou a porta que voc√™ definiu no redirecionamento de portas)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;login as&lt;/code&gt;: poli&lt;/li&gt;
&lt;li&gt;&lt;code&gt;password&lt;/code&gt;: poli (esta √© a mesma senha usada para o sudo)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;O acesso via SSH √© opcional, mas facilitar√° bastante. Caso opte por n√£o faz√™-lo, logue diretamente na tela do seu software de virtualiza√ß√£o. Se acessar via SSH, voc√™ pode minimizar a m√°quina virtual e deix√°-la executando em segundo plano.&lt;/p&gt;
&lt;h1&gt;Reconfigurando o teclado&lt;/h1&gt;
&lt;p&gt;Caso tenha problemas com o layout do seu teclado, use o comando abaixo para mud√°-lo.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;poli@ghdl:~$ &lt;/span&gt;sudo dpkg-reconfigure keyboard-configuration
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;h1&gt;Fazendo update do VirtualBox Guest Additions&lt;/h1&gt;
&lt;p&gt;Quando estiver logado na m√°quina virtual (via SSH ou via tela do software de virtualiza√ß√£o), fa√ßa o update do m√≥dulo de &lt;em&gt;Guest Additions&lt;/em&gt;. Este passo √© necess√°rio pois o m√≥dulo muda com frequ√™ncia, e voc√™ precisa mant√™-lo alinhado com a sua vers√£o do VirtualBox. Refa√ßa este passo todas as vezes que atualizar o VirtualBox na sua m√°quina real (&lt;em&gt;host&lt;/em&gt;). Caso sua m√°quina virtual j√° esteja com a √∫ltima vers√£o do &lt;em&gt;Guest Additions&lt;/em&gt; instalada, nenhum pacote ser√° atualizado e, dependendo de quando voc√™ fizer o download da m√°quina virtual, voc√™ pode pular este passo. Aproveite e fa√ßa um update do sistema operacional tamb√©m.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;poli@ghdl:~$ &lt;/span&gt;sudo apt-get update
&lt;span class="gp"&gt;poli@ghdl:~$ &lt;/span&gt;sudo apt-get install virtualbox-guest-utils
&lt;span class="gp"&gt;poli@ghdl:~$ &lt;/span&gt;sudo apt-get upgrade
&lt;span class="gp"&gt;poli@ghdl:~$ &lt;/span&gt;sudo reboot
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O comando do meio, &lt;code&gt;sudo apt-get install virtualbox-guest-utils&lt;/code&gt; √© o √∫nico passo obrigat√≥rio, os demais fica a seu crit√©rio. O √∫ltimo comando ir√° reiniciar a m√°quina para que poss√≠veis atualiza√ß√µes da m√°quina surtam efeito, o que acarretar√° na sua desconex√£o. Aguarde a m√°quina virtual reiniciar e logue novamente.&lt;/p&gt;
&lt;h1&gt;Montando a pasta compartilhada&lt;/h1&gt;
&lt;p&gt;Precisamos primeiro criar um ponto de montagem, que nada mais √© que um diret√≥rio na m√°quina virtual.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;poli@ghdl:~$ &lt;/span&gt;mkdir shared
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Depois montamos a pasta da sua m√°quina real (host) na m√°quina virtual.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;poli@ghdl:~$ &lt;/span&gt;sudo mount -t vboxsf -ouid&lt;span class="o"&gt;=&lt;/span&gt;poli,rw VMShared shared
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Com isso, a pasta &lt;code&gt;shared&lt;/code&gt; na m√°quina virtual ser√° a mesma que a pasta que escolheu quando configurou a pasta compartilhada. Note que se voc√™ deu outro nome para o compartilhamento, deve substituir &lt;code&gt;VMShared&lt;/code&gt; pelo nome que escolheu.&lt;/p&gt;
&lt;h1&gt;Usando o GHDL na m√°quina virtual&lt;/h1&gt;
&lt;p&gt;Voc√™ pode editar os arquivos VHDL na sua m√°quina real (&lt;em&gt;host&lt;/em&gt;) normalmente, usando o editor de sua prefer√™ncia (eu utilizo o &lt;a href="https://atom.io/"&gt;Atom&lt;/a&gt; com o pacote &lt;code&gt;language-vhdl&lt;/code&gt; para o &lt;em&gt;syntax highlight&lt;/em&gt;). Sempre salve os seus arquivos na pasta compartilhada na sua m√°quina real e eles automaticamente estar√£o dispon√≠veis dentro da m√°quina virtual, na pasta onde montou a pasta compartilhada.&lt;/p&gt;
&lt;p&gt;Para usar o GHDL, voc√™ deve passar por tr√™s fases:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;An√°lise: &lt;code&gt;ghdl -a arquivo.vhd&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Elabora√ß√£o: &lt;code&gt;ghdl -e entidade&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Simula√ß√£o: &lt;code&gt;ghdl -e entidade&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Voc√™ deve fazer a an√°lise de todos os arquivos VHDL que for utilizar. Na an√°lise, o GHDL ir√° verificar erros de sintaxe e verificar√° se os componentes necess√°rios est√£o todos presentes.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;poli@ghdl:~/shared$ &lt;/span&gt;ghdl -a shiftleft2.vhd
&lt;span class="gp"&gt;poli@ghdl:~/shared$ &lt;/span&gt;ghdl -a utils.vhd
&lt;span class="gp"&gt;poli@ghdl:~/shared$ &lt;/span&gt;ghdl -a shiftleft2_tb.vhd
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Neste exemplo, analisamos os arquivos &lt;code&gt;shiftleft2.vhd&lt;/code&gt;, &lt;code&gt;utils.vhd&lt;/code&gt; e &lt;code&gt;shiftleft2_tb.vhd&lt;/code&gt;. A an√°lise do &lt;code&gt;utils.vhd&lt;/code&gt; precisa vir antes da an√°lise do &lt;code&gt;shiftleft2_tb.vhd&lt;/code&gt; pois este √∫ltimo utiliza o pacote (&lt;code&gt;package&lt;/code&gt;) dentro do &lt;code&gt;utils.vhd&lt;/code&gt;, portanto este deve estar analisado no momento da an√°lise da entidade que o utiliza.&lt;/p&gt;
&lt;p&gt;Com todos os arquivos analisados, vamos para a fase de elabora√ß√£o. Nesta fase, o GHDL ir√° montar o simulador com a entidade desejada, ligando de fato todos os componentes e verificando erros sem√¢nticos.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;poli@ghdl:~/shared$ &lt;/span&gt;ghdl -e shiftleft2_tb
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Agora que a entidade a ser executada est√° elaborada, podemos executar a simula√ß√£o em si:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;poli@ghdl:~/shared$ &lt;/span&gt;ghdl -r shiftleft2_tb
&lt;span class="go"&gt;shiftleft2_tb.vhd:44:7:@0ms:(report note): BOT&lt;/span&gt;
&lt;span class="go"&gt;shiftleft2_tb.vhd:65:7:@4ns:(report note): EOT&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A entidade que ser√° simulada est√° no &lt;code&gt;shiftleft2_tb.vhd&lt;/code&gt; e chama-se &lt;code&gt;shiftleft2_tb&lt;/code&gt;, portanto no exemplo elaboramos esta entidade, depois executamos a simula√ß√£o com a mesma. Esta entidade representa um &lt;em&gt;testbench&lt;/em&gt; escrito em VHDL. A sa√≠da impressa s√£o provenientes dos comandos &lt;code&gt;report&lt;/code&gt; colocados no &lt;em&gt;testbench&lt;/em&gt; para indicar o in√≠cio e o final da simula√ß√£o.&lt;/p&gt;
&lt;p&gt;Ainda podemos passar alguns par√¢metros para o simulador:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="gp"&gt;poli@ghdl:~/shared$ &lt;/span&gt;ghdl -r shiftleft2_tb --vcd&lt;span class="o"&gt;=&lt;/span&gt;shiftleft2_tb.vcd
&lt;span class="go"&gt;shiftleft2_tb.vhd:44:7:@0ms:(report note): BOT&lt;/span&gt;
&lt;span class="go"&gt;shiftleft2_tb.vhd:65:7:@4ns:(report note): EOT&lt;/span&gt;
&lt;span class="gp"&gt;poli@ghdl:~/shared$&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;H√° diversos par√¢metros que podem ser passados para a simula√ß√£o. Um muito √∫til que pode ser visto acima √© o &lt;code&gt;--vcd=arquivo.vcd&lt;/code&gt;. Este par√¢metro salvar√° a forma de onda resultante da simula√ß√£o no arquivo (neste caso o &lt;code&gt;shiftleft2_tb.vcd&lt;/code&gt;). Para visualizar o arquivo VCD voc√™ precisar√° de um programa que visualize formas de onda. Recomendo o &lt;a href="http://gtkwave.sourceforge.net/"&gt;GTKWave&lt;/a&gt;, dispon√≠vel para v√°rias as plataformas. Na sua m√°quina real (&lt;em&gt;host&lt;/em&gt;), navegue at√© a pasta compartilhada e veja que os arquivos gerados pelo GHDL est√£o l√°, incluindo o resultado da simula√ß√£o. Voc√™ pode abrir o arquivo VCD com o seu visualizador preferido.&lt;/p&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="ghdl"></category><category term="vm"></category></entry><entry><title>Circuitos Sequenciais em VHDL</title><link href="https://balbertini.github.io/vhdl_sequential-pt_BR.html" rel="alternate"></link><published>2018-09-05T08:24:31-03:00</published><updated>2021-01-31T18:30:36-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2018-09-05:/vhdl_sequential-pt_BR.html</id><summary type="html">&lt;p&gt;Como descrever circuitos sequenciais em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;A principal caracter√≠stica de um &lt;strong&gt;circuito sequencial&lt;/strong&gt; √© que as sa√≠das dependem n√£o somente das entradas, como em um circuito combinat√≥rio, mas tamb√©m das entradas passadas. Diz-se que um circuito sequencial possui um &lt;strong&gt;elemento de mem√≥ria&lt;/strong&gt; ou √© dependente do tempo.&lt;/p&gt;
&lt;table style="width:100%"&gt;
  &lt;tr&gt;
    &lt;td&gt;
      &lt;i class="fas fa-info fa-2x"  style="color: #0066ff;"&gt;&lt;/i&gt;
    &lt;/td&gt;
    &lt;td&gt;
      Depender do tempo n√£o implica que o circuito possui um sinal de &lt;em&gt;clock&lt;/em&gt;, apesar disso ser verdadeiro na maioria das vezes.
    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/table&gt;

&lt;h2&gt;Process&lt;/h2&gt;
&lt;p&gt;A estrutura utilizada para descrever circuitos sequenciais em VHDL √© o &lt;code&gt;process&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Sintaxe de um &lt;code&gt;process&lt;/code&gt;:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nc"&gt;nome_opcional&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lista_de_sensibilidade&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;declaracoes&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="n"&gt;primitivas&lt;/span&gt; &lt;span class="n"&gt;sequenciais&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="nc"&gt;nome_opcional&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O nome do &lt;code&gt;process&lt;/code&gt; √© opcional e serve para identific√°-lo durante a simula√ß√£o. Recomenda-se a sua utiliza√ß√£o para melhorar a legibilidade e facilitar a depura√ß√£o, obviamente usando um nome que representa o circuito sendo descrito. Se optar por retirar o nome, retira-se o &lt;code&gt;nome_opcional&lt;/code&gt;, incluindo o &lt;code&gt;:&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Primitivas sequenciais e concorrentes&lt;/h2&gt;
&lt;p&gt;As primitivas sequenciais dentro de um &lt;code&gt;process&lt;/code&gt; podem ser quaisquer primitivas utilizadas para descrever  circuitos combinat√≥rios (e.g. atribui√ß√µes condicionais) e tamb√©m algumas que s√≥ podem ser utilizadas de maneira sequencial: &lt;code&gt;if-else&lt;/code&gt; e &lt;code&gt;case&lt;/code&gt;. No entanto, todas as primitivas que estiverem dentro de um &lt;code&gt;process&lt;/code&gt; se &lt;strong&gt;comportam de maneira sequencial&lt;/strong&gt;. Em contraste, as primitivas que est√£o dentro da descri√ß√£o uma arquitetura - que s√≥ podem ser combinat√≥rias - s√£o consideradas concorrentes.&lt;/p&gt;
&lt;p&gt;As primitivas concorrentes (dentro da arquitetura), representam circuitos combinat√≥rios, portanto ser√£o sintetizadas para tais circuitos. Quaisquer modifica√ß√µes na entrada t√™m efeito imediato e todas as fun√ß√µes combinat√≥rias descritas ter√£o suas sa√≠das afetadas (ap√≥s o devido tempo de propaga√ß√£o caso aplic√°vel). √â importante notar que um bloco de um &lt;code&gt;process&lt;/code&gt; inteiro √© equivalente a uma primitiva combinat√≥ria, ou seja, a avalia√ß√£o das sa√≠das do &lt;code&gt;process&lt;/code&gt; ocorre ao mesmo tempo que a avalia√ß√£o de todas as primitivas concorrentes da mesma arquitetura, incluindo outros poss√≠veis blocos &lt;code&gt;process&lt;/code&gt; descritos na mesma arquitetura, portanto n√£o √© poss√≠vel aninhar mais de um &lt;code&gt;process&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/sequencial.png' align="right" style="padding-left:5%" /&gt;
J√° as primitivas sequencias (dentro de um &lt;code&gt;process&lt;/code&gt;), representam um circuito sequencial nos moldes da figura acima. Qualquer circuito sequencial pode ser mapeado para um circuito com um elemento de mem√≥ria e uma l√≥gica combinat√≥ria dependente do estado atual do circuito, fornecido pelo elemento de mem√≥ria. Dentro de um &lt;code&gt;process&lt;/code&gt;, as primitivas sequencias s√£o &lt;strong&gt;avaliadas em ordem&lt;/strong&gt; e caso haja diverg√™ncia (i.e. mais de um valor atribu√≠do para um determinado sinal), prevalece a √∫ltima primitiva (i.e. o √∫ltimo valor atribu√≠do a um sinal).&lt;/p&gt;
&lt;p&gt;A l√≥gica combinat√≥ria dentro de um bloco &lt;code&gt;process&lt;/code&gt; pode ser a identidade (i.e. n√£o possuir l√≥gica que altere os dados, ou em outras palavras representar um fio) e o elemento de mem√≥ria tamb√©m pode estar ausente. √â poss√≠vel representar circuitos combinat√≥rios usando &lt;code&gt;process&lt;/code&gt; se descrevermos um circuito sequencial que possua uma l√≥gica combinat√≥ria mas n√£o um elemento de mem√≥ria. Vale lembrar que descrever circuitos combinat√≥rios com &lt;code&gt;process&lt;/code&gt; √© uma pr√°tica &lt;strong&gt;fortemente desencorajada&lt;/strong&gt;, portanto se o seu circuito n√£o possui um elemento de mem√≥ria, n√£o utilize &lt;code&gt;process&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Lista de sensibilidade&lt;/h2&gt;
&lt;p&gt;A lista de sensibilidade define o gatilho para o &lt;code&gt;process&lt;/code&gt;. De maneira program√°tica, o &lt;code&gt;process&lt;/code&gt; ser√° ativado quando algum evento acontecer em algum sinal presente na lista de sensibilidade. Se algum sinal da lista for alterado fora do &lt;code&gt;process&lt;/code&gt;, por exemplo, todas as primitivas sequenciais dentro do &lt;code&gt;process&lt;/code&gt; ser√£o avaliadas novamente, em sequencia.&lt;/p&gt;
&lt;p&gt;No entanto, a lista de sensibilidade n√£o representa um elemento sintetiz√°vel. Ela √© uma indica√ß√£o para o sintetizador de quais sinais controlam o elemento de mem√≥ria, ou seja, quando o circuito sequencial que est√° sendo descrito far√° de fato uma amostragem no elemento de mem√≥ria. Em outras palavras, o sintetizador olha para a lista de sensibilidade na hora de escolher os &lt;em&gt;enables&lt;/em&gt; e os &lt;em&gt;clocks&lt;/em&gt; dos &lt;em&gt;latches&lt;/em&gt; ou &lt;em&gt;flip-flops&lt;/em&gt; que ser√£o usados para construir o elemento de mem√≥ria. √â muito importante que a lista seja feita com cuidado para que o sintetizador possa gerar o circuito sequencial que o projetista deseja. Falhar na constru√ß√£o da lista de sensibilidade pode levar o circuito a comportamentos diferentes do esperado pelo projetista ou at√© mesmo torn√°-lo inutiliz√°vel. Por este motivo, recomenda-se que o elemento de mem√≥ria seja descrito usando &lt;code&gt;process&lt;/code&gt;, mas a l√≥gica combinat√≥ria dentro do mesmo &lt;strong&gt;seja a m√≠nima necess√°ria&lt;/strong&gt; para o funcionamento do circuito sequencial descrito.&lt;/p&gt;
&lt;p&gt;Na lista de sensibilidade, deve-se colocar todos os sinais que possam alterar o comportamento do componente descrito. Como dica para os iniciantes de prototipa√ß√£o de hardware, coloque na lista de sensibilidade todos e somente todos os sinais que s√£o &lt;strong&gt;lidos&lt;/strong&gt; dentro do &lt;code&gt;process&lt;/code&gt;. Isto pode gerar c√≥digos menos leg√≠veis e at√© mesmo atrapalhar a otimiza√ß√£o do circuito sintetizado, mas evitar√° a maioria dos problemas que os iniciantes enfrentam quando lidam com descri√ß√µes sequenciais em VHDL.&lt;/p&gt;
&lt;h2&gt;Wait&lt;/h2&gt;
&lt;p&gt;Uma alternativa para a lista de sensibilidade √© a primitiva &lt;code&gt;wait&lt;/code&gt;. Quando opta-se pela utiliza√ß√£o desta primitiva, a lista de sensibilidade deve ser omitida, pois o sintetizador ir√° inferir os sinais de controle dos elementos de mem√≥ria a partir dos &lt;code&gt;wait&lt;/code&gt; presentes no &lt;code&gt;process&lt;/code&gt;. As formas desta primitiva usadas para descrever circuitos sequenciais s√£o &lt;code&gt;wait until condicao;&lt;/code&gt;, que aguarda at√© que a condi√ß√£o seja satisfeita e &lt;code&gt;wait on sinal;&lt;/code&gt;, que aguarda o sinal mudar. Tanto a condi√ß√£o quanto o sinal podem ser uma composi√ß√£o de condi√ß√µes (desde que o resultado final seja verdadeiro ou falso) ou uma lista de sinais separados por v√≠rgula.&lt;/p&gt;
&lt;h3&gt;Exemplos&lt;/h3&gt;
&lt;h4&gt;FF-D com enable&lt;/h4&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/ffd.png' align="left" style="padding-right:5%" /&gt;&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nc"&gt;ffd&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;until&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;event&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;q_n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="nc"&gt;ffd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Este exemplo √© o mais simples poss√≠vel: um &lt;em&gt;flip-flop&lt;/em&gt; tipo D. Se o &lt;em&gt;en&lt;/em&gt; for alto, o componente amostra a entrada &lt;code&gt;d&lt;/code&gt; nas sa√≠das &lt;code&gt;q&lt;/code&gt; e &lt;code&gt;q_n&lt;/code&gt; na borda de subida do &lt;em&gt;clock&lt;/em&gt;. Note que o &lt;em&gt;process&lt;/em&gt; n√£o tem lista de sensibilidade, mas a primeira coisa que ele faz √© aguardar que aconte√ßa uma mudan√ßa no sinal de &lt;em&gt;clock&lt;/em&gt; (espera por &lt;code&gt;clock'event&lt;/code&gt;) e que esta mudan√ßa seja a borda de subida (verifica se &lt;code&gt;clock=1&lt;/code&gt;). Quando isto acontecer, ele faz uma verifica√ß√£o para saber se o &lt;code&gt;en=1&lt;/code&gt; e, caso seja, amostra a entrada para as sa√≠das. Note que n√£o est√° especificado o que acontece com as sa√≠das caso &lt;code&gt;en=0&lt;/code&gt;, o que faz com que a sa√≠da n√£o mude, exatamente o comportamento desejado para o &lt;em&gt;flip-flop&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;O equivalente usando lista de sensibilidade √©:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nc"&gt;ffd&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;event&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;q_n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt; &lt;span class="nc"&gt;ffd&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Note que neste caso, os sinais &lt;code&gt;en&lt;/code&gt; e &lt;code&gt;d&lt;/code&gt; podem ficar de fora da lista de sensibilidade pois, apesar de serem lidos dentro do &lt;code&gt;process&lt;/code&gt;, n√£o alteram o comportamento do circuito exceto na borda do &lt;em&gt;clock&lt;/em&gt;, portanto n√£o faz diferen√ßa se o colocarmos na lista de sensibilidade: &lt;code&gt;process(clock, en, d)&lt;/code&gt;.&lt;/p&gt;
&lt;h4&gt;FF-D com enable e reset ass√≠ncrono&lt;/h4&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/ffdr.png' align="left" style="padding-right:5%" /&gt;&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nc"&gt;ffdr&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;wait&lt;/span&gt; &lt;span class="k"&gt;on&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;q_n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;elsif&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;event&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;q_n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;O &lt;code&gt;process&lt;/code&gt; ir√° aguardar que aconte√ßa alguma mudan√ßa nos sinais &lt;em&gt;clock&lt;/em&gt; ou &lt;em&gt;reset&lt;/em&gt; para continuar. Neste exemplo, o &lt;em&gt;flip-flop&lt;/em&gt; possui um sinal de &lt;em&gt;reset&lt;/em&gt; ass√≠ncrono ativo alto, portanto ele √© verificado fora da condi√ß√£o de borda de subida. Neste caso, se o &lt;code&gt;reset=1&lt;/code&gt;, as sa√≠das v√£o para &lt;code&gt;q=0&lt;/code&gt; e &lt;code&gt;q_n=1&lt;/code&gt; incondicionalmente, ignorando-se a borda, portanto o &lt;em&gt;reset&lt;/em&gt; tem prioridade sobre o a amostragem da entrada. Note que neste caso utiliza-se o &lt;code&gt;wait on&lt;/code&gt; e n√£o o &lt;code&gt;wait until&lt;/code&gt;. Qualquer mudan√ßa nos sinais &lt;em&gt;clock&lt;/em&gt; ou &lt;em&gt;reset&lt;/em&gt; faz com que o &lt;code&gt;process&lt;/code&gt; passe da linha do &lt;code&gt;wait on clock, reset&lt;/code&gt; e reavalie todas as condi√ß√µes.&lt;/p&gt;
&lt;p&gt;O equivalente usando lista de sensibilidade √©:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nc"&gt;ffdr&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;reset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="n"&gt;q_n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;elsif&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="na"&gt;&amp;#39;event&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;en&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
            &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="n"&gt;q_n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Observe que o &lt;code&gt;wait on&lt;/code&gt; substitui a lista de sensibilidade. Normalmente o &lt;code&gt;wait on&lt;/code&gt; √© usado como a primeira primitiva do &lt;code&gt;process&lt;/code&gt;, em substitui√ß√£o √† lista de sensibilidade. Para circuitos sequenciais s√≠ncronos, aconselha-se a utiliza√ß√£o da vers√£o com lista de sensibilidade para evitar que a linha do &lt;code&gt;wait on&lt;/code&gt; seja colocada em locais inadequados, o que pode gerar um circuito sequencial ass√≠ncrono. A maioria das ferramentas de s√≠ntese suporta somente um &lt;code&gt;wait on&lt;/code&gt; no in√≠cio ou final do &lt;code&gt;process&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Outras primitivas sequenciais&lt;/h2&gt;
&lt;p&gt;H√° outras primitivas exclusivas para utiliza√ß√£o sequencial (&lt;code&gt;for&lt;/code&gt;, &lt;code&gt;while&lt;/code&gt; e &lt;code&gt;loop&lt;/code&gt;), que possuem prop√≥sitos espec√≠ficos que n√£o foram cobertos neste artigo pois possuem restri√ß√µes para a s√≠ntese. Isto significa que, para que elas representem um hardware, o projetista deve utiliz√°-las de uma maneira espec√≠fica, caso contr√°rio elas n√£o podem ser sintetizadas (i.e. n√£o representam uma descri√ß√£o de hardware). √â muito comum entre os iniciantes considerar que estas primitivas s√£o equivalentes √†s encontradas em linguagens de programa√ß√£o estruturada, o que na maioria das vezes √© uma fal√°cia pois n√£o existe la√ßo interativo em hardware equivalente ao conceito hom√¥nimo das linguagens de programa√ß√£o (e.g. o equivalente em hardware a um la√ßo iterativo de um algoritmo √© na verdade uma m√°quina de estados completa). Estas primitivas devem ser evitadas na descri√ß√£o de circuitos sequenciais, especialmente por iniciantes, e s√£o na maioria das vezes usadas somente na constru√ß√£o de &lt;em&gt;testbenchs&lt;/em&gt;, quando as restri√ß√µes para s√≠ntese n√£o se aplicam.&lt;/p&gt;
&lt;p&gt;Sobre o &lt;code&gt;wait&lt;/code&gt;, ainda existem o &lt;code&gt;wait for tempo;&lt;/code&gt; e o &lt;code&gt;wait;&lt;/code&gt; (s√≥ o &lt;em&gt;wait&lt;/em&gt;), ambos  usados para descrever &lt;em&gt;testbenchs&lt;/em&gt; ou modelar temporiza√ß√£o de circuitos e sem efeito para s√≠ntese.&lt;/p&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="sequenciais"></category></entry><entry><title>Circuitos Combinat√≥rios em VHDL</title><link href="https://balbertini.github.io/vhdl_combinatory-pt_BR.html" rel="alternate"></link><published>2018-09-04T13:20:23-03:00</published><updated>2021-01-31T18:30:36-03:00</updated><author><name>Bruno Albertini</name></author><id>tag:balbertini.github.io,2018-09-04:/vhdl_combinatory-pt_BR.html</id><summary type="html">&lt;p&gt;Como descrever circuitos combinat√≥rios em VHDL.&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;Circuitos combinat√≥rios&lt;/strong&gt; s√£o aqueles que implementam uma fun√ß√£o booleana sem realimenta√ß√£o. Sua principal caracter√≠stica √© a aus√™ncia de depend√™ncia temporal, ou seja, a sa√≠da depende apenas da entrada. Este tipo de circuito pode ser representado por uma s√©rie de portas l√≥gicas interligadas entre si &lt;strong&gt;sem realimenta√ß√£o&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;As tr√™s maneiras principais de descrever circuitos puramente combinat√≥rios em VHDL s√£o: estrutural, atribui√ß√£o condicional com &lt;code&gt;with-select&lt;/code&gt; e atribui√ß√£o condicional com &lt;code&gt;when-else&lt;/code&gt;. As descri√ß√µes realizadas utilizando uma destas tr√™s formas ser√£o sintetizadas para circuitos puramente combinat√≥rios.&lt;/p&gt;
&lt;h2&gt;Estrutural&lt;/h2&gt;
&lt;p&gt;A descri√ß√£o estrutural √© a maneira mais direta de se descrever uma fun√ß√£o combinat√≥ria. Consiste em descrever o circuito a partir da pr√≥pria fun√ß√£o l√≥gica que o representa. O equivalente em um diagrama esquem√°tico √© exatamente a &lt;strong&gt;fun√ß√£o l√≥gica&lt;/strong&gt;, como descrita usando as portas l√≥gicas equivalentes. A desvantagem √© que a descri√ß√£o √© prolixa e consequentemente torna-se rapidamente dif√≠cil de ler, raz√£o pela qual n√£o √© recomendada para circuitos grandes. Caso opte por este tipo de descri√ß√£o utilize uma t√©cnica de projeto baseada em divis√£o e conquista e mantenha os blocos que usam descri√ß√£o estrutural pequenos, minimizando o esfor√ßo necess√°rio para compreender o seu funcionamento.&lt;/p&gt;
&lt;p&gt;VHDL suporta os seguintes &lt;strong&gt;operadores l√≥gicos&lt;/strong&gt; para descrever circuitos estruturais:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="right"&gt;Operador&lt;/th&gt;
&lt;th align="left"&gt;Descri√ß√£o&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;not&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;complemento&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;and&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;E&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;or&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;OU&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;nand&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;E-negado&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;nor&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;OU-negado&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;xor&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;OU-exclusivo&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="right"&gt;&lt;code&gt;xnor&lt;/code&gt;&lt;/td&gt;
&lt;td align="left"&gt;OU-exclusivo-negado&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Os operadores est√£o em ordem decrescente de prioridade, ou seja, o &lt;code&gt;not&lt;/code&gt; tem preced√™ncia sobre todos os demais operadores. Aconselha-se a utiliza√ß√£o de par√™nteses &lt;code&gt;()&lt;/code&gt; para deixar claro a inten√ß√£o do projetista. Todos os operadores podem operar sobre tipos booleanos, bits ou vetores unidimensionais de bits (bits podem ser do tipo &lt;code&gt;bit&lt;/code&gt; ou derivados como &lt;code&gt;std_logic&lt;/code&gt;). √â necess√°rio que os operandos sejam do mesmo tamanho e o resultado √© sempre igual √† entrada (i.e. se os operandos s√£o vetores de bits, o resultado √© um vetor de bits). Quando o tipo √© um vetor, o resultado √© calculado bit a bit (l√≥gica bin√°ria ou &lt;em&gt;bitwise&lt;/em&gt;).&lt;/p&gt;
&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/mux.png' align="left" style="padding-right:5%" /&gt;
Este exemplo √© um multiplexador 2x1 com entradas &lt;code&gt;a&lt;/code&gt; e &lt;code&gt;b&lt;/code&gt;, sa√≠da &lt;code&gt;o&lt;/code&gt; e seletor &lt;code&gt;s&lt;/code&gt;. As entradas podem ser vetores (e.g. &lt;code&gt;bit_vector(3 downto 0)&lt;/code&gt;), mas nesse caso √© necess√°rio que o seletor &lt;code&gt;s&lt;/code&gt; tamb√©m seja um vetor do mesmo tamanho.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="k"&gt;not&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;or&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;&lt;br/&gt;&lt;/p&gt;
&lt;h2&gt;With-select&lt;/h2&gt;
&lt;p&gt;O &lt;code&gt;with-select&lt;/code&gt; √© a representa√ß√£o da &lt;strong&gt;tabela verdade&lt;/strong&gt; de uma fun√ß√£o l√≥gica. N√£o h√° equivalente em um diagrama esquem√°tico. O mais pr√≥ximo seria uma LUT (&lt;em&gt;LookUp Table&lt;/em&gt;), mas a s√≠ntese n√£o necessariamente utiliza esta abordagem (e.g. dependendo das otimiza√ß√µes feitas pelo sintetizador, pode ser feita usando um arranjo de portas l√≥gicas que implemente a fun√ß√£o equivalente).&lt;/p&gt;
&lt;p&gt;Sintaxe do &lt;code&gt;with-select&lt;/code&gt;:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;sinalSelecao&lt;/span&gt; &lt;span class="k"&gt;select&lt;/span&gt; &lt;span class="n"&gt;sinalSaida&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;
  &lt;span class="n"&gt;valorSaida1&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;valorSelecao1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;valorSaida2&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;valorSelecao2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;valorSaida3&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;No &lt;code&gt;with-select&lt;/code&gt;, a atribui√ß√£o ao &lt;code&gt;sinalSaida&lt;/code&gt; √© feita atrav√©s de uma compara√ß√£o de igualdade com o sinal de sele√ß√£o &lt;code&gt;sinalSelecao&lt;/code&gt;. O valores a serem comparados s√£o os expressos como &lt;code&gt;valorSelecao&lt;/code&gt; (e.g. se a o valor do sinal &lt;code&gt;sinalSelecao&lt;/code&gt; for igual a &lt;code&gt;valorSelecao1&lt;/code&gt;, o sinal &lt;code&gt;sinalSaida&lt;/code&gt; ser√° &lt;code&gt;valorSaida1&lt;/code&gt;). N√£o √© necess√°rio que o n√∫mero de entradas seja m√∫ltiplo de uma pot√™ncia de dois e os valores de sa√≠da &lt;code&gt;valorSaida&lt;/code&gt; podem ser outros sinais ou express√µes. Os valores para compara√ß√£o devem ser constantes ou serem pass√≠veis de resolu√ß√£o (i.e. n√£o devem ser vari√°veis ou valores transitivos). Tanto a entrada de sele√ß√£o quando a sa√≠da podem ser vetores. &lt;strong&gt;Aten√ß√£o:&lt;/strong&gt; √© fortemente recomendada a descri√ß√£o da &lt;a href="#others"&gt;op√ß√£o padr√£o&lt;/a&gt; (compara√ß√£o com &lt;code&gt;others&lt;/code&gt;).&lt;/p&gt;
&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;table align="left" style="border-right: 30px solid #fff;"&gt;
  &lt;tr&gt;&lt;th&gt;s&lt;/th&gt;&lt;th&gt;a&lt;/th&gt;&lt;th&gt;b&lt;/th&gt;&lt;th&gt;&lt;/th&gt;&lt;th&gt;o&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;

&lt;p&gt;Este exemplo √© um multiplexador 2x1 com entradas &lt;code&gt;a&lt;/code&gt; e &lt;code&gt;b&lt;/code&gt;, sa√≠da &lt;code&gt;o&lt;/code&gt; e seletor &lt;code&gt;s&lt;/code&gt;. Lembre-se que um seletor de um multiplexador deve ter tamanho &lt;code&gt;ceil(log2(n))&lt;/code&gt;, onde &lt;code&gt;n&lt;/code&gt; √© o n√∫mero de entradas, portanto √© poss√≠vel que ele seja um vetor. Neste exemplo, como h√° duas entradas, o seletor &lt;code&gt;s&lt;/code&gt; tem somente um bit (&lt;code&gt;ceil(log2(2))=1&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Vers√£o com sa√≠das como constantes:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;sel&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kt"&gt;bit_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="k"&gt;downto&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;-- Declara√ß√£o&lt;/span&gt;
&lt;span class="n"&gt;sel&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;-- Concatena√ß√£o&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;sel&lt;/span&gt; &lt;span class="k"&gt;select&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;
  &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;000&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;001&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;010&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;011&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;100&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;101&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;110&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Note que este √© um trecho de c√≥digo de uma descri√ß√£o: a declara√ß√£o do sinal deve estar no local apropriado dentro da arquitetura (antes do &lt;code&gt;begin&lt;/code&gt;), assim como a atribui√ß√£o ao sinal &lt;code&gt;sel&lt;/code&gt; (concatena√ß√£o, depois do &lt;code&gt;begin&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Vers√£o com sa√≠das como sinais:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="k"&gt;select&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;
  &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="k"&gt;others&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A vantagem √© muito clara quando se tem uma fun√ß√£o l√≥gica expressa na forma de uma tabela verdade. No entanto, esta op√ß√£o tem a desvantagem de ser prolixa. Note a diferen√ßa entre as duas vers√µes acima: a &lt;em&gt;vers√£o com as sa√≠das como sinais&lt;/em&gt; √© compacta e pass√≠vel de utiliza√ß√£o. J√° a &lt;em&gt;vers√£o com sa√≠das como constantes&lt;/em&gt; √© uma transcri√ß√£o da tabela verdade e pode se tornar impratic√°vel (ou ileg√≠vel) rapidamente pois a tabela cresce exponencialmente ao n√∫mero de entradas (lembre-se que a tabela verdade ter√° &lt;code&gt;2^n&lt;/code&gt; linhas, onde &lt;code&gt;n&lt;/code&gt; √© o n√∫mero de entradas).&lt;/p&gt;
&lt;h2&gt;When-else&lt;/h2&gt;
&lt;p&gt;O &lt;code&gt;when-else&lt;/code&gt; √© uma maneira f√°cil de descrever funcionalmente um circuito com v√°rias fun√ß√µes l√≥gicas. O equivalente a um diagrama esquem√°tico √© um &lt;strong&gt;multiplexador&lt;/strong&gt;, cujas entradas s√£o fun√ß√µes l√≥gicas.&lt;/p&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/mux_exp.png' align="left" style="padding-right:5%" /&gt;
Sintaxe do &lt;code&gt;when-else&lt;/code&gt;:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sinal&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;expressao1&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;condicao1&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
         &lt;span class="n"&gt;expressao2&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;condicao2&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt;
         &lt;span class="n"&gt;expressao3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;A atribui√ß√£o acontece de acordo com a primeira condi√ß√£o atendida, em ordem (e.g. se a &lt;code&gt;condicao1&lt;/code&gt; for atendida, o &lt;code&gt;sinal&lt;/code&gt; ser√° &lt;code&gt;expressao1&lt;/code&gt; e as demais condi√ß√µes n√£o ser√£o avaliadas). &lt;strong&gt;Aten√ß√£o:&lt;/strong&gt; √© fortemente recomendada a descri√ß√£o da &lt;a href="#others"&gt;op√ß√£o padr√£o&lt;/a&gt; (atribui√ß√£o para a &lt;code&gt;expressao3&lt;/code&gt; no &lt;code&gt;else&lt;/code&gt; final sem condi√ß√£o), que ser√° a atribui√ß√£o caso nenhuma condi√ß√£o for atendida.&lt;/p&gt;
&lt;h3&gt;Exemplo&lt;/h3&gt;
&lt;p&gt;&lt;img src='https://balbertini.github.io/images/vhdl/mux2x1.png' align="left" style="padding-right:5%" /&gt;
Este exemplo √© um multiplexador 2x1 com entradas &lt;code&gt;a&lt;/code&gt; e &lt;code&gt;b&lt;/code&gt;, sa√≠da &lt;code&gt;o&lt;/code&gt; e seletor &lt;code&gt;s&lt;/code&gt;. As entradas podem ser vetores (e.g. &lt;code&gt;bit_vector(3 downto 0)&lt;/code&gt;). Lembre-se que um seletor de um multiplexador deve ter tamanho &lt;code&gt;ceil(log2(n))&lt;/code&gt;, onde &lt;code&gt;n&lt;/code&gt; √© o n√∫mero de entradas, portanto √© poss√≠vel que ele seja um vetor. Neste exemplo, como h√° duas entradas, o seletor &lt;code&gt;s&lt;/code&gt; tem somente um bit (&lt;code&gt;ceil(log2(2))=1&lt;/code&gt;).&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;&lt;a name="others"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Op√ß√£o padr√£o&lt;/h2&gt;
&lt;p&gt;Os operadores em VHDL possuem uma op√ß√£o padr√£o indicada pela palavra chave &lt;code&gt;others&lt;/code&gt; ou no √∫ltimo &lt;code&gt;else&lt;/code&gt;, que ser√° a atribui√ß√£o a ser realizada caso nenhuma condi√ß√£o anterior for atendida. Se a op√ß√£o padr√£o n√£o for especificada, a atribui√ß√£o √© considerada uma &lt;em&gt;atribui√ß√£o incompleta&lt;/em&gt; e a s√≠ntese poder√° inferir um &lt;em&gt;latch&lt;/em&gt;, tornando o circuito sequencial. Uma maneira f√°cil de especificar a op√ß√£o padr√£o √© deixar o √∫ltimo valor poss√≠vel sem escolha, ou seja, caso nenhuma das op√ß√µes anteriores atenda a atribui√ß√£o condicional, a √∫ltima op√ß√£o ser√° tomada.&lt;/p&gt;
&lt;p&gt;Quando se utiliza tipos &lt;code&gt;std_logic&lt;/code&gt; e derivados, tamb√©m √© comum a op√ß√£o padr√£o ser a atribui√ß√£o para &lt;code&gt;X&lt;/code&gt; (valor desconhecido ou &lt;em&gt;unknown&lt;/em&gt;), mas n√£o recomendo esta abordagem pois o valor &lt;code&gt;X&lt;/code&gt; n√£o √© sintetiz√°vel. Para simula√ß√£o e depura√ß√£o, o valor ser√° mostrado como &lt;code&gt;X&lt;/code&gt;, o que pode facilitar a depura√ß√£o do circuito. Contudo, ap√≥s a s√≠ntese a atribui√ß√£o &lt;code&gt;X&lt;/code&gt; ir√° assumir um valor bin√°rio, o que torna dif√≠cil a identifica√ß√£o de problemas com o circuito funcionando pois pode n√£o ser poss√≠vel distingu√≠-lo de um valor leg√≠timo.&lt;/p&gt;
&lt;p&gt;√â &lt;strong&gt;fortemente recomendada&lt;/strong&gt; a utiliza√ß√£o da op√ß√£o padr√£o quando se utiliza as constru√ß√µes &lt;code&gt;when-else&lt;/code&gt; ou &lt;code&gt;with-select&lt;/code&gt; para descrever circuitos combinat√≥rios pois, se a atribui√ß√£o for incompleta o circuito pode n√£o operar como desejado.&lt;/p&gt;
&lt;h2&gt;Outras maneiras&lt;/h2&gt;
&lt;p&gt;H√° outras maneiras de se descrever circuitos combinat√≥rios em VHDL. Dois exemplos comuns que &lt;strong&gt;n√£o s√£o  recomendados&lt;/strong&gt; utilizam o &lt;code&gt;case&lt;/code&gt; e o &lt;code&gt;if-else&lt;/code&gt;. Este tipo de descri√ß√£o √© f√°cil de ser encontrado pois utiliza primitivas similares √†s encontradas em linguagens de programa√ß√£o estruturadas (e.g. C/C++, Java, etc).&lt;/p&gt;
&lt;p&gt;Os dois exemplos abaixo s√£o de um multiplexador 2x1 com entradas &lt;code&gt;a&lt;/code&gt; e &lt;code&gt;b&lt;/code&gt;, sa√≠da &lt;code&gt;o&lt;/code&gt; e seletor &lt;code&gt;s&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Com &lt;code&gt;case&lt;/code&gt;:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;-- N√ÉO UTILIZE / DO NOT USE&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt;
    &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="sc"&gt;&amp;#39;1&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;when&lt;/span&gt; &lt;span class="k"&gt;others&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Com &lt;code&gt;if-else&lt;/code&gt;:&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;1
2
3
4
5
6
7
8&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;-- N√ÉO UTILIZE / DO NOT USE&lt;/span&gt;
&lt;span class="k"&gt;begin&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
    &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;process&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;p&gt;Estas duas descri√ß√µes s√£o consideradas &lt;strong&gt;inadequadas&lt;/strong&gt; do ponto de vista de boas pr√°ticas em descri√ß√µes de hardware e s√£o &lt;strong&gt;fortemente desencorajadas&lt;/strong&gt;. O principal motivo √© que utilizam primitivas que devem estar dentro de um bloco sequencial do tipo &lt;code&gt;process&lt;/code&gt;. Apesar de estarem corretas do ponto de vista sint√°tico, este tipo de descri√ß√£o √© considerada errada do ponto de vista sem√¢ntico, pois h√° a utiliza√ß√£o de uma primitiva sequencial para descrever um circuito combinat√≥rio. Em outras palavras, voc√™ est√° dizendo ao sintetizador que quer descrever um circuito sequencial, mas na verdade est√° descrevendo um circuito combinat√≥rio.&lt;/p&gt;
&lt;p&gt;As descri√ß√µes acima ser√£o sintetizadas corretamente para um multiplexador combinat√≥rio pois n√£o possuem erros e os sintetizadores conseguir√£o perceber que se trata de um circuito combinat√≥rio mesmo na presen√ßa do &lt;code&gt;process&lt;/code&gt;. No entanto, qualquer deslize (e.g. atribui√ß√£o incompleta, esquecer um sinal na lista de sensibilidade, etc.) induzir√° o sintetizador a inserir &lt;em&gt;latches&lt;/em&gt; ou &lt;em&gt;flip-flops&lt;/em&gt; no caminho de dados. A inser√ß√£o destes elementos sequenciais em um circuito puramente combinat√≥rio pode torn√°-lo sequencial ou at√© mesmo inutilizar o circuito. O funcionamento do circuito pode n√£o ser o esperado, diferindo da inten√ß√£o do projetista.&lt;/p&gt;
&lt;p&gt;Lembre-se que estas duas √∫ltimas descri√ß√µes s√£o &lt;strong&gt;fortemente desencorajadas&lt;/strong&gt; para descrever circuitos combinat√≥rios e devem ser evitadas para este prop√≥sito. Utilize uma das tr√™s op√ß√µes no come√ßo desta p√°gina para descrever o seu circuito combinat√≥rio. &lt;strong&gt;Aten√ß√£o:&lt;/strong&gt; se voc√™ √© meu aluno n√£o utilize descri√ß√µes de circuitos combinat√≥rios usando &lt;code&gt;process&lt;/code&gt; em nenhuma hip√≥tese.&lt;/p&gt;</content><category term="vhdl"></category><category term="vhdl"></category><category term="combinatorios"></category></entry></feed>