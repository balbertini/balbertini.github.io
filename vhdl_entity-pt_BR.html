
<!DOCTYPE html>
<html lang="pt_br">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://balbertini.github.io/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark)"
    href="https://balbertini.github.io/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark)"
          href="https://balbertini.github.io/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"
          href="https://balbertini.github.io/theme/pygments/emacs.min.css">


  <link rel="stylesheet" type="text/css" href="https://balbertini.github.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://balbertini.github.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://balbertini.github.io/theme/font-awesome/css/solid.css">


    <link href="https://balbertini.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="B.Albertini's site Atom">


    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-125173293-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->  

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333">

 

<meta name="author" content="Bruno Albertini" />
<meta name="description" content="Entidades em VHDL." />
<meta name="keywords" content="vhdl, basic">


  <meta property="og:site_name" content="B.Albertini's site"/>
  <meta property="og:title" content="Entidade"/>
  <meta property="og:description" content="Entidades em VHDL."/>
  <meta property="og:locale" content="pr_BR"/>
  <meta property="og:url" content="https://balbertini.github.io/vhdl_entity-pt_BR.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2018-09-25 13:25:12-03:00"/>
  <meta property="article:modified_time" content="2021-05-03 08:55:51-03:00"/>
  <meta property="article:author" content="https://balbertini.github.io/author/bruno-albertini.html">
  <meta property="article:section" content="vhdl"/>
  <meta property="article:tag" content="vhdl"/>
  <meta property="article:tag" content="basic"/>
  <meta property="og:image" content="/images/profile.png">

  <title>B.Albertini's site &ndash; Entidade</title>

</head>
<body >
  <aside>
    <div>
      <a href="https://balbertini.github.io/">
        <img src="/images/profile.png" alt="B.Albertini" title="B.Albertini">
      </a>

      <h1>
        <a href="https://balbertini.github.io/">B.Albertini</a>
      </h1>

<p>Professor</p>

      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/sd-pt_BR.html#sd">
                  Sistemas Digitais
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/disciplinas-pt_BR.html#disciplinas">
                  Disciplinas
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/research-pt_BR.html#research">
                  Pesquisa
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/sobre-pt_BR.html#sobre">
                  Sobre
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/vagas-pt_BR.html#vagas">
                  Vagas
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/vhdl-pt_BR.html#vhdl">
                  VHDL
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/balbertini" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="//balbertini.github.io/feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="vhdl_entity">Entidade</h1>
    <p>
      Posted on ter 25 setembro 2018 in <a href="https://balbertini.github.io/category/vhdl.html">vhdl</a>

        &#8226; 5 min read
    </p>
  </header>


  <div>
    <p>Toda descrição em VHDL segue um padrão base de uma entidade e uma arquitetura. Neste artigo, explicarei como funciona a entidade.</p>
<p><img src='https://balbertini.github.io/images/vhdl/vhdl_maqrefri.png' width="20%" align="left" style="padding-right:5%" />
A entidade, declarada pela palavra reservada <code>entity</code>, é a unidade básica de descrição de VHDL. O equivalente em um diagrama esquemático é o desenho que você faz para representar seu componente. Por exemplo, pense em uma máquina de vender refrigerantes em lata. Suponha que você (abstratamente), tenha que desenhar um símbolo para sua máquina. O meu símbolo seria como o da figura: entra dinheiro e sai latas.
<br/><br/></p>
<p>A sintaxe de uma entidade em VHDL é:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">entity</span><span class="w"> </span><span class="nc">nome_da_entidade</span><span class="w"> </span><span class="k">is</span><span class="w"></span>
<span class="w">   </span><span class="k">generic</span><span class="w"> </span><span class="p">(</span><span class="n">lista_de_elementos_genericos</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">port</span><span class="w"> </span><span class="p">(</span><span class="n">lista_de_portas</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"> </span><span class="nc">nome_da_entidade</span><span class="p">;</span><span class="w"></span>
</code></pre></div></td></tr></table></div>

<p><img src='https://balbertini.github.io/images/vhdl/entidade.png' width="20%" align="right" style="padding-left:5%" />
No caso do VHDL, a entidade segue o mesmo princípio que você pensou para definir as entradas e saídas da máquina de refrigerantes, mas obviamente estamos descrevendo um circuito digital, então as entradas e saídas são digitais. A palavra reservada <code>generic</code> é opcional e não será explicada neste artigo. Na entidade, quem declara os sinais que são usados para modelar as suas entradas e saídas é a palavra reservada <code>port</code>. O <code>port</code> tem a seguinte sintaxe: <code>port(lista_de_portas);</code>, onde a <code>lista_de_portas</code> deve ser as portas separadas por <code>;</code>, como em <code>port(porta1; porta2; porta3);</code>. Pode-se colocar quantas portas desejar na sua descrição, separadas por ponto e vírgula <code>;</code>. Note que a última porta declarada não tem <code>;</code> pois o parênteses <code>)</code> fecha a declaração. O último <code>;</code> pertence à declaração do <code>port</code> e não à uma porta específica.</p>
<p>Cada porta em VHDL deve ser descrita com o formato <code>nome: direção tipo</code>. O nome pode ser o que você desejar, desde que seja um nome válido em VHDL. O tipo da porta define qual tipo de dados será utilizado para aquela porta e pode ser <a href="https://balbertini.github.io/vhdl_datatypes-pt_BR.html">qualquer tipo suportado</a>. Quanto a direção, há quatro direções possíveis: <code>in</code>, <code>out</code>, <code>buffer</code> ou <code>inout</code>. O <code>in</code> é uma entrada e, como tal, só pode ser lida pelo seu componente. Analogamente, o <code>out</code> indica uma saída, que só pode ser escrita pelo seu componente (note que <strong>não</strong> pode ser lida). As direções de saída <code>buffer</code> e <code>inout</code> devem ser evitados (o motivo está <a href="#bufferEinout">no final do artigo</a>).</p>
<h3>Exemplo</h3>
<p><img src='https://balbertini.github.io/images/vhdl/mux2x1_entidade.png' width="70%"/></p>
<p>Vamos descrever um multiplexador como o da figura. A entidade chama-se <code>mux2to1</code> e, na figura, está a esquerda. O equivalente em um diagrama esquemático está a direita na figura. É uma convenção desenhar entradas a esquerda do componente, saídas a direita e sinais de controle embaixo ou em cima. O tamanho, quando não especificado, é assumido em 1 bit (nesse caso os tamanhos foram especificados).</p>
<p>O código VHDL para esta entidade é:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">entity</span><span class="w"> </span><span class="nc">mux2to1</span><span class="w"> </span><span class="k">is</span><span class="w"></span>
<span class="w">    </span><span class="k">port</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="n">s</span><span class="o">:</span><span class="w">    </span><span class="k">in</span><span class="w">  </span><span class="kt">bit</span><span class="p">;</span><span class="w"> </span><span class="c1">-- selection: 0=a, 1=b</span><span class="w"></span>
<span class="w">        </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="o">:</span><span class="w"> </span><span class="k">in</span><span class="w">    </span><span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">-- inputs</span><span class="w"></span>
<span class="w">        </span><span class="n">o</span><span class="o">:</span><span class="w">    </span><span class="k">out</span><span class="w">   </span><span class="kt">bit_vector</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">downto</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">  </span><span class="c1">-- output</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"> </span><span class="nc">mux2to1</span><span class="p">;</span><span class="w"></span>
</code></pre></div></td></tr></table></div>

<h2>Boas práticas ao definir a entidade</h2>
<ol>
<li>Use um nome de entidade que indique o que ela faz.</li>
<li>O nome do arquivo deve ser <code>&lt;nome_da_entidade&gt;.vhd</code> (e.g. <code>mux2to1.vhd</code>). Isso não se refere ao VHDL mas sim à algumas ferramentas de síntese que exigem este tipo de padronização para encontrar sua entidade.</li>
<li>Descreva primeiro os sinais de controle, depois as entradas e depois as saídas. Não há nenhuma restrição quando a isso, mas ficará mais fácil de associar sua entidade como um componente depois.</li>
<li>Sua entidade é a "cara" do seu componente. Capriche nos nomes das entradas e saídas e descreva-as como se estivesse desenhando-as em um diagrama esquemático.</li>
</ol>
<h1>Uso do <code>begin</code> e nome da entidade</h1>
<p>É possível que uma entidade tenha um <code>begin</code>. Dentro da entidade (após o <code>begin</code> e antes do <code>end</code>) podemos colocar qualquer declaração passiva, ou seja, que não altera nenhum sinal (i.e. processos passivos, asserções estáticas e chamadas de procedimentos passivas). A mais utilizada é a asserção, assim podemos fazer verificações estáticas sobre a utilização da entidade.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">entity</span><span class="w"> </span><span class="nc">nome_da_entidade</span><span class="w"> </span><span class="k">is</span><span class="w"></span>
<span class="w">   </span><span class="k">generic</span><span class="w"> </span><span class="p">(</span><span class="n">lista_de_elementos_genericos</span><span class="p">);</span><span class="w"></span>
<span class="w">   </span><span class="k">port</span><span class="w"> </span><span class="p">(</span><span class="n">lista_de_portas</span><span class="p">);</span><span class="w"></span>
<span class="k">begin</span><span class="w"></span>
<span class="w">  </span><span class="n">verificacoes_estaticas</span><span class="p">;</span><span class="w"></span>
<span class="k">end</span><span class="w"> </span><span class="nc">nome_da_entidade</span><span class="p">;</span><span class="w"></span>
</code></pre></div></td></tr></table></div>

<h3>Exemplo</h3>
<p>No exemplo a seguir colocamos uma asserção na parte estática da entidade para verificar se o registrador foi instanciado corretamente. Caso o registrador tenha um tamanho especificado menor que 2, a asserção irá falhar e qualquer simulação ou síntese será interrompida com a mensagem especificada.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">entity</span><span class="w"> </span><span class="nc">reg_deslocamento</span><span class="w"> </span><span class="k">is</span><span class="w"></span>
<span class="w">  </span><span class="k">generic</span><span class="p">(</span><span class="w"> </span><span class="n">tamanho</span><span class="o">:</span><span class="w"> </span><span class="kt">natural</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">port</span><span class="p">(...);</span><span class="w"></span>
<span class="k">begin</span><span class="w"></span>
<span class="w">  </span><span class="k">assert</span><span class="w"> </span><span class="n">tamanho</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"></span>
<span class="w">  </span><span class="n">report</span><span class="w"> </span><span class="s">&quot;Este registrador precisa ter tamanho mínimo 2.&quot;</span><span class="w"></span>
<span class="w">  </span><span class="k">severity</span><span class="w"> </span><span class="n">failure</span><span class="p">;</span><span class="w"></span>
<span class="k">end</span><span class="w"> </span><span class="k">entity</span><span class="w"> </span><span class="nc">reg_deslocamento</span><span class="p">;</span><span class="w"></span>
</code></pre></div></td></tr></table></div>

<p><a name="bufferEinout"></a></p>
<h1>Saídas com direção <code>buffer</code> e <code>inout</code></h1>
<p>Uma saída que pode ser lida é especificada pelo tipo <code>buffer</code>. Este tipo de porta é considerada especial pois implica que o sintetizador vai colocar um elemento sequencial na saída (<em>latch</em> ou <em>flip-flop</em>), para fazer o papel de <em>buffer</em>, registrando a sua saída para ela que possa ser lida. Se você utilizar o <code>buffer</code>, seu circuito nunca será combinatório. Quase todos os dispositivos de prototipação FPGA modernos suportam o <code>buffer</code>, mas você pode aumentar um pouco a área utilizada devido ao roteamento.</p>
<p><img src='https://balbertini.github.io/images/vhdl/entidade.png' width="30%" align="right" style="padding-left:5%" />
Note que usando o <code>buffer</code> você não pode ler um valor que foi colocado na saída por um elemento externo ao seu, você apenas pode ler os valores que o seu próprio componente colocou na saída. Para ler o valor que um componente externo colocou na sua saída, existe o <code>inout</code>, um tipo de porta diferente pois é bidirecional: pode ser usada como entrada, quando você lê um sinal escrito por algo externo para dentro do seu componente, e pode ser usada como saída, quando você escreve o sinal de dentro do seu componente para que algo de fora leia. O <code>inout</code> indica para o sintetizador que ele deve colocar um <em>buffer</em> que suporte <em>tri-state</em> na sua saída. Neste caso, você deve garantir que os elementos em VHDL que possam escrever ou ler façam isso de forma mutuamente exclusiva, para que o sintetizador possa inferir corretamente os sinais de controle do <em>buffer tri-state</em>. Os dispositivos de prototipação FPGA modernos costumam possuir este tipo de <em>bufer</em> somente nos pinos de saída do FPGA, o que deve aumentar bastante seu roteamento e, consequentemente, a área do seu circuito.</p>
<p>Resumindo, não utilize <code>buffer</code> nem <code>inout</code> nas suas descrições exceto se você quer mesmo os componente que serão inferidos na sua descrição. Recomendo <strong>fortemente</strong> que aprendizes não os utilizem. A maneira de contornar a restrição de leitura de uma porta <code>out</code> é criar um sinal temporário, fazer o que você tem que fazer sobre este sinal e, no final da arquitetura, atribuir o sinal temporário à saída que ele representa.</p>
<p><strong>Nota:</strong> se você é meu aluno, não utilize <code>buffer</code> ou <code>inout</code> somente com a intenção de ler o valor na saída em hipótese alguma.</p>
<h3>Contribuições</h3>
<ul>
<li>24/set/2020: Arthur Lopes corrigiu o tamanho da saída do MUX do exemplo.</li>
</ul>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://balbertini.github.io/tag/vhdl.html">vhdl</a>
      <a href="https://balbertini.github.io/tag/basic.html">basic</a>
    </p>
  </div>





<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'balbertini';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>
  &copy; 2014 Bruno Albertini - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://balbertini.github.io/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " B.Albertini's site ",
  "url" : "https://balbertini.github.io",
  "image": "/images/profile.png",
  "description": ""
}
</script>

</body>
</html>