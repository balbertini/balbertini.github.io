
<!DOCTYPE html>
<html lang="pt_br">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://balbertini.github.io/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark)"
    href="https://balbertini.github.io/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark)"
          href="https://balbertini.github.io/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)"
          href="https://balbertini.github.io/theme/pygments/emacs.min.css">


  <link rel="stylesheet" type="text/css" href="https://balbertini.github.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://balbertini.github.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://balbertini.github.io/theme/font-awesome/css/solid.css">


    <link href="https://balbertini.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="B.Albertini's site Atom">


    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-125173293-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->  

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Microsoft EDGE -->
    <meta name="msapplication-TileColor" content="#333">

 

<meta name="author" content="Tomaz Maia Suller" />
<meta name="description" content="Como empregar a ferramenta hdlmake para gerenciar projetos de sistemas digitais" />
<meta name="keywords" content="sistemas digitais">


  <meta property="og:site_name" content="B.Albertini's site"/>
  <meta property="og:title" content="Introdução à ferramenta de gerenciamento `hdlmake`"/>
  <meta property="og:description" content="Como empregar a ferramenta hdlmake para gerenciar projetos de sistemas digitais"/>
  <meta property="og:locale" content="pr_BR"/>
  <meta property="og:url" content="https://balbertini.github.io/hdlmake-pt_BR.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2022-02-13 18:51:12-03:00"/>
  <meta property="article:modified_time" content="2022-03-22 12:09:28-03:00"/>
  <meta property="article:author" content="https://balbertini.github.io/author/tomaz-maia-suller.html">
  <meta property="article:section" content="sistemas digitais"/>
  <meta property="article:tag" content="sistemas digitais"/>
  <meta property="og:image" content="/images/profile.png">

  <title>B.Albertini's site &ndash; Introdução à ferramenta de gerenciamento `hdlmake`</title>

</head>
<body >
  <aside>
    <div>
      <a href="https://balbertini.github.io/">
        <img src="/images/profile.png" alt="B.Albertini" title="B.Albertini">
      </a>

      <h1>
        <a href="https://balbertini.github.io/">B.Albertini</a>
      </h1>

<p>Professor</p>

      <nav>
        <ul class="list">


              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/sd-pt_BR.html#sd">
                  Sistemas Digitais
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/disciplinas-pt_BR.html#disciplinas">
                  Disciplinas
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/research-pt_BR.html#research">
                  Pesquisa
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/sobre-pt_BR.html#sobre">
                  Sobre
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/vagas-pt_BR.html#vagas">
                  Vagas
                </a>
              </li>
              <li>
                <a target="_self"
                   href="https://balbertini.github.io/pages/vhdl-pt_BR.html#vhdl">
                  VHDL
                </a>
              </li>

        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/balbertini" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-rss" href="//balbertini.github.io/feeds/all.atom.xml" target="_blank">
              <i class="fas fa-rss"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="hdlmake">Introdução à ferramenta de gerenciamento `hdlmake`</h1>
    <p>
      Posted on Dom 13 Fevereiro 2022 in <a href="https://balbertini.github.io/category/sistemas-digitais.html">sistemas digitais</a>
      &#8226; Last Modified Ter 22 Março 2022
        &#8226; 6 min read
    </p>
  </header>


  <div>
    <p>O desenvolvimento de projetos de <em>hardware</em> cresce em complexidade rapidamente, dada tanto a necessidade de se descrever sistemas empregando uma semântica de mais baixo nível do que linguagens de programação de <em>software</em> quanto a ausência de abstrações organizacionais de alto nível, como classes.
De fato, é usual a complexidade ser tão maior quão maior o uso de boas práticas pelo projetista (por exemplo, criando componentes modularizados e <em>testbenches</em> para cada componente).
Além disso, a presença de diversas ferramentas de análise, simulação e síntese, bem como de seus respectivos arquivos de configuração, podem dificultar a análise e iteração rápida sobre descrições mesmo de complexidade baixa.
Como exemplo, uma implementação parcial de um jogo da memória desenvolvido para a disciplina de Laboratório Digital 1 já possuía 20 arquivos de descrição de <em>hardware</em> - entre descrições de componentes e <em>testbenches</em> - e empregava três ferramentas distintas: <em>ModelSim</em> e <em>Questa Intel FPGA</em> para simulação e <em>Quartus Prime Lite</em> para síntese.</p>
<p>Assim, percebe-se a necessidade de se organizar e de se fornecer uma interface comum pela qual diferentes ferramentas possam ser empregadas de forma transparente em projetos de <em>hardware</em>. Nesse contexto, o <a href="https://ohwr.org/project/hdl-make"><code>hdlmake</code></a> se mostra uma ferramenta útil e poderosa para o desenvolvimento de projetos de médio porte, fornecendo uma estrutura organizacional clara a ser seguida por projetos e uma interface extensível de configuração e geração de <code>Makefile</code>s para o desenvolvimento completo do ciclo de vida de um sistema digital.</p>
<p>O <code>hdlmake</code> é uma ferramenta de linha de comando desenvolvida em <em>Python</em> pelo CERN sobre a licença GPLv3 de código aberto. Sua utilização é baseada na escrita de arquivos de configuração (todos com o nome <code>Manifest.py</code>, porém em diretórios diferentes) que são processados pela ferramenta para gerar <code>Makefile</code>s que realizam simulação ou síntese com algum das diversas ferramentas suportadas, representadas na tabela abaixo. O sistema é capaz de processar dependências entre descrições de <code>hardware</code> que combinam mais de uma linguagem de descrição, bem como gerenciar módulos externos hospedados em repositórios <em>Git</em> ou <em>SVN</em>.</p>
<table>
<thead>
<tr>
<th align="left">Ferramenta</th>
<th align="left">Síntese</th>
<th align="left">Simulação</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Xilinx ISE</td>
<td align="left">Sim</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">Xilinx PlanAhead</td>
<td align="left">Sim</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">Xilinx Vivado</td>
<td align="left">Sim</td>
<td align="left">Sim</td>
</tr>
<tr>
<td align="left">Altera Quartus</td>
<td align="left">Sim</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">Microsemi (Actel) Libero</td>
<td align="left">Sim</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">Lattice Semi. Diamond</td>
<td align="left">Sim</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">Project IceStorm</td>
<td align="left">Verilog</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">Xilinx ISim</td>
<td align="left">-</td>
<td align="left">Sim</td>
</tr>
<tr>
<td align="left">Mentor Graphics Modelsim</td>
<td align="left">-</td>
<td align="left">Sim</td>
</tr>
<tr>
<td align="left">Mentor Graphics Questa</td>
<td align="left">-</td>
<td align="left">Sim</td>
</tr>
<tr>
<td align="left">Aldec Active-HDL</td>
<td align="left">-</td>
<td align="left">Sim</td>
</tr>
<tr>
<td align="left">Aldec Riviera-PRO</td>
<td align="left">-</td>
<td align="left">Sim</td>
</tr>
<tr>
<td align="left">Icarus Verilog</td>
<td align="left">-</td>
<td align="left">Sim</td>
</tr>
<tr>
<td align="left">GHDL</td>
<td align="left">-</td>
<td align="left">VHDL</td>
</tr>
</tbody>
</table>
<p>A organização do <code>hdlmake</code> empregada no jogo de memória, representada abaixo, será utilizada como exemplo neste relatório; ela emula aquela presente na <a href="https://hdlmake.readthedocs.io">documentação</a> e nos casos de teste presentes no repositório da ferramenta.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">.</span>
<span class="err">├──</span> <span class="n">README</span><span class="p">.</span><span class="n">md</span>
<span class="err">├──</span> <span class="n">modules</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">Manifest</span><span class="p">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">comparador_85</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">contador_163</span><span class="p">.</span><span class="n">v</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">edge_detector</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">fluxo_dados</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">hexa7seg</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">ram_16x4</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">ram_conteudo_jogadas</span><span class="p">.</span><span class="n">mif</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">registrador_173</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">unidade_controle</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">├──</span> <span class="n">simulation</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">Manifest</span><span class="p">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">write_vsim_do</span><span class="p">.</span><span class="n">py</span>
<span class="err">├──</span> <span class="n">software</span>
<span class="err">├──</span> <span class="n">synthesis</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">Manifest</span><span class="p">.</span><span class="n">py</span>
<span class="err">├──</span> <span class="n">testbenches</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">Manifest</span><span class="p">.</span><span class="n">py</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">circuito_exp3_tb</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">comparador_85_tb</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">contador_163_tb</span><span class="p">.</span><span class="n">v</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">fluxo_dados_tb</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">ram_16x4_tb</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">registrador_173_tb</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">├──</span> <span class="n">unidade_controle_tb</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">│</span>   <span class="err">└──</span> <span class="n">utils</span><span class="p">.</span><span class="n">vhd</span>
<span class="err">└──</span> <span class="n">toplevel</span>
    <span class="err">├──</span> <span class="n">Manifest</span><span class="p">.</span><span class="n">py</span>
    <span class="err">├──</span> <span class="n">circuito_exp3</span><span class="p">.</span><span class="n">csv</span>
    <span class="err">├──</span> <span class="n">circuito_exp3</span><span class="p">.</span><span class="n">vhd</span>
    <span class="err">└──</span> <span class="n">plan_pins</span><span class="p">.</span><span class="n">py</span>
</code></pre></div>
</td></tr></table>
<h1>Instalação</h1>
<p>O <code>hdlmake</code> é publicado no <em>Python Package Index</em> e pode ser instalado como outras bibliotecas pelo gerenciador de pacotes pip por meio do comando <code>python -m pip install hdlmake</code> em uma instalação de <em>Python</em> com versões superiores à 2.7. É necessário adicionar o caminho de instalação da ferramenta (em sistemas Unix, geralmente <code>$HOME/.local</code>) à variável de ambiente <code>PATH</code> para ser possível chamar o <code>hdlmake</code> diretamente da linha de comando como exemplificado neste documento.</p>
<h1>Configuração</h1>
<p>Toda a configuração do <code>hdlmake</code> é realizada a partir de arquivos <code>Manifest.py</code>, que permitem não só adicionar configurações, mas também lógica condicional sobre essas configurações.
Os arquivos presentes nos diretórios <code>modules</code>, <code>testbenches</code> e <code>toplevel</code> são simples e somente listam os arquivos presentes no diretório e os diretórios em que suas dependências residem. O arquivo do diretório <code>toplevel</code> é reproduzido abaixo como exemplo.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;circuito_exp3.vhd&quot;</span>
<span class="p">]</span>

<span class="n">modules</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;local&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;../modules&quot;</span>
    <span class="p">],</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>Ele mostra que o diretório possui o arquivo <code>circuito_exp3.vhd</code> como descrição de <em>hardware</em> a ser analisada, cujas dependências se encontram em diretório local (isto é, no sistema de arquivos local e não em um repositório <em>Git</em> ou <em>SVN</em> remoto) denominado <code>modules</code>, visível na estrutura de pastas representada anteriormente.</p>
<p>O controle dos processos de simulação e síntese é realizado por meio dos <code>Manifest.py</code>s de seus respectivos diretórios, e exigem um detalhamento maior para entender seu funcionamento.</p>
<p>Em primeiro lugar, as configurações de simulação são analisadas; elas estão reproduzidas a seguir.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">TOPLEVEL</span> <span class="o">=</span> <span class="s1">&#39;fluxo_dados&#39;</span>
<span class="n">VCD_NAME</span> <span class="o">=</span> <span class="n">TOPLEVEL</span>
<span class="n">VIEW_WAVE</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># TODO fix; does nothing</span>

<span class="c1">###################################################</span>

<span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;simulation&quot;</span>
<span class="n">sim_tool</span> <span class="o">=</span> <span class="s2">&quot;modelsim&quot;</span>
<span class="n">sim_top</span> <span class="o">=</span> <span class="n">TOPLEVEL</span> <span class="o">+</span> <span class="s2">&quot;_tb&quot;</span>

<span class="n">sim_pre_cmd</span> <span class="o">=</span> <span class="s2">&quot;python write_vsim_do.py &quot;</span> <span class="o">+</span> <span class="n">VCD_NAME</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">VIEW_WAVE</span><span class="p">)</span>
<span class="n">sim_post_cmd</span> <span class="o">=</span> <span class="s2">&quot;vsim -do vsim.do -i &quot;</span> <span class="o">+</span> <span class="n">sim_top</span>

<span class="n">modules</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;local&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;../testbenches/&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>As variáveis requisitadas pelo <code>hdlmake</code> estão abaixo da linha com <code>#</code>, e indicam que o <code>Manifest.py</code> desse diretório foi configurado para realizar simulação (<code>action = "simulation"</code>) usando o <em>ModelSim</em> (<code>sim_tool = "modelsim"</code>).
Como o arquivo de configuração é escrito na linguagem <em>Python</em>, podemos realizar operações geralmente não possíveis em arquivos de configuração usuais. Como exemplo, o nome da entidade <em>toplevel</em> de simulação é designado como a concatenação da variável <code>TOPLEVEL</code> e a <em>string</em> <code>_tb</code>.
As diretivas <code>sim_pre_cmd</code> e <code>sim_post_cmd</code> designam comandos arbitrários de linha de comando que podem ser executados antes e depois da realização da simulação, respectivamente.
Nesse caso, antes da simulação, é executado o <em>script Python</em> <code>write_vsim_do.py</code> que gera o arquivo <code>vsim.do</code>, escrito pelo grupo para gerar arquivos VCD automaticamente da simulação; os comandos nesse arquivo são então executado após a simulação.</p>
<p>Em segundo lugar, as configurações de síntese são analisadas; elas estão reproduzidas a seguir.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">PROCESS_PINS</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">TOPLEVEL</span> <span class="o">=</span> <span class="s2">&quot;circuito_exp3&quot;</span>
<span class="n">PINS_CSV</span> <span class="o">=</span> <span class="s2">&quot;../toplevel/circuito_exp3.csv&quot;</span>
<span class="n">PINS_READ_MODE</span> <span class="o">=</span> <span class="s2">&quot;quartus&quot;</span>

<span class="c1">############################################</span>

<span class="n">target</span> <span class="o">=</span> <span class="s2">&quot;altera&quot;</span>
<span class="n">action</span> <span class="o">=</span> <span class="s2">&quot;synthesis&quot;</span>

<span class="n">syn_family</span> <span class="o">=</span> <span class="s2">&quot;Cyclone V&quot;</span>
<span class="n">syn_device</span> <span class="o">=</span> <span class="s2">&quot;5ceba4&quot;</span>
<span class="n">syn_package</span> <span class="o">=</span> <span class="s2">&quot;f23&quot;</span>
<span class="n">syn_grade</span> <span class="o">=</span> <span class="s2">&quot;c7&quot;</span>
<span class="n">syn_top</span> <span class="o">=</span> <span class="n">TOPLEVEL</span>
<span class="n">syn_project</span> <span class="o">=</span> <span class="n">TOPLEVEL</span>
<span class="n">syn_tool</span> <span class="o">=</span> <span class="s2">&quot;quartus&quot;</span>

<span class="k">if</span> <span class="n">PROCESS_PINS</span><span class="p">:</span>
    <span class="n">syn_pre_project_cmd</span> <span class="o">=</span> <span class="s2">&quot;python ../toplevel/plan_pins.py &quot;</span><span class="o">+</span><span class="n">TOPLEVEL</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span> <span class="n">PINS_CSV</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">PINS_READ_MODE</span>
    <span class="n">syn_post_project_cmd</span> <span class="o">=</span> <span class="s2">&quot;quartus_sh -t pins.tcl compile &quot;</span><span class="o">+</span><span class="n">TOPLEVEL</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="n">TOPLEVEL</span>
<span class="n">syn_post_bitstream_cmd</span> <span class="o">=</span> <span class="s2">&quot;quartus_sh --archive &quot;</span><span class="o">+</span><span class="n">TOPLEVEL</span>

<span class="n">modules</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;local&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;../toplevel&quot;</span>
    <span class="p">],</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>As variáveis requisitadas pelo <code>hdlmake</code> estão abaixo da linha com <code>#</code>, e indicam que o <code>Manifest.py</code> desse diretório foi configurado para realizar síntese (<code>action = "synthesis"</code>) para uma placa da Altera (<code>target = "altera"</code>) com FPGA Cyclone V de modelo <code>5CEBA4F23C7</code> (linhas 12 a 15) utilizando o <em>Quartus Prime Lite</em> (<code>syn_tool = "quartus"</code>).
Na síntese, existem mais diretivas do que na simulação. Podem ser executados comandos imediatamente antes ou depois da criação do projeto do <em>Quartus Prime Lite</em> ou do final da síntese.
No arquivo de configuração empregado, antes da criação do projeto, é executado um <em>script Python</em> que gera um arquivo <code>pins.tcl</code>, o qual é executado após a criação do projeto para designar os pinos configurados segundo o arquivo CSV fornecido no diretório <code>toplevel</code>; ainda é executado, ao final da síntese, um comando para gerar automaticamente o arquivo QAR de arquivamento do projeto.</p>
<p>Uma descrição mais extensa das diretivas e possibilidades de configuração, além das empregadas neste projeto, pode ser encontrada na <a href="https://hdlmake.readthedocs.io">documentação do <code>hdlmake</code></a>.</p>
<h1>Execução</h1>
<p>Uma vez configurado, o <code>hdlmake</code> permite a execução das diretivas especificadas para simulação e síntese de forma simples por sua interface de linha de comando. O procedimento explicado a seguir é idêntico tanto para síntese quanto para simulação, reforçando o valor de se possuir uma interface única para gerenciar projetos de <em>hardware</em>.</p>
<p>É necessário primeiramente navegar à pasta que contém o <code>Manifest.py</code> de simulação ou síntese.
Em seguida, o comando <code>hdlmake makefile</code> deve ser executado, gerando um arquivo <code>Makefile</code> que executa a ação pedida; é necessário se atentar aos avisos impressos no terminal nesse passo, já que podem indicar erros de configuração.
Tendo o <code>Makefile</code> correto, basta executar <code>make</code> para que todas as ações necessárias sejam tomadas e os comandos especificados sejam executados. Um exemplo dessa execução para o projeto do jogo de memória está ilustrado nas figuras abaixo.</p>
<p>Aqui um exemplo de como é simular usando o <code>hdlmake</code>, nesse caso com o simulador <em>Questa Intel FPGA</em>:</p>
<!-- <img src='https://balbertini.github.io/images/sd/hdlmake/sim.png'/> -->
<p><img alt="Simulação no projeto de exemplo usando hdlmake" src="https://balbertini.github.io/images/sd/hdlmake/sim.png"></p>
<p>E aqui um exemplo de síntese com o <em>Quartus Prime Lite</em>:</p>
<!-- <img src='https://balbertini.github.io/images/sd/hdlmake/syn.png' width="30%" align="left" style="padding-right:5%" /> -->
<p><img alt="Síntese do projeto de exemplo usando hdlmake" src="https://balbertini.github.io/images/sd/hdlmake/syn.png"></p>
<p>### Contribuições
    * 13/fev/2022: Tomaz Maia Suller escreveu este post.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://balbertini.github.io/tag/sistemas-digitais.html">sistemas digitais</a>
    </p>
  </div>





<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'balbertini';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view comments.
</noscript>
<!-- End Disqus -->
</article>

    <footer>
<p>
  &copy; 2014 Bruno Albertini - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.en_US" target="_blank">Creative Commons Attribution-ShareAlike</a>
</p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://balbertini.github.io/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="light"
          type="text/javascript">
  </script>
</p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
           src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " B.Albertini's site ",
  "url" : "https://balbertini.github.io",
  "image": "/images/profile.png",
  "description": ""
}
</script>

</body>
</html>